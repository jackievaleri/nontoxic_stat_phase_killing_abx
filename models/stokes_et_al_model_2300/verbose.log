Command line
python train.py --save_dir ../ian/stokes_et_al_model_2300/ --dropout 0.35 --hidden_size 1600 --ffn_num_layers 1 --depth 5 --data_path ../ian/stokes_et_al_train_set_05312022.csv --dataset_type classification --features_generator rdkit_2d_normalized --no_features_scaling --num_folds 10 --ensemble_size 3 --split_sizes 0.8 0.1 0.1 --smiles_columns SMILES --target_columns hit --gpu 0
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '../ian/stokes_et_al_train_set_05312022.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 5,
 'device': device(type='cuda', index=0),
 'dropout': 0.35,
 'empty_cache': False,
 'ensemble_size': 3,
 'epochs': 30,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': ['rdkit_2d_normalized'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': 0,
 'grad_clip': None,
 'hidden_size': 1600,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': '../ian/stokes_et_al_model_2300/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['hit'],
 'target_weights': None,
 'task_names': ['hit'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Command line
python train.py --save_dir ../ian/stokes_et_al_model_2300/ --dropout 0.35 --hidden_size 1600 --ffn_num_layers 1 --depth 5 --data_path ../ian/stokes_et_al_train_set_05312022.csv --dataset_type classification --features_generator rdkit_2d_normalized --no_features_scaling --num_folds 10 --ensemble_size 3 --split_sizes 0.8 0.1 0.1 --smiles_columns SMILES --target_columns hit --gpu 0
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '../ian/stokes_et_al_train_set_05312022.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 5,
 'device': device(type='cuda', index=0),
 'dropout': 0.35,
 'empty_cache': False,
 'ensemble_size': 3,
 'epochs': 30,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': ['rdkit_2d_normalized'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 1600,
 'ffn_num_layers': 1,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': 0,
 'grad_clip': None,
 'hidden_size': 1600,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': '../ian/stokes_et_al_model_2300/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['hit'],
 'target_weights': None,
 'task_names': ['hit'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
hit 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 1,868 | val size = 233 | test size = 234
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 2.7559e-01, PNorm = 59.4429, GNorm = 0.9528, lr_0 = 2.3378e-04
Loss = 2.2283e-01, PNorm = 59.4664, GNorm = 0.5778, lr_0 = 3.5541e-04
Loss = 1.8963e-01, PNorm = 59.4961, GNorm = 0.7677, lr_0 = 4.7703e-04
Validation auc = 0.777149
Epoch 1
Loss = 1.3129e-01, PNorm = 59.5308, GNorm = 0.3519, lr_0 = 6.1081e-04
Loss = 2.1061e-01, PNorm = 59.5715, GNorm = 0.3458, lr_0 = 7.3243e-04
Loss = 2.2405e-01, PNorm = 59.6200, GNorm = 0.3246, lr_0 = 8.5405e-04
Loss = 2.0073e-01, PNorm = 59.6842, GNorm = 0.5185, lr_0 = 9.7568e-04
Validation auc = 0.858597
Epoch 2
Loss = 1.9678e-01, PNorm = 59.7621, GNorm = 0.3167, lr_0 = 9.8020e-04
Loss = 1.9502e-01, PNorm = 59.8293, GNorm = 1.8390, lr_0 = 9.5865e-04
Loss = 1.4191e-01, PNorm = 59.9400, GNorm = 0.1817, lr_0 = 9.3758e-04
Loss = 2.3324e-01, PNorm = 60.0200, GNorm = 0.3721, lr_0 = 9.1697e-04
Validation auc = 0.931373
Epoch 3
Loss = 2.3813e-01, PNorm = 60.0879, GNorm = 0.3080, lr_0 = 8.9681e-04
Loss = 1.8335e-01, PNorm = 60.1614, GNorm = 0.4016, lr_0 = 8.7710e-04
Loss = 1.2206e-01, PNorm = 60.2061, GNorm = 0.2555, lr_0 = 8.5782e-04
Validation auc = 0.927602
Epoch 4
Loss = 1.9062e-01, PNorm = 60.2473, GNorm = 0.3399, lr_0 = 8.3710e-04
Loss = 1.8841e-01, PNorm = 60.3031, GNorm = 0.5792, lr_0 = 8.1870e-04
Loss = 2.0355e-01, PNorm = 60.3488, GNorm = 0.5164, lr_0 = 8.0071e-04
Loss = 1.4767e-01, PNorm = 60.4102, GNorm = 0.3705, lr_0 = 7.8311e-04
Validation auc = 0.971719
Epoch 5
Loss = 2.2028e-01, PNorm = 60.4659, GNorm = 0.8460, lr_0 = 7.6420e-04
Loss = 1.3266e-01, PNorm = 60.5275, GNorm = 0.3315, lr_0 = 7.4740e-04
Loss = 1.5558e-01, PNorm = 60.5715, GNorm = 0.5408, lr_0 = 7.3097e-04
Loss = 1.7132e-01, PNorm = 60.6448, GNorm = 0.3074, lr_0 = 7.1490e-04
Validation auc = 0.912896
Epoch 6
Loss = 1.6985e-01, PNorm = 60.7105, GNorm = 0.2445, lr_0 = 6.9919e-04
Loss = 1.7550e-01, PNorm = 60.7789, GNorm = 0.2284, lr_0 = 6.8382e-04
Loss = 1.4689e-01, PNorm = 60.8351, GNorm = 0.2968, lr_0 = 6.6879e-04
Loss = 1.6820e-01, PNorm = 60.8871, GNorm = 0.2254, lr_0 = 6.5409e-04
Validation auc = 0.964555
Epoch 7
Loss = 1.4163e-01, PNorm = 60.9534, GNorm = 0.2820, lr_0 = 6.3829e-04
Loss = 1.5101e-01, PNorm = 61.0120, GNorm = 0.6094, lr_0 = 6.2426e-04
Loss = 1.4000e-01, PNorm = 61.0655, GNorm = 0.3739, lr_0 = 6.1054e-04
Validation auc = 0.977376
Epoch 8
Loss = 1.4325e-01, PNorm = 61.1184, GNorm = 0.7196, lr_0 = 5.9579e-04
Loss = 1.7647e-01, PNorm = 61.1998, GNorm = 0.4232, lr_0 = 5.8270e-04
Loss = 1.7035e-01, PNorm = 61.2756, GNorm = 0.6811, lr_0 = 5.6989e-04
Loss = 8.1251e-02, PNorm = 61.3588, GNorm = 0.2880, lr_0 = 5.5736e-04
Validation auc = 0.981900
Epoch 9
Loss = 1.7122e-01, PNorm = 61.3979, GNorm = 0.5588, lr_0 = 5.4511e-04
Loss = 1.4584e-01, PNorm = 61.4648, GNorm = 0.3092, lr_0 = 5.3313e-04
Loss = 1.5767e-01, PNorm = 61.5346, GNorm = 0.3772, lr_0 = 5.2141e-04
Loss = 1.0823e-01, PNorm = 61.6111, GNorm = 0.5975, lr_0 = 5.0995e-04
Validation auc = 0.979638
Epoch 10
Loss = 1.1858e-01, PNorm = 61.6595, GNorm = 0.2607, lr_0 = 4.9764e-04
Loss = 1.1933e-01, PNorm = 61.7230, GNorm = 0.3311, lr_0 = 4.8670e-04
Loss = 1.1986e-01, PNorm = 61.7841, GNorm = 0.2603, lr_0 = 4.7600e-04
Loss = 1.7022e-01, PNorm = 61.8418, GNorm = 0.4772, lr_0 = 4.6554e-04
Loss = 2.0337e-01, PNorm = 61.8468, GNorm = 0.7750, lr_0 = 4.6450e-04
Validation auc = 0.982655
Epoch 11
Loss = 1.3611e-01, PNorm = 61.9051, GNorm = 0.2941, lr_0 = 4.5429e-04
Loss = 1.1403e-01, PNorm = 61.9701, GNorm = 0.5317, lr_0 = 4.4431e-04
Loss = 1.4978e-01, PNorm = 62.0251, GNorm = 0.4249, lr_0 = 4.3454e-04
Validation auc = 0.975867
Epoch 12
Loss = 1.5856e-01, PNorm = 62.0787, GNorm = 0.3884, lr_0 = 4.2499e-04
Loss = 1.0763e-01, PNorm = 62.1449, GNorm = 0.6950, lr_0 = 4.1565e-04
Loss = 1.1534e-01, PNorm = 62.2046, GNorm = 0.4885, lr_0 = 4.0651e-04
Loss = 1.4214e-01, PNorm = 62.2731, GNorm = 0.3580, lr_0 = 3.9758e-04
Validation auc = 0.985671
Epoch 13
Loss = 8.8467e-02, PNorm = 62.3234, GNorm = 0.3103, lr_0 = 3.8797e-04
Loss = 1.1044e-01, PNorm = 62.3959, GNorm = 0.6954, lr_0 = 3.7945e-04
Loss = 1.2595e-01, PNorm = 62.4495, GNorm = 0.5678, lr_0 = 3.7111e-04
Loss = 1.2069e-01, PNorm = 62.5055, GNorm = 0.4285, lr_0 = 3.6295e-04
Validation auc = 0.983032
Epoch 14
Loss = 1.2302e-01, PNorm = 62.5549, GNorm = 0.3512, lr_0 = 3.5497e-04
Loss = 1.0219e-01, PNorm = 62.6109, GNorm = 0.2613, lr_0 = 3.4717e-04
Loss = 9.5720e-02, PNorm = 62.6669, GNorm = 0.4407, lr_0 = 3.3954e-04
Loss = 1.4196e-01, PNorm = 62.7000, GNorm = 0.6718, lr_0 = 3.3207e-04
Loss = 2.2799e-01, PNorm = 62.7055, GNorm = 0.9203, lr_0 = 3.3134e-04
Validation auc = 0.980392
Epoch 15
Loss = 1.0316e-01, PNorm = 62.7691, GNorm = 0.2046, lr_0 = 3.2405e-04
Loss = 9.7688e-02, PNorm = 62.8101, GNorm = 0.3947, lr_0 = 3.1693e-04
Loss = 1.3067e-01, PNorm = 62.8482, GNorm = 0.3364, lr_0 = 3.0997e-04
Validation auc = 0.983409
Epoch 16
Loss = 1.0768e-01, PNorm = 62.8979, GNorm = 0.2993, lr_0 = 3.0248e-04
Loss = 9.0025e-02, PNorm = 62.9353, GNorm = 0.4984, lr_0 = 2.9583e-04
Loss = 1.0553e-01, PNorm = 62.9837, GNorm = 0.7908, lr_0 = 2.8933e-04
Loss = 1.1318e-01, PNorm = 63.0252, GNorm = 0.3281, lr_0 = 2.8297e-04
Validation auc = 0.985294
Epoch 17
Loss = 5.1986e-02, PNorm = 63.0652, GNorm = 0.2186, lr_0 = 2.7675e-04
Loss = 1.0005e-01, PNorm = 63.0885, GNorm = 0.7093, lr_0 = 2.7067e-04
Loss = 1.0861e-01, PNorm = 63.1268, GNorm = 0.4400, lr_0 = 2.6472e-04
Loss = 1.0024e-01, PNorm = 63.1629, GNorm = 0.6741, lr_0 = 2.5890e-04
Validation auc = 0.986802
Epoch 18
Loss = 7.8911e-02, PNorm = 63.2050, GNorm = 0.4271, lr_0 = 2.5264e-04
Loss = 1.0503e-01, PNorm = 63.2463, GNorm = 0.4139, lr_0 = 2.4709e-04
Loss = 8.9391e-02, PNorm = 63.2852, GNorm = 0.2729, lr_0 = 2.4166e-04
Validation auc = 0.985671
Epoch 19
Loss = 9.5180e-02, PNorm = 63.3211, GNorm = 0.5050, lr_0 = 2.3582e-04
Loss = 7.8089e-02, PNorm = 63.3630, GNorm = 0.3466, lr_0 = 2.3064e-04
Loss = 7.8636e-02, PNorm = 63.3946, GNorm = 0.3836, lr_0 = 2.2557e-04
Loss = 1.2213e-01, PNorm = 63.4261, GNorm = 0.2367, lr_0 = 2.2061e-04
Validation auc = 0.984163
Epoch 20
Loss = 6.8134e-02, PNorm = 63.4624, GNorm = 0.5803, lr_0 = 2.1576e-04
Loss = 8.0904e-02, PNorm = 63.4970, GNorm = 0.5168, lr_0 = 2.1102e-04
Loss = 5.7052e-02, PNorm = 63.5312, GNorm = 0.6236, lr_0 = 2.0638e-04
Loss = 1.1833e-01, PNorm = 63.5531, GNorm = 1.0074, lr_0 = 2.0185e-04
Validation auc = 0.984163
Epoch 21
Loss = 7.9269e-02, PNorm = 63.5998, GNorm = 0.5051, lr_0 = 1.9697e-04
Loss = 9.3664e-02, PNorm = 63.6281, GNorm = 0.5302, lr_0 = 1.9264e-04
Loss = 6.4143e-02, PNorm = 63.6612, GNorm = 0.6439, lr_0 = 1.8841e-04
Loss = 7.5816e-02, PNorm = 63.6773, GNorm = 0.4307, lr_0 = 1.8427e-04
Validation auc = 0.985671
Epoch 22
Loss = 7.4160e-02, PNorm = 63.7187, GNorm = 1.1998, lr_0 = 1.7982e-04
Loss = 6.5764e-02, PNorm = 63.7411, GNorm = 0.3777, lr_0 = 1.7586e-04
Loss = 6.3387e-02, PNorm = 63.7669, GNorm = 0.5400, lr_0 = 1.7200e-04
Validation auc = 0.984163
Epoch 23
Loss = 3.1002e-02, PNorm = 63.7982, GNorm = 0.5757, lr_0 = 1.6822e-04
Loss = 6.1250e-02, PNorm = 63.8211, GNorm = 0.7367, lr_0 = 1.6452e-04
Loss = 9.3247e-02, PNorm = 63.8425, GNorm = 1.1317, lr_0 = 1.6090e-04
Loss = 7.1203e-02, PNorm = 63.8769, GNorm = 0.1216, lr_0 = 1.5737e-04
Validation auc = 0.978130
Epoch 24
Loss = 6.3157e-02, PNorm = 63.8965, GNorm = 0.2554, lr_0 = 1.5357e-04
Loss = 6.7865e-02, PNorm = 63.9266, GNorm = 0.4498, lr_0 = 1.5019e-04
Loss = 8.6385e-02, PNorm = 63.9477, GNorm = 0.4507, lr_0 = 1.4689e-04
Loss = 4.7680e-02, PNorm = 63.9688, GNorm = 0.1965, lr_0 = 1.4366e-04
Validation auc = 0.978884
Epoch 25
Loss = 3.8369e-02, PNorm = 63.9863, GNorm = 0.2261, lr_0 = 1.4050e-04
Loss = 5.0489e-02, PNorm = 64.0047, GNorm = 0.2918, lr_0 = 1.3741e-04
Loss = 7.2045e-02, PNorm = 64.0213, GNorm = 0.2584, lr_0 = 1.3439e-04
Loss = 6.2914e-02, PNorm = 64.0402, GNorm = 0.5534, lr_0 = 1.3144e-04
Validation auc = 0.972851
Epoch 26
Loss = 6.0511e-02, PNorm = 64.0617, GNorm = 0.2338, lr_0 = 1.2826e-04
Loss = 5.0527e-02, PNorm = 64.0831, GNorm = 1.8343, lr_0 = 1.2545e-04
Loss = 5.3980e-02, PNorm = 64.0961, GNorm = 0.2860, lr_0 = 1.2269e-04
Validation auc = 0.980015
Epoch 27
Loss = 3.1557e-02, PNorm = 64.1172, GNorm = 0.7032, lr_0 = 1.1973e-04
Loss = 4.2438e-02, PNorm = 64.1358, GNorm = 0.3388, lr_0 = 1.1709e-04
Loss = 5.3183e-02, PNorm = 64.1521, GNorm = 0.4362, lr_0 = 1.1452e-04
Loss = 6.6366e-02, PNorm = 64.1612, GNorm = 0.5064, lr_0 = 1.1200e-04
Validation auc = 0.980392
Epoch 28
Loss = 2.9001e-02, PNorm = 64.1840, GNorm = 0.4954, lr_0 = 1.0954e-04
Loss = 4.0667e-02, PNorm = 64.1964, GNorm = 0.6934, lr_0 = 1.0713e-04
Loss = 4.8717e-02, PNorm = 64.2104, GNorm = 1.2083, lr_0 = 1.0478e-04
Loss = 5.6834e-02, PNorm = 64.2255, GNorm = 0.2149, lr_0 = 1.0247e-04
Validation auc = 0.971342
Epoch 29
Loss = 3.5729e-02, PNorm = 64.2431, GNorm = 0.6680, lr_0 = 1.0000e-04
Loss = 5.9004e-02, PNorm = 64.2546, GNorm = 0.4880, lr_0 = 1.0000e-04
Loss = 4.3462e-02, PNorm = 64.2738, GNorm = 0.2912, lr_0 = 1.0000e-04
Loss = 4.7539e-02, PNorm = 64.2858, GNorm = 0.5940, lr_0 = 1.0000e-04
Loss = 1.3228e-02, PNorm = 64.2865, GNorm = 0.3433, lr_0 = 1.0000e-04
Validation auc = 0.965309
Model 0 best validation auc = 0.986802 on epoch 17
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = 0.861039
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 2.6334e-01, PNorm = 59.4719, GNorm = 0.4286, lr_0 = 2.3378e-04
Loss = 2.3174e-01, PNorm = 59.4928, GNorm = 0.4271, lr_0 = 3.5541e-04
Loss = 2.1402e-01, PNorm = 59.5178, GNorm = 0.3633, lr_0 = 4.7703e-04
Validation auc = 0.869910
Epoch 1
Loss = 1.8745e-01, PNorm = 59.5504, GNorm = 0.2870, lr_0 = 6.1081e-04
Loss = 1.9728e-01, PNorm = 59.5803, GNorm = 0.6761, lr_0 = 7.3243e-04
Loss = 1.3974e-01, PNorm = 59.6163, GNorm = 0.3541, lr_0 = 8.5405e-04
Loss = 2.2291e-01, PNorm = 59.6639, GNorm = 0.6824, lr_0 = 9.7568e-04
Validation auc = 0.824284
Epoch 2
Loss = 2.0214e-01, PNorm = 59.7403, GNorm = 0.2931, lr_0 = 9.8020e-04
Loss = 2.1960e-01, PNorm = 59.8206, GNorm = 0.5533, lr_0 = 9.5865e-04
Loss = 1.7168e-01, PNorm = 59.8953, GNorm = 0.3401, lr_0 = 9.3758e-04
Loss = 1.7053e-01, PNorm = 59.9518, GNorm = 0.3155, lr_0 = 9.1697e-04
Validation auc = 0.963801
Epoch 3
Loss = 1.9087e-01, PNorm = 60.0185, GNorm = 0.3657, lr_0 = 8.9681e-04
Loss = 1.8857e-01, PNorm = 60.0956, GNorm = 0.3755, lr_0 = 8.7710e-04
Loss = 1.5552e-01, PNorm = 60.1692, GNorm = 0.5442, lr_0 = 8.5782e-04
Validation auc = 0.965309
Epoch 4
Loss = 2.6160e-02, PNorm = 60.2511, GNorm = 0.2633, lr_0 = 8.3710e-04
Loss = 2.0746e-01, PNorm = 60.2983, GNorm = 0.4717, lr_0 = 8.1870e-04
Loss = 1.8332e-01, PNorm = 60.3625, GNorm = 0.5847, lr_0 = 8.0071e-04
Loss = 1.5264e-01, PNorm = 60.4143, GNorm = 0.5795, lr_0 = 7.8311e-04
Validation auc = 0.967195
Epoch 5
Loss = 1.6033e-01, PNorm = 60.4743, GNorm = 0.3525, lr_0 = 7.6420e-04
Loss = 1.6579e-01, PNorm = 60.5355, GNorm = 0.3939, lr_0 = 7.4740e-04
Loss = 1.6952e-01, PNorm = 60.6168, GNorm = 0.6798, lr_0 = 7.3097e-04
Loss = 1.5161e-01, PNorm = 60.7026, GNorm = 0.2138, lr_0 = 7.1490e-04
Validation auc = 0.963424
Epoch 6
Loss = 1.7095e-01, PNorm = 60.7691, GNorm = 0.4416, lr_0 = 6.9919e-04
Loss = 1.3981e-01, PNorm = 60.8516, GNorm = 0.5205, lr_0 = 6.8382e-04
Loss = 1.9744e-01, PNorm = 60.9082, GNorm = 0.5842, lr_0 = 6.6879e-04
Loss = 1.3519e-01, PNorm = 60.9889, GNorm = 0.2516, lr_0 = 6.5409e-04
Validation auc = 0.979261
Epoch 7
Loss = 1.3631e-01, PNorm = 61.0497, GNorm = 0.2256, lr_0 = 6.3829e-04
Loss = 1.4978e-01, PNorm = 61.1280, GNorm = 0.2493, lr_0 = 6.2426e-04
Loss = 1.6583e-01, PNorm = 61.2019, GNorm = 0.2591, lr_0 = 6.1054e-04
Validation auc = 0.979261
Epoch 8
Loss = 5.7805e-02, PNorm = 61.2374, GNorm = 0.2837, lr_0 = 5.9579e-04
Loss = 1.6245e-01, PNorm = 61.2823, GNorm = 0.2833, lr_0 = 5.8270e-04
Loss = 1.6401e-01, PNorm = 61.3366, GNorm = 0.5646, lr_0 = 5.6989e-04
Loss = 1.5865e-01, PNorm = 61.3827, GNorm = 0.3257, lr_0 = 5.5736e-04
Validation auc = 0.983409
Epoch 9
Loss = 1.2669e-01, PNorm = 61.4305, GNorm = 0.4145, lr_0 = 5.4511e-04
Loss = 1.8506e-01, PNorm = 61.4831, GNorm = 0.3558, lr_0 = 5.3313e-04
Loss = 8.2230e-02, PNorm = 61.5428, GNorm = 0.2736, lr_0 = 5.2141e-04
Loss = 1.7298e-01, PNorm = 61.5720, GNorm = 0.4686, lr_0 = 5.0995e-04
Validation auc = 0.977753
Epoch 10
Loss = 1.2685e-01, PNorm = 61.6223, GNorm = 0.3948, lr_0 = 4.9764e-04
Loss = 9.9306e-02, PNorm = 61.6724, GNorm = 0.1967, lr_0 = 4.8670e-04
Loss = 1.5201e-01, PNorm = 61.7192, GNorm = 0.2381, lr_0 = 4.7600e-04
Loss = 1.6426e-01, PNorm = 61.7600, GNorm = 0.2592, lr_0 = 4.6554e-04
Loss = 2.1645e-01, PNorm = 61.7617, GNorm = 0.6139, lr_0 = 4.6450e-04
Validation auc = 0.981900
Epoch 11
Loss = 1.4031e-01, PNorm = 61.8233, GNorm = 0.3226, lr_0 = 4.5429e-04
Loss = 1.4368e-01, PNorm = 61.8721, GNorm = 0.5980, lr_0 = 4.4431e-04
Loss = 1.3931e-01, PNorm = 61.9222, GNorm = 0.3393, lr_0 = 4.3454e-04
Validation auc = 0.985294
Epoch 12
Loss = 8.8178e-02, PNorm = 61.9862, GNorm = 0.1849, lr_0 = 4.2499e-04
Loss = 1.3815e-01, PNorm = 62.0268, GNorm = 0.4520, lr_0 = 4.1565e-04
Loss = 1.7018e-01, PNorm = 62.0635, GNorm = 0.4959, lr_0 = 4.0651e-04
Loss = 1.0316e-01, PNorm = 62.1102, GNorm = 0.3858, lr_0 = 3.9758e-04
Validation auc = 0.971719
Epoch 13
Loss = 1.6427e-01, PNorm = 62.1617, GNorm = 0.5433, lr_0 = 3.8797e-04
Loss = 1.0328e-01, PNorm = 62.2115, GNorm = 0.5967, lr_0 = 3.7945e-04
Loss = 1.5348e-01, PNorm = 62.2603, GNorm = 0.5489, lr_0 = 3.7111e-04
Loss = 1.0992e-01, PNorm = 62.3160, GNorm = 0.6939, lr_0 = 3.6295e-04
Validation auc = 0.986802
Epoch 14
Loss = 1.1988e-01, PNorm = 62.3410, GNorm = 0.3083, lr_0 = 3.5497e-04
Loss = 1.1183e-01, PNorm = 62.3775, GNorm = 0.3091, lr_0 = 3.4717e-04
Loss = 1.3027e-01, PNorm = 62.4126, GNorm = 0.7303, lr_0 = 3.3954e-04
Loss = 1.0818e-01, PNorm = 62.4479, GNorm = 0.6192, lr_0 = 3.3207e-04
Loss = 1.1334e-01, PNorm = 62.4504, GNorm = 0.7054, lr_0 = 3.3134e-04
Validation auc = 0.976998
Epoch 15
Loss = 1.3949e-01, PNorm = 62.4849, GNorm = 0.5061, lr_0 = 3.2405e-04
Loss = 1.0537e-01, PNorm = 62.5234, GNorm = 0.4226, lr_0 = 3.1693e-04
Loss = 7.8688e-02, PNorm = 62.5649, GNorm = 0.2924, lr_0 = 3.0997e-04
Validation auc = 0.966440
Epoch 16
Loss = 1.3054e-01, PNorm = 62.6023, GNorm = 0.4758, lr_0 = 3.0248e-04
Loss = 1.1004e-01, PNorm = 62.6381, GNorm = 0.2379, lr_0 = 2.9583e-04
Loss = 9.8219e-02, PNorm = 62.6760, GNorm = 0.9795, lr_0 = 2.8933e-04
Loss = 1.0292e-01, PNorm = 62.7151, GNorm = 0.2591, lr_0 = 2.8297e-04
Validation auc = 0.985671
Epoch 17
Loss = 1.2217e-01, PNorm = 62.7488, GNorm = 0.2720, lr_0 = 2.7675e-04
Loss = 9.9062e-02, PNorm = 62.7851, GNorm = 0.3382, lr_0 = 2.7067e-04
Loss = 8.2703e-02, PNorm = 62.8177, GNorm = 0.4063, lr_0 = 2.6472e-04
Loss = 1.2991e-01, PNorm = 62.8447, GNorm = 0.5267, lr_0 = 2.5890e-04
Validation auc = 0.987179
Epoch 18
Loss = 7.0262e-02, PNorm = 62.8824, GNorm = 0.7126, lr_0 = 2.5264e-04
Loss = 1.0387e-01, PNorm = 62.9068, GNorm = 0.8159, lr_0 = 2.4709e-04
Loss = 8.7386e-02, PNorm = 62.9488, GNorm = 0.3557, lr_0 = 2.4166e-04
Validation auc = 0.987179
Epoch 19
Loss = 7.0118e-02, PNorm = 62.9767, GNorm = 0.6689, lr_0 = 2.3582e-04
Loss = 8.5906e-02, PNorm = 63.0115, GNorm = 0.7605, lr_0 = 2.3064e-04
Loss = 1.1417e-01, PNorm = 63.0385, GNorm = 0.3398, lr_0 = 2.2557e-04
Loss = 8.3830e-02, PNorm = 63.0738, GNorm = 0.5180, lr_0 = 2.2061e-04
Validation auc = 0.989819
Epoch 20
Loss = 7.2188e-02, PNorm = 63.0996, GNorm = 0.5079, lr_0 = 2.1576e-04
Loss = 7.9050e-02, PNorm = 63.1353, GNorm = 0.4488, lr_0 = 2.1102e-04
Loss = 1.0497e-01, PNorm = 63.1617, GNorm = 0.8789, lr_0 = 2.0638e-04
Loss = 1.0191e-01, PNorm = 63.1856, GNorm = 0.3935, lr_0 = 2.0185e-04
Validation auc = 0.989065
Epoch 21
Loss = 6.2046e-02, PNorm = 63.2164, GNorm = 0.3645, lr_0 = 1.9697e-04
Loss = 1.2182e-01, PNorm = 63.2335, GNorm = 0.6575, lr_0 = 1.9264e-04
Loss = 9.2826e-02, PNorm = 63.2688, GNorm = 0.2990, lr_0 = 1.8841e-04
Loss = 7.3705e-02, PNorm = 63.2961, GNorm = 0.2217, lr_0 = 1.8427e-04
Validation auc = 0.989065
Epoch 22
Loss = 1.1043e-01, PNorm = 63.3117, GNorm = 0.4446, lr_0 = 1.7982e-04
Loss = 7.0372e-02, PNorm = 63.3439, GNorm = 0.0976, lr_0 = 1.7586e-04
Loss = 1.1076e-01, PNorm = 63.3569, GNorm = 0.4212, lr_0 = 1.7200e-04
Validation auc = 0.980015
Epoch 23
Loss = 3.3693e-02, PNorm = 63.3915, GNorm = 0.2242, lr_0 = 1.6822e-04
Loss = 1.0031e-01, PNorm = 63.4103, GNorm = 0.9070, lr_0 = 1.6452e-04
Loss = 1.0099e-01, PNorm = 63.4419, GNorm = 0.3537, lr_0 = 1.6090e-04
Loss = 5.3642e-02, PNorm = 63.4737, GNorm = 0.3167, lr_0 = 1.5737e-04
Validation auc = 0.987179
Epoch 24
Loss = 9.6617e-02, PNorm = 63.4862, GNorm = 0.3606, lr_0 = 1.5357e-04
Loss = 5.7972e-02, PNorm = 63.5091, GNorm = 0.2315, lr_0 = 1.5019e-04
Loss = 6.7823e-02, PNorm = 63.5299, GNorm = 0.7270, lr_0 = 1.4689e-04
Loss = 1.0327e-01, PNorm = 63.5476, GNorm = 0.4819, lr_0 = 1.4366e-04
Validation auc = 0.985671
Epoch 25
Loss = 1.0480e-01, PNorm = 63.5695, GNorm = 0.3875, lr_0 = 1.4050e-04
Loss = 7.7502e-02, PNorm = 63.5870, GNorm = 0.6598, lr_0 = 1.3741e-04
Loss = 5.5095e-02, PNorm = 63.6109, GNorm = 0.4998, lr_0 = 1.3439e-04
Loss = 5.3141e-02, PNorm = 63.6282, GNorm = 0.9989, lr_0 = 1.3144e-04
Validation auc = 0.987179
Epoch 26
Loss = 8.4329e-02, PNorm = 63.6398, GNorm = 0.4755, lr_0 = 1.2826e-04
Loss = 5.2745e-02, PNorm = 63.6592, GNorm = 0.6580, lr_0 = 1.2545e-04
Loss = 7.2432e-02, PNorm = 63.6716, GNorm = 0.3782, lr_0 = 1.2269e-04
Validation auc = 0.986802
Epoch 27
Loss = 1.6245e-02, PNorm = 63.6944, GNorm = 0.1783, lr_0 = 1.1973e-04
Loss = 8.3844e-02, PNorm = 63.7065, GNorm = 0.3285, lr_0 = 1.1709e-04
Loss = 5.7788e-02, PNorm = 63.7206, GNorm = 0.4281, lr_0 = 1.1452e-04
Loss = 7.4405e-02, PNorm = 63.7374, GNorm = 0.3720, lr_0 = 1.1200e-04
Validation auc = 0.984540
Epoch 28
Loss = 4.1361e-02, PNorm = 63.7490, GNorm = 0.4546, lr_0 = 1.0954e-04
Loss = 6.4035e-02, PNorm = 63.7638, GNorm = 0.8427, lr_0 = 1.0713e-04
Loss = 6.7926e-02, PNorm = 63.7766, GNorm = 0.5873, lr_0 = 1.0478e-04
Loss = 5.6609e-02, PNorm = 63.7917, GNorm = 0.8788, lr_0 = 1.0247e-04
Validation auc = 0.985294
Epoch 29
Loss = 5.3281e-02, PNorm = 63.8026, GNorm = 1.6872, lr_0 = 1.0000e-04
Loss = 5.7498e-02, PNorm = 63.8126, GNorm = 0.4185, lr_0 = 1.0000e-04
Loss = 6.3468e-02, PNorm = 63.8260, GNorm = 0.9836, lr_0 = 1.0000e-04
Loss = 7.2255e-02, PNorm = 63.8362, GNorm = 0.3935, lr_0 = 1.0000e-04
Loss = 6.0281e-02, PNorm = 63.8375, GNorm = 0.6047, lr_0 = 1.0000e-04
Validation auc = 0.981900
Model 1 best validation auc = 0.989819 on epoch 19
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 1 test auc = 0.858442
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 2.7439e-01, PNorm = 59.4764, GNorm = 0.5403, lr_0 = 2.3378e-04
Loss = 2.2420e-01, PNorm = 59.4987, GNorm = 0.4897, lr_0 = 3.5541e-04
Loss = 1.7371e-01, PNorm = 59.5273, GNorm = 0.4787, lr_0 = 4.7703e-04
Validation auc = 0.718326
Epoch 1
Loss = 2.2986e-01, PNorm = 59.5613, GNorm = 0.4438, lr_0 = 6.1081e-04
Loss = 2.0452e-01, PNorm = 59.6044, GNorm = 0.3907, lr_0 = 7.3243e-04
Loss = 2.1101e-01, PNorm = 59.6569, GNorm = 0.3559, lr_0 = 8.5405e-04
Loss = 1.7219e-01, PNorm = 59.7326, GNorm = 0.7383, lr_0 = 9.7568e-04
Validation auc = 0.811840
Epoch 2
Loss = 2.1056e-01, PNorm = 59.8263, GNorm = 0.8794, lr_0 = 9.8020e-04
Loss = 1.7753e-01, PNorm = 59.9086, GNorm = 0.5294, lr_0 = 9.5865e-04
Loss = 1.8154e-01, PNorm = 59.9905, GNorm = 0.3383, lr_0 = 9.3758e-04
Loss = 1.8758e-01, PNorm = 60.0562, GNorm = 0.2590, lr_0 = 9.1697e-04
Validation auc = 0.935143
Epoch 3
Loss = 1.7605e-01, PNorm = 60.1383, GNorm = 0.3871, lr_0 = 8.9681e-04
Loss = 1.6921e-01, PNorm = 60.2149, GNorm = 0.3007, lr_0 = 8.7710e-04
Loss = 2.0365e-01, PNorm = 60.2749, GNorm = 1.0834, lr_0 = 8.5782e-04
Validation auc = 0.973605
Epoch 4
Loss = 1.0781e-01, PNorm = 60.3569, GNorm = 0.3173, lr_0 = 8.3710e-04
Loss = 1.5583e-01, PNorm = 60.4291, GNorm = 0.2433, lr_0 = 8.1870e-04
Loss = 2.0213e-01, PNorm = 60.4937, GNorm = 0.5336, lr_0 = 8.0071e-04
Loss = 1.6511e-01, PNorm = 60.5625, GNorm = 0.2511, lr_0 = 7.8311e-04
Validation auc = 0.971342
Epoch 5
Loss = 1.6223e-01, PNorm = 60.6252, GNorm = 0.5262, lr_0 = 7.6420e-04
Loss = 1.7647e-01, PNorm = 60.6969, GNorm = 0.3831, lr_0 = 7.4740e-04
Loss = 1.6358e-01, PNorm = 60.7587, GNorm = 0.7919, lr_0 = 7.3097e-04
Loss = 1.5317e-01, PNorm = 60.8392, GNorm = 0.2398, lr_0 = 7.1490e-04
Validation auc = 0.969080
Epoch 6
Loss = 1.4517e-01, PNorm = 60.8945, GNorm = 0.3979, lr_0 = 6.9919e-04
Loss = 1.6225e-01, PNorm = 60.9640, GNorm = 0.2899, lr_0 = 6.8382e-04
Loss = 1.4674e-01, PNorm = 61.0316, GNorm = 0.6992, lr_0 = 6.6879e-04
Loss = 1.4033e-01, PNorm = 61.0829, GNorm = 0.2255, lr_0 = 6.5409e-04
Validation auc = 0.954374
Epoch 7
Loss = 1.6519e-01, PNorm = 61.1553, GNorm = 0.2826, lr_0 = 6.3829e-04
Loss = 1.4407e-01, PNorm = 61.2209, GNorm = 0.5500, lr_0 = 6.2426e-04
Loss = 1.5490e-01, PNorm = 61.2830, GNorm = 0.4108, lr_0 = 6.1054e-04
Validation auc = 0.976244
Epoch 8
Loss = 1.5909e-01, PNorm = 61.3515, GNorm = 0.3953, lr_0 = 5.9579e-04
Loss = 1.3965e-01, PNorm = 61.4388, GNorm = 0.1495, lr_0 = 5.8270e-04
Loss = 1.5956e-01, PNorm = 61.4935, GNorm = 0.6095, lr_0 = 5.6989e-04
Loss = 1.5163e-01, PNorm = 61.5632, GNorm = 0.2521, lr_0 = 5.5736e-04
Validation auc = 0.961538
Epoch 9
Loss = 1.6923e-01, PNorm = 61.6358, GNorm = 0.5702, lr_0 = 5.4511e-04
Loss = 1.2227e-01, PNorm = 61.7060, GNorm = 0.4819, lr_0 = 5.3313e-04
Loss = 1.3146e-01, PNorm = 61.7681, GNorm = 0.3762, lr_0 = 5.2141e-04
Loss = 1.4288e-01, PNorm = 61.8206, GNorm = 0.3661, lr_0 = 5.0995e-04
Validation auc = 0.971719
Epoch 10
Loss = 1.1350e-01, PNorm = 61.8862, GNorm = 0.6738, lr_0 = 4.9764e-04
Loss = 1.3776e-01, PNorm = 61.9414, GNorm = 0.8680, lr_0 = 4.8670e-04
Loss = 1.4542e-01, PNorm = 62.0110, GNorm = 0.2813, lr_0 = 4.7600e-04
Loss = 1.3790e-01, PNorm = 62.0612, GNorm = 0.3446, lr_0 = 4.6554e-04
Loss = 5.2851e-02, PNorm = 62.0662, GNorm = 0.3998, lr_0 = 4.6450e-04
Validation auc = 0.978507
Epoch 11
Loss = 9.2984e-02, PNorm = 62.1310, GNorm = 0.3531, lr_0 = 4.5429e-04
Loss = 1.3814e-01, PNorm = 62.1810, GNorm = 0.4321, lr_0 = 4.4431e-04
Loss = 1.4761e-01, PNorm = 62.2398, GNorm = 0.3244, lr_0 = 4.3454e-04
Validation auc = 0.984540
Epoch 12
Loss = 1.2157e-01, PNorm = 62.2996, GNorm = 0.2011, lr_0 = 4.2499e-04
Loss = 9.6682e-02, PNorm = 62.3550, GNorm = 0.3255, lr_0 = 4.1565e-04
Loss = 1.1054e-01, PNorm = 62.4099, GNorm = 0.5688, lr_0 = 4.0651e-04
Loss = 1.5800e-01, PNorm = 62.4497, GNorm = 0.8849, lr_0 = 3.9758e-04
Validation auc = 0.978884
Epoch 13
Loss = 1.2953e-01, PNorm = 62.5340, GNorm = 0.6220, lr_0 = 3.8797e-04
Loss = 1.0426e-01, PNorm = 62.5865, GNorm = 0.5506, lr_0 = 3.7945e-04
Loss = 1.3190e-01, PNorm = 62.6372, GNorm = 0.4162, lr_0 = 3.7111e-04
Loss = 9.8221e-02, PNorm = 62.6929, GNorm = 0.2990, lr_0 = 3.6295e-04
Validation auc = 0.975113
Epoch 14
Loss = 1.2997e-01, PNorm = 62.7443, GNorm = 0.5057, lr_0 = 3.5497e-04
Loss = 1.1660e-01, PNorm = 62.8013, GNorm = 0.3510, lr_0 = 3.4717e-04
Loss = 1.1806e-01, PNorm = 62.8498, GNorm = 0.4446, lr_0 = 3.3954e-04
Loss = 9.3880e-02, PNorm = 62.9108, GNorm = 0.2259, lr_0 = 3.3207e-04
Loss = 1.2977e-01, PNorm = 62.9146, GNorm = 0.8346, lr_0 = 3.3134e-04
Validation auc = 0.987934
Epoch 15
Loss = 9.0221e-02, PNorm = 62.9561, GNorm = 0.7312, lr_0 = 3.2405e-04
Loss = 1.0299e-01, PNorm = 62.9967, GNorm = 0.7103, lr_0 = 3.1693e-04
Loss = 8.4720e-02, PNorm = 63.0389, GNorm = 0.3178, lr_0 = 3.0997e-04
Validation auc = 0.989065
Epoch 16
Loss = 1.1884e-01, PNorm = 63.0860, GNorm = 0.3668, lr_0 = 3.0248e-04
Loss = 9.2199e-02, PNorm = 63.1520, GNorm = 0.4362, lr_0 = 2.9583e-04
Loss = 9.5466e-02, PNorm = 63.2029, GNorm = 0.5152, lr_0 = 2.8933e-04
Loss = 1.0277e-01, PNorm = 63.2459, GNorm = 0.2115, lr_0 = 2.8297e-04
Validation auc = 0.986048
Epoch 17
Loss = 4.8941e-02, PNorm = 63.2870, GNorm = 0.2844, lr_0 = 2.7675e-04
Loss = 9.3853e-02, PNorm = 63.3326, GNorm = 0.4146, lr_0 = 2.7067e-04
Loss = 8.3593e-02, PNorm = 63.3816, GNorm = 0.3685, lr_0 = 2.6472e-04
Loss = 1.2258e-01, PNorm = 63.4128, GNorm = 0.8743, lr_0 = 2.5890e-04
Validation auc = 0.985671
Epoch 18
Loss = 9.3780e-02, PNorm = 63.4658, GNorm = 0.5204, lr_0 = 2.5264e-04
Loss = 8.4617e-02, PNorm = 63.5059, GNorm = 0.7646, lr_0 = 2.4709e-04
Loss = 9.2034e-02, PNorm = 63.5406, GNorm = 0.3806, lr_0 = 2.4166e-04
Validation auc = 0.980392
Epoch 19
Loss = 5.5325e-02, PNorm = 63.5769, GNorm = 0.3706, lr_0 = 2.3582e-04
Loss = 6.3099e-02, PNorm = 63.6241, GNorm = 0.2007, lr_0 = 2.3064e-04
Loss = 1.1063e-01, PNorm = 63.6499, GNorm = 0.2004, lr_0 = 2.2557e-04
Loss = 9.8060e-02, PNorm = 63.6866, GNorm = 0.3855, lr_0 = 2.2061e-04
Validation auc = 0.979261
Epoch 20
Loss = 7.7964e-02, PNorm = 63.7284, GNorm = 0.4442, lr_0 = 2.1576e-04
Loss = 6.2543e-02, PNorm = 63.7590, GNorm = 0.4378, lr_0 = 2.1102e-04
Loss = 6.5266e-02, PNorm = 63.7887, GNorm = 0.2474, lr_0 = 2.0638e-04
Loss = 7.9131e-02, PNorm = 63.8157, GNorm = 0.6960, lr_0 = 2.0185e-04
Validation auc = 0.981146
Epoch 21
Loss = 8.0745e-02, PNorm = 63.8505, GNorm = 0.9855, lr_0 = 1.9697e-04
Loss = 7.1019e-02, PNorm = 63.8850, GNorm = 0.2543, lr_0 = 1.9264e-04
Loss = 7.9793e-02, PNorm = 63.9201, GNorm = 0.6899, lr_0 = 1.8841e-04
Loss = 6.9244e-02, PNorm = 63.9413, GNorm = 0.4453, lr_0 = 1.8427e-04
Validation auc = 0.980769
Epoch 22
Loss = 5.4750e-02, PNorm = 63.9769, GNorm = 0.2511, lr_0 = 1.7982e-04
Loss = 5.7269e-02, PNorm = 64.0031, GNorm = 0.3558, lr_0 = 1.7586e-04
Loss = 7.8932e-02, PNorm = 64.0283, GNorm = 0.4228, lr_0 = 1.7200e-04
Validation auc = 0.972474
Epoch 23
Loss = 3.4799e-02, PNorm = 64.0501, GNorm = 0.3520, lr_0 = 1.6822e-04
Loss = 7.5174e-02, PNorm = 64.0670, GNorm = 0.6572, lr_0 = 1.6452e-04
Loss = 4.2592e-02, PNorm = 64.1002, GNorm = 0.5821, lr_0 = 1.6090e-04
Loss = 8.0191e-02, PNorm = 64.1208, GNorm = 1.0086, lr_0 = 1.5737e-04
Validation auc = 0.981523
Epoch 24
Loss = 5.7056e-02, PNorm = 64.1398, GNorm = 0.1928, lr_0 = 1.5357e-04
Loss = 4.8567e-02, PNorm = 64.1605, GNorm = 0.6300, lr_0 = 1.5019e-04
Loss = 5.3107e-02, PNorm = 64.1847, GNorm = 0.4618, lr_0 = 1.4689e-04
Loss = 5.8001e-02, PNorm = 64.2058, GNorm = 0.7400, lr_0 = 1.4366e-04
Validation auc = 0.981146
Epoch 25
Loss = 5.1334e-02, PNorm = 64.2194, GNorm = 0.3966, lr_0 = 1.4050e-04
Loss = 5.0837e-02, PNorm = 64.2357, GNorm = 0.6378, lr_0 = 1.3741e-04
Loss = 8.1290e-02, PNorm = 64.2547, GNorm = 0.5565, lr_0 = 1.3439e-04
Loss = 5.3529e-02, PNorm = 64.2734, GNorm = 0.5225, lr_0 = 1.3144e-04
Validation auc = 0.975490
Epoch 26
Loss = 3.5629e-02, PNorm = 64.2944, GNorm = 0.2204, lr_0 = 1.2826e-04
Loss = 5.2995e-02, PNorm = 64.3079, GNorm = 0.5798, lr_0 = 1.2545e-04
Loss = 4.7979e-02, PNorm = 64.3227, GNorm = 0.7620, lr_0 = 1.2269e-04
Validation auc = 0.976244
Epoch 27
Loss = 5.0075e-02, PNorm = 64.3399, GNorm = 0.6141, lr_0 = 1.1973e-04
Loss = 4.5066e-02, PNorm = 64.3545, GNorm = 1.5120, lr_0 = 1.1709e-04
Loss = 5.5879e-02, PNorm = 64.3676, GNorm = 1.3023, lr_0 = 1.1452e-04
Loss = 4.4846e-02, PNorm = 64.3815, GNorm = 0.9544, lr_0 = 1.1200e-04
Validation auc = 0.962293
Epoch 28
Loss = 2.7535e-02, PNorm = 64.3994, GNorm = 0.6531, lr_0 = 1.0954e-04
Loss = 4.2037e-02, PNorm = 64.4053, GNorm = 0.5705, lr_0 = 1.0713e-04
Loss = 4.4292e-02, PNorm = 64.4227, GNorm = 0.1446, lr_0 = 1.0478e-04
Loss = 6.5280e-02, PNorm = 64.4333, GNorm = 0.9340, lr_0 = 1.0247e-04
Validation auc = 0.969080
Epoch 29
Loss = 5.8380e-02, PNorm = 64.4490, GNorm = 0.1950, lr_0 = 1.0000e-04
Loss = 4.4947e-02, PNorm = 64.4608, GNorm = 0.2261, lr_0 = 1.0000e-04
Loss = 2.9159e-02, PNorm = 64.4760, GNorm = 0.2411, lr_0 = 1.0000e-04
Loss = 3.6587e-02, PNorm = 64.4854, GNorm = 1.1509, lr_0 = 1.0000e-04
Loss = 2.1162e-01, PNorm = 64.4850, GNorm = 2.6375, lr_0 = 1.0000e-04
Validation auc = 0.976244
Model 2 best validation auc = 0.989065 on epoch 15
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 2 test auc = 0.872078
Ensemble test auc = 0.859091
Fold 1
Splitting data with seed 1
Class sizes
hit 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 1,868 | val size = 233 | test size = 234
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 2.4944e-01, PNorm = 59.4447, GNorm = 0.7088, lr_0 = 2.3378e-04
Loss = 1.7176e-01, PNorm = 59.4692, GNorm = 0.4608, lr_0 = 3.5541e-04
Loss = 2.5055e-01, PNorm = 59.4984, GNorm = 0.6014, lr_0 = 4.7703e-04
Validation auc = 0.541171
Epoch 1
Loss = 2.9025e-01, PNorm = 59.5449, GNorm = 0.6175, lr_0 = 6.1081e-04
Loss = 2.1484e-01, PNorm = 59.6183, GNorm = 0.4358, lr_0 = 7.3243e-04
Loss = 1.6641e-01, PNorm = 59.6901, GNorm = 0.3322, lr_0 = 8.5405e-04
Loss = 2.1565e-01, PNorm = 59.7652, GNorm = 0.4833, lr_0 = 9.7568e-04
Validation auc = 0.679067
Epoch 2
Loss = 1.2325e-01, PNorm = 59.8478, GNorm = 0.3849, lr_0 = 9.8020e-04
Loss = 1.9141e-01, PNorm = 59.9160, GNorm = 0.6352, lr_0 = 9.5865e-04
Loss = 1.7838e-01, PNorm = 59.9947, GNorm = 0.3799, lr_0 = 9.3758e-04
Loss = 2.0368e-01, PNorm = 60.0642, GNorm = 0.4001, lr_0 = 9.1697e-04
Validation auc = 0.722718
Epoch 3
Loss = 2.2654e-01, PNorm = 60.1363, GNorm = 0.3437, lr_0 = 8.9681e-04
Loss = 1.5074e-01, PNorm = 60.2106, GNorm = 0.7458, lr_0 = 8.7710e-04
Loss = 1.9743e-01, PNorm = 60.2644, GNorm = 0.3195, lr_0 = 8.5782e-04
Validation auc = 0.674107
Epoch 4
Loss = 2.5952e-01, PNorm = 60.3557, GNorm = 0.7452, lr_0 = 8.3710e-04
Loss = 1.5529e-01, PNorm = 60.4121, GNorm = 0.2627, lr_0 = 8.1870e-04
Loss = 1.1758e-01, PNorm = 60.4677, GNorm = 0.3349, lr_0 = 8.0071e-04
Loss = 1.8390e-01, PNorm = 60.5306, GNorm = 0.3009, lr_0 = 7.8311e-04
Validation auc = 0.713294
Epoch 5
Loss = 1.6532e-01, PNorm = 60.6003, GNorm = 0.5939, lr_0 = 7.6420e-04
Loss = 1.4232e-01, PNorm = 60.6903, GNorm = 0.2841, lr_0 = 7.4740e-04
Loss = 1.4719e-01, PNorm = 60.7560, GNorm = 0.8513, lr_0 = 7.3097e-04
Loss = 1.4186e-01, PNorm = 60.8354, GNorm = 0.3919, lr_0 = 7.1490e-04
Validation auc = 0.698413
Epoch 6
Loss = 1.6175e-01, PNorm = 60.9128, GNorm = 0.2075, lr_0 = 6.9919e-04
Loss = 1.5237e-01, PNorm = 60.9920, GNorm = 0.8550, lr_0 = 6.8382e-04
Loss = 1.1536e-01, PNorm = 61.0643, GNorm = 0.2224, lr_0 = 6.6879e-04
Loss = 1.4555e-01, PNorm = 61.1273, GNorm = 0.6028, lr_0 = 6.5409e-04
Validation auc = 0.731151
Epoch 7
Loss = 1.5530e-01, PNorm = 61.1834, GNorm = 0.5162, lr_0 = 6.3829e-04
Loss = 1.1823e-01, PNorm = 61.2557, GNorm = 0.2776, lr_0 = 6.2426e-04
Loss = 1.2415e-01, PNorm = 61.3438, GNorm = 0.4945, lr_0 = 6.1054e-04
Validation auc = 0.708333
Epoch 8
Loss = 1.3897e-01, PNorm = 61.4158, GNorm = 0.5627, lr_0 = 5.9579e-04
Loss = 1.2840e-01, PNorm = 61.4798, GNorm = 0.2435, lr_0 = 5.8270e-04
Loss = 1.1715e-01, PNorm = 61.5417, GNorm = 0.4074, lr_0 = 5.6989e-04
Loss = 9.2946e-02, PNorm = 61.6114, GNorm = 0.4599, lr_0 = 5.5736e-04
Validation auc = 0.722222
Epoch 9
Loss = 1.5783e-01, PNorm = 61.6604, GNorm = 0.4751, lr_0 = 5.4511e-04
Loss = 1.2151e-01, PNorm = 61.7406, GNorm = 0.7560, lr_0 = 5.3313e-04
Loss = 1.3011e-01, PNorm = 61.7900, GNorm = 0.4145, lr_0 = 5.2141e-04
Loss = 9.0610e-02, PNorm = 61.8438, GNorm = 0.4524, lr_0 = 5.0995e-04
Validation auc = 0.700893
Epoch 10
Loss = 1.0825e-01, PNorm = 61.9098, GNorm = 0.1953, lr_0 = 4.9764e-04
Loss = 1.0206e-01, PNorm = 61.9760, GNorm = 0.5693, lr_0 = 4.8670e-04
Loss = 1.1516e-01, PNorm = 62.0333, GNorm = 0.5108, lr_0 = 4.7600e-04
Loss = 1.1380e-01, PNorm = 62.0813, GNorm = 0.3169, lr_0 = 4.6554e-04
Loss = 4.4298e-02, PNorm = 62.0882, GNorm = 0.4273, lr_0 = 4.6450e-04
Validation auc = 0.747520
Epoch 11
Loss = 1.0413e-01, PNorm = 62.1506, GNorm = 0.2718, lr_0 = 4.5429e-04
Loss = 1.2747e-01, PNorm = 62.2028, GNorm = 0.8365, lr_0 = 4.4431e-04
Loss = 9.1260e-02, PNorm = 62.2519, GNorm = 0.2930, lr_0 = 4.3454e-04
Validation auc = 0.719742
Epoch 12
Loss = 7.5079e-02, PNorm = 62.3000, GNorm = 0.2526, lr_0 = 4.2499e-04
Loss = 1.0330e-01, PNorm = 62.3372, GNorm = 0.5656, lr_0 = 4.1565e-04
Loss = 9.7340e-02, PNorm = 62.3878, GNorm = 0.1220, lr_0 = 4.0651e-04
Loss = 7.8831e-02, PNorm = 62.4418, GNorm = 0.9930, lr_0 = 3.9758e-04
Validation auc = 0.731647
Epoch 13
Loss = 6.4398e-02, PNorm = 62.4888, GNorm = 0.3241, lr_0 = 3.8797e-04
Loss = 6.6853e-02, PNorm = 62.5373, GNorm = 0.4645, lr_0 = 3.7945e-04
Loss = 1.3269e-01, PNorm = 62.5833, GNorm = 0.5339, lr_0 = 3.7111e-04
Loss = 9.1649e-02, PNorm = 62.6392, GNorm = 0.6436, lr_0 = 3.6295e-04
Validation auc = 0.726687
Epoch 14
Loss = 1.2885e-01, PNorm = 62.6841, GNorm = 0.4217, lr_0 = 3.5497e-04
Loss = 7.5831e-02, PNorm = 62.7559, GNorm = 0.3199, lr_0 = 3.4717e-04
Loss = 8.5438e-02, PNorm = 62.7984, GNorm = 0.3479, lr_0 = 3.3954e-04
Loss = 7.7601e-02, PNorm = 62.8385, GNorm = 0.3722, lr_0 = 3.3207e-04
Loss = 2.5210e-02, PNorm = 62.8429, GNorm = 0.3417, lr_0 = 3.3134e-04
Validation auc = 0.721726
Epoch 15
Loss = 7.0698e-02, PNorm = 62.8909, GNorm = 0.1777, lr_0 = 3.2405e-04
Loss = 9.2829e-02, PNorm = 62.9351, GNorm = 0.4097, lr_0 = 3.1693e-04
Loss = 8.7425e-02, PNorm = 62.9726, GNorm = 0.3783, lr_0 = 3.0997e-04
Validation auc = 0.750992
Epoch 16
Loss = 4.7541e-02, PNorm = 63.0292, GNorm = 0.2368, lr_0 = 3.0248e-04
Loss = 9.5655e-02, PNorm = 63.0511, GNorm = 0.2580, lr_0 = 2.9583e-04
Loss = 6.9965e-02, PNorm = 63.0764, GNorm = 0.4468, lr_0 = 2.8933e-04
Loss = 7.1905e-02, PNorm = 63.1247, GNorm = 0.3598, lr_0 = 2.8297e-04
Validation auc = 0.722222
Epoch 17
Loss = 8.4244e-02, PNorm = 63.1557, GNorm = 0.6090, lr_0 = 2.7675e-04
Loss = 5.3270e-02, PNorm = 63.1972, GNorm = 0.2760, lr_0 = 2.7067e-04
Loss = 6.7023e-02, PNorm = 63.2343, GNorm = 0.4099, lr_0 = 2.6472e-04
Loss = 8.5973e-02, PNorm = 63.2601, GNorm = 0.4943, lr_0 = 2.5890e-04
Validation auc = 0.733135
Epoch 18
Loss = 6.5432e-02, PNorm = 63.3037, GNorm = 0.9090, lr_0 = 2.5264e-04
Loss = 6.4962e-02, PNorm = 63.3325, GNorm = 0.5191, lr_0 = 2.4709e-04
Loss = 7.7817e-02, PNorm = 63.3663, GNorm = 0.3255, lr_0 = 2.4166e-04
Validation auc = 0.731151
Epoch 19
Loss = 2.2327e-02, PNorm = 63.4038, GNorm = 0.1867, lr_0 = 2.3582e-04
Loss = 5.6961e-02, PNorm = 63.4314, GNorm = 0.6360, lr_0 = 2.3064e-04
Loss = 5.6638e-02, PNorm = 63.4594, GNorm = 0.4608, lr_0 = 2.2557e-04
Loss = 6.2829e-02, PNorm = 63.4832, GNorm = 0.2704, lr_0 = 2.2061e-04
Validation auc = 0.723710
Epoch 20
Loss = 3.2512e-02, PNorm = 63.5079, GNorm = 0.2641, lr_0 = 2.1576e-04
Loss = 5.6712e-02, PNorm = 63.5346, GNorm = 0.3934, lr_0 = 2.1102e-04
Loss = 5.4652e-02, PNorm = 63.5629, GNorm = 0.5670, lr_0 = 2.0638e-04
Loss = 5.2538e-02, PNorm = 63.5906, GNorm = 0.4042, lr_0 = 2.0185e-04
Validation auc = 0.725198
Epoch 21
Loss = 6.2719e-02, PNorm = 63.6159, GNorm = 0.4235, lr_0 = 1.9697e-04
Loss = 6.8017e-02, PNorm = 63.6458, GNorm = 1.4517, lr_0 = 1.9264e-04
Loss = 6.0858e-02, PNorm = 63.6597, GNorm = 0.4776, lr_0 = 1.8841e-04
Loss = 5.8203e-02, PNorm = 63.6918, GNorm = 0.6133, lr_0 = 1.8427e-04
Validation auc = 0.728175
Epoch 22
Loss = 3.3755e-02, PNorm = 63.7125, GNorm = 0.6724, lr_0 = 1.7982e-04
Loss = 5.5747e-02, PNorm = 63.7295, GNorm = 0.3731, lr_0 = 1.7586e-04
Loss = 6.2529e-02, PNorm = 63.7453, GNorm = 0.3420, lr_0 = 1.7200e-04
Validation auc = 0.739087
Epoch 23
Loss = 3.1232e-02, PNorm = 63.7654, GNorm = 0.2377, lr_0 = 1.6822e-04
Loss = 3.8591e-02, PNorm = 63.7921, GNorm = 0.2890, lr_0 = 1.6452e-04
Loss = 7.4182e-02, PNorm = 63.8037, GNorm = 0.5111, lr_0 = 1.6090e-04
Loss = 3.6268e-02, PNorm = 63.8289, GNorm = 0.3052, lr_0 = 1.5737e-04
Validation auc = 0.721726
Epoch 24
Loss = 5.1114e-02, PNorm = 63.8445, GNorm = 0.1647, lr_0 = 1.5357e-04
Loss = 4.6285e-02, PNorm = 63.8656, GNorm = 0.6347, lr_0 = 1.5019e-04
Loss = 3.9869e-02, PNorm = 63.8808, GNorm = 0.1776, lr_0 = 1.4689e-04
Loss = 4.5887e-02, PNorm = 63.8973, GNorm = 0.5919, lr_0 = 1.4366e-04
Validation auc = 0.720238
Epoch 25
Loss = 4.2813e-02, PNorm = 63.9073, GNorm = 0.1862, lr_0 = 1.4050e-04
Loss = 4.4240e-02, PNorm = 63.9193, GNorm = 0.6790, lr_0 = 1.3741e-04
Loss = 3.4365e-02, PNorm = 63.9348, GNorm = 0.7137, lr_0 = 1.3439e-04
Loss = 3.0500e-02, PNorm = 63.9488, GNorm = 0.3155, lr_0 = 1.3144e-04
Validation auc = 0.721230
Epoch 26
Loss = 2.9666e-02, PNorm = 63.9605, GNorm = 0.4117, lr_0 = 1.2826e-04
Loss = 3.0603e-02, PNorm = 63.9775, GNorm = 0.6358, lr_0 = 1.2545e-04
Loss = 4.1118e-02, PNorm = 63.9869, GNorm = 0.5967, lr_0 = 1.2269e-04
Validation auc = 0.710813
Epoch 27
Loss = 2.9591e-02, PNorm = 64.0023, GNorm = 0.3434, lr_0 = 1.1973e-04
Loss = 3.4204e-02, PNorm = 64.0157, GNorm = 0.9637, lr_0 = 1.1709e-04
Loss = 2.9699e-02, PNorm = 64.0300, GNorm = 0.9411, lr_0 = 1.1452e-04
Loss = 4.1764e-02, PNorm = 64.0390, GNorm = 0.6111, lr_0 = 1.1200e-04
Validation auc = 0.721230
Epoch 28
Loss = 2.3829e-02, PNorm = 64.0483, GNorm = 0.2783, lr_0 = 1.0954e-04
Loss = 4.3957e-02, PNorm = 64.0669, GNorm = 0.1025, lr_0 = 1.0713e-04
Loss = 3.5340e-02, PNorm = 64.0759, GNorm = 0.2072, lr_0 = 1.0478e-04
Loss = 3.2097e-02, PNorm = 64.0886, GNorm = 0.3465, lr_0 = 1.0247e-04
Validation auc = 0.722222
Epoch 29
Loss = 3.9638e-02, PNorm = 64.1009, GNorm = 0.4359, lr_0 = 1.0000e-04
Loss = 3.1326e-02, PNorm = 64.1086, GNorm = 0.1320, lr_0 = 1.0000e-04
Loss = 2.2128e-02, PNorm = 64.1163, GNorm = 0.3108, lr_0 = 1.0000e-04
Loss = 3.1607e-02, PNorm = 64.1303, GNorm = 0.0832, lr_0 = 1.0000e-04
Loss = 1.0789e-02, PNorm = 64.1316, GNorm = 0.4299, lr_0 = 1.0000e-04
Validation auc = 0.719742
Model 0 best validation auc = 0.750992 on epoch 15
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = 0.858996
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 2.9743e-01, PNorm = 59.4721, GNorm = 1.4110, lr_0 = 2.3378e-04
Loss = 2.0954e-01, PNorm = 59.4979, GNorm = 0.3090, lr_0 = 3.5541e-04
Loss = 2.3388e-01, PNorm = 59.5256, GNorm = 0.5246, lr_0 = 4.7703e-04
Validation auc = 0.597222
Epoch 1
Loss = 1.7189e-01, PNorm = 59.5653, GNorm = 0.3656, lr_0 = 6.1081e-04
Loss = 1.5507e-01, PNorm = 59.5980, GNorm = 0.2213, lr_0 = 7.3243e-04
Loss = 1.6060e-01, PNorm = 59.6357, GNorm = 0.4715, lr_0 = 8.5405e-04
Loss = 2.4137e-01, PNorm = 59.6904, GNorm = 0.3976, lr_0 = 9.7568e-04
Validation auc = 0.693452
Epoch 2
Loss = 2.4009e-01, PNorm = 59.7764, GNorm = 0.4806, lr_0 = 9.8020e-04
Loss = 1.9806e-01, PNorm = 59.8751, GNorm = 0.6558, lr_0 = 9.5865e-04
Loss = 1.5384e-01, PNorm = 59.9768, GNorm = 0.2941, lr_0 = 9.3758e-04
Loss = 1.5842e-01, PNorm = 60.0553, GNorm = 0.5701, lr_0 = 9.1697e-04
Validation auc = 0.729167
Epoch 3
Loss = 1.9163e-01, PNorm = 60.1344, GNorm = 0.7713, lr_0 = 8.9681e-04
Loss = 1.6368e-01, PNorm = 60.2251, GNorm = 0.4893, lr_0 = 8.7710e-04
Loss = 1.9108e-01, PNorm = 60.2997, GNorm = 0.3298, lr_0 = 8.5782e-04
Validation auc = 0.713790
Epoch 4
Loss = 2.4190e-01, PNorm = 60.3814, GNorm = 0.5395, lr_0 = 8.3710e-04
Loss = 1.6123e-01, PNorm = 60.4707, GNorm = 0.7820, lr_0 = 8.1870e-04
Loss = 1.6791e-01, PNorm = 60.5537, GNorm = 0.9363, lr_0 = 8.0071e-04
Loss = 1.4558e-01, PNorm = 60.6233, GNorm = 0.3394, lr_0 = 7.8311e-04
Validation auc = 0.727679
Epoch 5
Loss = 1.7122e-01, PNorm = 60.7126, GNorm = 0.3359, lr_0 = 7.6420e-04
Loss = 1.1992e-01, PNorm = 60.7925, GNorm = 0.2549, lr_0 = 7.4740e-04
Loss = 1.6633e-01, PNorm = 60.8599, GNorm = 0.3151, lr_0 = 7.3097e-04
Loss = 1.3531e-01, PNorm = 60.9223, GNorm = 0.2392, lr_0 = 7.1490e-04
Validation auc = 0.744048
Epoch 6
Loss = 1.4752e-01, PNorm = 61.0044, GNorm = 0.4845, lr_0 = 6.9919e-04
Loss = 1.2247e-01, PNorm = 61.0890, GNorm = 0.7843, lr_0 = 6.8382e-04
Loss = 1.2248e-01, PNorm = 61.1957, GNorm = 0.2215, lr_0 = 6.6879e-04
Loss = 1.6444e-01, PNorm = 61.2632, GNorm = 0.4858, lr_0 = 6.5409e-04
Validation auc = 0.733631
Epoch 7
Loss = 1.6264e-01, PNorm = 61.3658, GNorm = 0.4996, lr_0 = 6.3829e-04
Loss = 1.1735e-01, PNorm = 61.4195, GNorm = 0.3272, lr_0 = 6.2426e-04
Loss = 9.6298e-02, PNorm = 61.4935, GNorm = 0.2902, lr_0 = 6.1054e-04
Validation auc = 0.739583
Epoch 8
Loss = 9.2139e-02, PNorm = 61.5455, GNorm = 0.4049, lr_0 = 5.9579e-04
Loss = 1.3281e-01, PNorm = 61.6211, GNorm = 0.4208, lr_0 = 5.8270e-04
Loss = 1.4398e-01, PNorm = 61.6890, GNorm = 0.8686, lr_0 = 5.6989e-04
Loss = 7.3255e-02, PNorm = 61.7687, GNorm = 0.1933, lr_0 = 5.5736e-04
Validation auc = 0.781746
Epoch 9
Loss = 5.8704e-02, PNorm = 61.8118, GNorm = 0.5923, lr_0 = 5.4511e-04
Loss = 1.3671e-01, PNorm = 61.8630, GNorm = 0.8149, lr_0 = 5.3313e-04
Loss = 1.3651e-01, PNorm = 61.9226, GNorm = 0.5351, lr_0 = 5.2141e-04
Loss = 1.2003e-01, PNorm = 61.9839, GNorm = 0.4779, lr_0 = 5.0995e-04
Validation auc = 0.759921
Epoch 10
Loss = 6.1916e-02, PNorm = 62.0557, GNorm = 0.8294, lr_0 = 4.9764e-04
Loss = 1.3370e-01, PNorm = 62.0944, GNorm = 0.7050, lr_0 = 4.8670e-04
Loss = 1.3905e-01, PNorm = 62.1545, GNorm = 0.2138, lr_0 = 4.7600e-04
Loss = 1.1111e-01, PNorm = 62.2207, GNorm = 0.4998, lr_0 = 4.6554e-04
Loss = 1.1438e-01, PNorm = 62.2287, GNorm = 0.5656, lr_0 = 4.6450e-04
Validation auc = 0.732639
Epoch 11
Loss = 5.8021e-02, PNorm = 62.3037, GNorm = 0.0650, lr_0 = 4.5429e-04
Loss = 9.7391e-02, PNorm = 62.3345, GNorm = 0.5848, lr_0 = 4.4431e-04
Loss = 1.2910e-01, PNorm = 62.3758, GNorm = 0.4067, lr_0 = 4.3454e-04
Validation auc = 0.749008
Epoch 12
Loss = 1.4491e-01, PNorm = 62.4241, GNorm = 0.6133, lr_0 = 4.2499e-04
Loss = 1.1007e-01, PNorm = 62.4732, GNorm = 0.3213, lr_0 = 4.1565e-04
Loss = 6.8468e-02, PNorm = 62.5331, GNorm = 0.6915, lr_0 = 4.0651e-04
Loss = 1.1496e-01, PNorm = 62.5874, GNorm = 0.4825, lr_0 = 3.9758e-04
Validation auc = 0.792659
Epoch 13
Loss = 9.0195e-02, PNorm = 62.6474, GNorm = 0.3140, lr_0 = 3.8797e-04
Loss = 9.7957e-02, PNorm = 62.7015, GNorm = 0.3106, lr_0 = 3.7945e-04
Loss = 8.3079e-02, PNorm = 62.7485, GNorm = 0.6332, lr_0 = 3.7111e-04
Loss = 1.2073e-01, PNorm = 62.7929, GNorm = 0.5229, lr_0 = 3.6295e-04
Validation auc = 0.756944
Epoch 14
Loss = 7.4678e-02, PNorm = 62.8312, GNorm = 0.2763, lr_0 = 3.5497e-04
Loss = 5.7660e-02, PNorm = 62.8768, GNorm = 0.2141, lr_0 = 3.4717e-04
Loss = 1.0493e-01, PNorm = 62.9045, GNorm = 0.6326, lr_0 = 3.3954e-04
Loss = 1.0316e-01, PNorm = 62.9483, GNorm = 0.7140, lr_0 = 3.3207e-04
Loss = 5.4938e-03, PNorm = 62.9537, GNorm = 0.0801, lr_0 = 3.3134e-04
Validation auc = 0.770337
Epoch 15
Loss = 9.5966e-02, PNorm = 62.9930, GNorm = 0.3444, lr_0 = 3.2405e-04
Loss = 9.3465e-02, PNorm = 63.0343, GNorm = 0.2353, lr_0 = 3.1693e-04
Loss = 6.4779e-02, PNorm = 63.0742, GNorm = 0.3303, lr_0 = 3.0997e-04
Validation auc = 0.741071
Epoch 16
Loss = 6.1920e-02, PNorm = 63.1119, GNorm = 0.5877, lr_0 = 3.0248e-04
Loss = 6.7192e-02, PNorm = 63.1544, GNorm = 0.4110, lr_0 = 2.9583e-04
Loss = 8.7001e-02, PNorm = 63.1779, GNorm = 0.6905, lr_0 = 2.8933e-04
Loss = 8.1085e-02, PNorm = 63.2105, GNorm = 0.3517, lr_0 = 2.8297e-04
Validation auc = 0.732639
Epoch 17
Loss = 4.9395e-02, PNorm = 63.2480, GNorm = 0.6894, lr_0 = 2.7675e-04
Loss = 7.0219e-02, PNorm = 63.2757, GNorm = 0.2331, lr_0 = 2.7067e-04
Loss = 8.1424e-02, PNorm = 63.3034, GNorm = 0.2179, lr_0 = 2.6472e-04
Loss = 6.5868e-02, PNorm = 63.3333, GNorm = 0.2283, lr_0 = 2.5890e-04
Validation auc = 0.747520
Epoch 18
Loss = 6.5499e-02, PNorm = 63.3725, GNorm = 0.5115, lr_0 = 2.5264e-04
Loss = 6.2560e-02, PNorm = 63.4075, GNorm = 0.5686, lr_0 = 2.4709e-04
Loss = 7.8859e-02, PNorm = 63.4379, GNorm = 0.2432, lr_0 = 2.4166e-04
Validation auc = 0.746528
Epoch 19
Loss = 1.4502e-01, PNorm = 63.4842, GNorm = 0.9216, lr_0 = 2.3582e-04
Loss = 5.9305e-02, PNorm = 63.5070, GNorm = 0.5005, lr_0 = 2.3064e-04
Loss = 6.4959e-02, PNorm = 63.5394, GNorm = 0.1861, lr_0 = 2.2557e-04
Loss = 7.6957e-02, PNorm = 63.5610, GNorm = 0.4149, lr_0 = 2.2061e-04
Validation auc = 0.737599
Epoch 20
Loss = 6.9130e-02, PNorm = 63.5874, GNorm = 0.4223, lr_0 = 2.1576e-04
Loss = 4.9619e-02, PNorm = 63.6122, GNorm = 0.3413, lr_0 = 2.1102e-04
Loss = 5.2653e-02, PNorm = 63.6443, GNorm = 0.7280, lr_0 = 2.0638e-04
Loss = 6.8335e-02, PNorm = 63.6589, GNorm = 0.6173, lr_0 = 2.0185e-04
Validation auc = 0.748016
Epoch 21
Loss = 6.6445e-02, PNorm = 63.6861, GNorm = 0.3047, lr_0 = 1.9697e-04
Loss = 4.5359e-02, PNorm = 63.7104, GNorm = 0.1893, lr_0 = 1.9264e-04
Loss = 5.9854e-02, PNorm = 63.7343, GNorm = 0.4985, lr_0 = 1.8841e-04
Loss = 4.0454e-02, PNorm = 63.7540, GNorm = 0.5681, lr_0 = 1.8427e-04
Validation auc = 0.763393
Epoch 22
Loss = 5.3503e-02, PNorm = 63.7696, GNorm = 0.1521, lr_0 = 1.7982e-04
Loss = 6.4764e-02, PNorm = 63.7907, GNorm = 0.4485, lr_0 = 1.7586e-04
Loss = 3.0682e-02, PNorm = 63.8175, GNorm = 0.1127, lr_0 = 1.7200e-04
Validation auc = 0.743552
Epoch 23
Loss = 5.3608e-02, PNorm = 63.8291, GNorm = 0.9417, lr_0 = 1.6822e-04
Loss = 3.6941e-02, PNorm = 63.8488, GNorm = 0.2496, lr_0 = 1.6452e-04
Loss = 4.6985e-02, PNorm = 63.8706, GNorm = 0.5054, lr_0 = 1.6090e-04
Loss = 4.5173e-02, PNorm = 63.8833, GNorm = 0.5994, lr_0 = 1.5737e-04
Validation auc = 0.757440
Epoch 24
Loss = 3.4011e-02, PNorm = 63.9008, GNorm = 0.2598, lr_0 = 1.5357e-04
Loss = 4.0736e-02, PNorm = 63.9227, GNorm = 0.3183, lr_0 = 1.5019e-04
Loss = 3.9547e-02, PNorm = 63.9422, GNorm = 1.0837, lr_0 = 1.4689e-04
Loss = 5.5311e-02, PNorm = 63.9549, GNorm = 0.3076, lr_0 = 1.4366e-04
Validation auc = 0.750000
Epoch 25
Loss = 5.9645e-02, PNorm = 63.9668, GNorm = 0.8376, lr_0 = 1.4050e-04
Loss = 4.1795e-02, PNorm = 63.9883, GNorm = 0.9484, lr_0 = 1.3741e-04
Loss = 4.0190e-02, PNorm = 63.9997, GNorm = 0.4963, lr_0 = 1.3439e-04
Loss = 2.8819e-02, PNorm = 64.0199, GNorm = 0.2492, lr_0 = 1.3144e-04
Validation auc = 0.739583
Epoch 26
Loss = 3.4191e-02, PNorm = 64.0357, GNorm = 0.6814, lr_0 = 1.2826e-04
Loss = 4.6903e-02, PNorm = 64.0445, GNorm = 0.7384, lr_0 = 1.2545e-04
Loss = 4.5083e-02, PNorm = 64.0615, GNorm = 0.2070, lr_0 = 1.2269e-04
Validation auc = 0.747520
Epoch 27
Loss = 2.0476e-02, PNorm = 64.0771, GNorm = 0.1511, lr_0 = 1.1973e-04
Loss = 4.2740e-02, PNorm = 64.0878, GNorm = 0.2674, lr_0 = 1.1709e-04
Loss = 4.4177e-02, PNorm = 64.1015, GNorm = 0.2793, lr_0 = 1.1452e-04
Loss = 3.2735e-02, PNorm = 64.1158, GNorm = 0.7721, lr_0 = 1.1200e-04
Validation auc = 0.750992
Epoch 28
Loss = 3.3907e-02, PNorm = 64.1258, GNorm = 0.2283, lr_0 = 1.0954e-04
Loss = 1.5190e-02, PNorm = 64.1364, GNorm = 0.3222, lr_0 = 1.0713e-04
Loss = 2.3710e-02, PNorm = 64.1450, GNorm = 0.4904, lr_0 = 1.0478e-04
Loss = 5.3303e-02, PNorm = 64.1546, GNorm = 0.0541, lr_0 = 1.0247e-04
Validation auc = 0.740575
Epoch 29
Loss = 3.4644e-02, PNorm = 64.1706, GNorm = 0.4732, lr_0 = 1.0000e-04
Loss = 2.2755e-02, PNorm = 64.1806, GNorm = 0.2492, lr_0 = 1.0000e-04
Loss = 2.9961e-02, PNorm = 64.1876, GNorm = 0.8259, lr_0 = 1.0000e-04
Loss = 3.0586e-02, PNorm = 64.1964, GNorm = 0.1363, lr_0 = 1.0000e-04
Loss = 2.3427e-02, PNorm = 64.1973, GNorm = 0.6263, lr_0 = 1.0000e-04
Validation auc = 0.737599
Model 1 best validation auc = 0.792659 on epoch 12
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 1 test auc = 0.854590
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 2.8799e-01, PNorm = 59.4766, GNorm = 0.4888, lr_0 = 2.3378e-04
Loss = 1.7092e-01, PNorm = 59.5045, GNorm = 0.4829, lr_0 = 3.5541e-04
Loss = 2.0513e-01, PNorm = 59.5292, GNorm = 0.3469, lr_0 = 4.7703e-04
Validation auc = 0.685020
Epoch 1
Loss = 1.9550e-01, PNorm = 59.5636, GNorm = 0.3105, lr_0 = 6.1081e-04
Loss = 2.1584e-01, PNorm = 59.6022, GNorm = 0.3226, lr_0 = 7.3243e-04
Loss = 1.5169e-01, PNorm = 59.6533, GNorm = 1.0818, lr_0 = 8.5405e-04
Loss = 2.0775e-01, PNorm = 59.7220, GNorm = 0.5931, lr_0 = 9.7568e-04
Validation auc = 0.728671
Epoch 2
Loss = 1.4346e-01, PNorm = 59.8197, GNorm = 0.1944, lr_0 = 9.8020e-04
Loss = 1.2674e-01, PNorm = 59.9041, GNorm = 0.3707, lr_0 = 9.5865e-04
Loss = 2.3373e-01, PNorm = 59.9747, GNorm = 0.3597, lr_0 = 9.3758e-04
Loss = 1.9696e-01, PNorm = 60.0655, GNorm = 0.4577, lr_0 = 9.1697e-04
Validation auc = 0.725694
Epoch 3
Loss = 1.4420e-01, PNorm = 60.1525, GNorm = 0.3209, lr_0 = 8.9681e-04
Loss = 1.9647e-01, PNorm = 60.2342, GNorm = 0.5603, lr_0 = 8.7710e-04
Loss = 1.6844e-01, PNorm = 60.3024, GNorm = 0.3400, lr_0 = 8.5782e-04
Validation auc = 0.677083
Epoch 4
Loss = 9.4927e-02, PNorm = 60.3844, GNorm = 0.2134, lr_0 = 8.3710e-04
Loss = 1.4057e-01, PNorm = 60.4699, GNorm = 0.6741, lr_0 = 8.1870e-04
Loss = 2.0790e-01, PNorm = 60.5534, GNorm = 1.3062, lr_0 = 8.0071e-04
Loss = 1.2923e-01, PNorm = 60.6434, GNorm = 0.4056, lr_0 = 7.8311e-04
Validation auc = 0.683036
Epoch 5
Loss = 1.9313e-01, PNorm = 60.7101, GNorm = 0.5887, lr_0 = 7.6420e-04
Loss = 1.5217e-01, PNorm = 60.7927, GNorm = 0.3030, lr_0 = 7.4740e-04
Loss = 1.5078e-01, PNorm = 60.8526, GNorm = 0.4778, lr_0 = 7.3097e-04
Loss = 1.0987e-01, PNorm = 60.9191, GNorm = 0.2409, lr_0 = 7.1490e-04
Validation auc = 0.685516
Epoch 6
Loss = 1.1574e-01, PNorm = 60.9788, GNorm = 0.5324, lr_0 = 6.9919e-04
Loss = 1.3724e-01, PNorm = 61.0707, GNorm = 0.3229, lr_0 = 6.8382e-04
Loss = 1.0686e-01, PNorm = 61.1468, GNorm = 0.6204, lr_0 = 6.6879e-04
Loss = 1.7217e-01, PNorm = 61.1953, GNorm = 0.6948, lr_0 = 6.5409e-04
Validation auc = 0.699901
Epoch 7
Loss = 1.6094e-01, PNorm = 61.2884, GNorm = 1.5805, lr_0 = 6.3829e-04
Loss = 1.1103e-01, PNorm = 61.3557, GNorm = 0.2234, lr_0 = 6.2426e-04
Loss = 1.2555e-01, PNorm = 61.4199, GNorm = 0.5069, lr_0 = 6.1054e-04
Validation auc = 0.708333
Epoch 8
Loss = 1.1650e-01, PNorm = 61.4829, GNorm = 0.2618, lr_0 = 5.9579e-04
Loss = 1.1242e-01, PNorm = 61.5451, GNorm = 0.2512, lr_0 = 5.8270e-04
Loss = 1.3195e-01, PNorm = 61.6069, GNorm = 0.3552, lr_0 = 5.6989e-04
Loss = 1.0301e-01, PNorm = 61.6753, GNorm = 0.2507, lr_0 = 5.5736e-04
Validation auc = 0.716766
Epoch 9
Loss = 8.0179e-02, PNorm = 61.7434, GNorm = 0.5052, lr_0 = 5.4511e-04
Loss = 9.2339e-02, PNorm = 61.8095, GNorm = 0.3690, lr_0 = 5.3313e-04
Loss = 9.8271e-02, PNorm = 61.8733, GNorm = 0.6369, lr_0 = 5.2141e-04
Loss = 1.5153e-01, PNorm = 61.9349, GNorm = 0.8223, lr_0 = 5.0995e-04
Validation auc = 0.726687
Epoch 10
Loss = 9.4966e-02, PNorm = 62.0238, GNorm = 0.4361, lr_0 = 4.9764e-04
Loss = 1.0279e-01, PNorm = 62.1162, GNorm = 0.7525, lr_0 = 4.8670e-04
Loss = 9.5455e-02, PNorm = 62.1918, GNorm = 0.3748, lr_0 = 4.7600e-04
Loss = 9.9382e-02, PNorm = 62.2609, GNorm = 0.8044, lr_0 = 4.6554e-04
Loss = 7.3191e-02, PNorm = 62.2671, GNorm = 1.0140, lr_0 = 4.6450e-04
Validation auc = 0.720734
Epoch 11
Loss = 1.2383e-01, PNorm = 62.3288, GNorm = 0.4414, lr_0 = 4.5429e-04
Loss = 8.1018e-02, PNorm = 62.4084, GNorm = 0.7353, lr_0 = 4.4431e-04
Loss = 1.0130e-01, PNorm = 62.4454, GNorm = 0.5928, lr_0 = 4.3454e-04
Validation auc = 0.716270
Epoch 12
Loss = 1.2352e-01, PNorm = 62.5092, GNorm = 0.4591, lr_0 = 4.2499e-04
Loss = 7.8836e-02, PNorm = 62.5624, GNorm = 0.2812, lr_0 = 4.1565e-04
Loss = 1.0983e-01, PNorm = 62.6030, GNorm = 0.5323, lr_0 = 4.0651e-04
Loss = 1.0644e-01, PNorm = 62.6464, GNorm = 0.4444, lr_0 = 3.9758e-04
Validation auc = 0.729167
Epoch 13
Loss = 6.4835e-02, PNorm = 62.7015, GNorm = 0.4024, lr_0 = 3.8797e-04
Loss = 7.8146e-02, PNorm = 62.7499, GNorm = 0.6491, lr_0 = 3.7945e-04
Loss = 8.5834e-02, PNorm = 62.7926, GNorm = 0.8208, lr_0 = 3.7111e-04
Loss = 1.0557e-01, PNorm = 62.8235, GNorm = 0.3341, lr_0 = 3.6295e-04
Validation auc = 0.744048
Epoch 14
Loss = 7.1001e-02, PNorm = 62.8793, GNorm = 0.3211, lr_0 = 3.5497e-04
Loss = 7.8047e-02, PNorm = 62.9257, GNorm = 0.4688, lr_0 = 3.4717e-04
Loss = 8.7950e-02, PNorm = 62.9810, GNorm = 0.0964, lr_0 = 3.3954e-04
Loss = 8.0029e-02, PNorm = 63.0220, GNorm = 0.6231, lr_0 = 3.3207e-04
Loss = 4.4301e-02, PNorm = 63.0263, GNorm = 0.5031, lr_0 = 3.3134e-04
Validation auc = 0.734623
Epoch 15
Loss = 8.1006e-02, PNorm = 63.0621, GNorm = 0.4585, lr_0 = 3.2405e-04
Loss = 8.3591e-02, PNorm = 63.0913, GNorm = 0.7377, lr_0 = 3.1693e-04
Loss = 6.5306e-02, PNorm = 63.1295, GNorm = 0.2025, lr_0 = 3.0997e-04
Validation auc = 0.732143
Epoch 16
Loss = 3.1167e-02, PNorm = 63.1807, GNorm = 0.4513, lr_0 = 3.0248e-04
Loss = 8.0617e-02, PNorm = 63.2094, GNorm = 0.4000, lr_0 = 2.9583e-04
Loss = 8.9300e-02, PNorm = 63.2633, GNorm = 0.9698, lr_0 = 2.8933e-04
Loss = 7.0831e-02, PNorm = 63.2958, GNorm = 0.3697, lr_0 = 2.8297e-04
Validation auc = 0.737103
Epoch 17
Loss = 4.3563e-02, PNorm = 63.3323, GNorm = 0.2494, lr_0 = 2.7675e-04
Loss = 1.0585e-01, PNorm = 63.3556, GNorm = 0.9373, lr_0 = 2.7067e-04
Loss = 4.9145e-02, PNorm = 63.3999, GNorm = 0.1013, lr_0 = 2.6472e-04
Loss = 7.3453e-02, PNorm = 63.4162, GNorm = 0.2374, lr_0 = 2.5890e-04
Validation auc = 0.742560
Epoch 18
Loss = 8.5958e-02, PNorm = 63.4562, GNorm = 0.5179, lr_0 = 2.5264e-04
Loss = 5.9158e-02, PNorm = 63.4820, GNorm = 0.5304, lr_0 = 2.4709e-04
Loss = 6.9246e-02, PNorm = 63.5044, GNorm = 0.2248, lr_0 = 2.4166e-04
Validation auc = 0.746032
Epoch 19
Loss = 1.0759e-02, PNorm = 63.5466, GNorm = 0.1159, lr_0 = 2.3582e-04
Loss = 5.7302e-02, PNorm = 63.5644, GNorm = 0.2194, lr_0 = 2.3064e-04
Loss = 5.0517e-02, PNorm = 63.5913, GNorm = 0.5341, lr_0 = 2.2557e-04
Loss = 5.7764e-02, PNorm = 63.6091, GNorm = 0.7413, lr_0 = 2.2061e-04
Validation auc = 0.741567
Epoch 20
Loss = 6.1393e-02, PNorm = 63.6286, GNorm = 0.3220, lr_0 = 2.1576e-04
Loss = 5.5895e-02, PNorm = 63.6488, GNorm = 0.3950, lr_0 = 2.1102e-04
Loss = 3.9046e-02, PNorm = 63.6698, GNorm = 0.3738, lr_0 = 2.0638e-04
Loss = 6.1382e-02, PNorm = 63.6924, GNorm = 0.2747, lr_0 = 2.0185e-04
Validation auc = 0.743056
Epoch 21
Loss = 4.6212e-02, PNorm = 63.7185, GNorm = 0.5508, lr_0 = 1.9697e-04
Loss = 5.3912e-02, PNorm = 63.7421, GNorm = 0.3328, lr_0 = 1.9264e-04
Loss = 7.9967e-02, PNorm = 63.7645, GNorm = 0.2213, lr_0 = 1.8841e-04
Loss = 4.4702e-02, PNorm = 63.7922, GNorm = 0.7484, lr_0 = 1.8427e-04
Validation auc = 0.758433
Epoch 22
Loss = 4.1629e-02, PNorm = 63.8130, GNorm = 0.6126, lr_0 = 1.7982e-04
Loss = 4.5745e-02, PNorm = 63.8299, GNorm = 0.1796, lr_0 = 1.7586e-04
Loss = 5.9997e-02, PNorm = 63.8479, GNorm = 0.5050, lr_0 = 1.7200e-04
Validation auc = 0.735119
Epoch 23
Loss = 3.4761e-02, PNorm = 63.8688, GNorm = 0.4043, lr_0 = 1.6822e-04
Loss = 6.3725e-02, PNorm = 63.8839, GNorm = 0.2891, lr_0 = 1.6452e-04
Loss = 3.1795e-02, PNorm = 63.9023, GNorm = 0.2636, lr_0 = 1.6090e-04
Loss = 2.8349e-02, PNorm = 63.9177, GNorm = 0.4872, lr_0 = 1.5737e-04
Validation auc = 0.741567
Epoch 24
Loss = 3.3326e-02, PNorm = 63.9310, GNorm = 0.2565, lr_0 = 1.5357e-04
Loss = 3.1004e-02, PNorm = 63.9514, GNorm = 0.6728, lr_0 = 1.5019e-04
Loss = 4.0967e-02, PNorm = 63.9643, GNorm = 0.3804, lr_0 = 1.4689e-04
Loss = 4.8908e-02, PNorm = 63.9824, GNorm = 0.8061, lr_0 = 1.4366e-04
Validation auc = 0.743552
Epoch 25
Loss = 2.8341e-02, PNorm = 63.9965, GNorm = 0.8857, lr_0 = 1.4050e-04
Loss = 2.1695e-02, PNorm = 64.0122, GNorm = 0.1954, lr_0 = 1.3741e-04
Loss = 3.1603e-02, PNorm = 64.0200, GNorm = 0.5516, lr_0 = 1.3439e-04
Loss = 4.6674e-02, PNorm = 64.0373, GNorm = 0.1693, lr_0 = 1.3144e-04
Validation auc = 0.746528
Epoch 26
Loss = 3.7855e-02, PNorm = 64.0496, GNorm = 0.2699, lr_0 = 1.2826e-04
Loss = 3.7756e-02, PNorm = 64.0655, GNorm = 0.7832, lr_0 = 1.2545e-04
Loss = 3.6067e-02, PNorm = 64.0803, GNorm = 0.3216, lr_0 = 1.2269e-04
Validation auc = 0.747520
Epoch 27
Loss = 5.8167e-02, PNorm = 64.0898, GNorm = 0.2108, lr_0 = 1.1973e-04
Loss = 3.4563e-02, PNorm = 64.1002, GNorm = 0.3875, lr_0 = 1.1709e-04
Loss = 3.3408e-02, PNorm = 64.1135, GNorm = 0.9470, lr_0 = 1.1452e-04
Loss = 3.3675e-02, PNorm = 64.1215, GNorm = 0.3944, lr_0 = 1.1200e-04
Validation auc = 0.741567
Epoch 28
Loss = 3.2420e-02, PNorm = 64.1337, GNorm = 0.6390, lr_0 = 1.0954e-04
Loss = 3.3609e-02, PNorm = 64.1454, GNorm = 0.3432, lr_0 = 1.0713e-04
Loss = 2.0453e-02, PNorm = 64.1593, GNorm = 0.7224, lr_0 = 1.0478e-04
Loss = 1.8051e-02, PNorm = 64.1690, GNorm = 0.3609, lr_0 = 1.0247e-04
Validation auc = 0.743552
Epoch 29
Loss = 3.8959e-02, PNorm = 64.1778, GNorm = 1.2077, lr_0 = 1.0000e-04
Loss = 2.3995e-02, PNorm = 64.1870, GNorm = 0.4121, lr_0 = 1.0000e-04
Loss = 1.7766e-02, PNorm = 64.1989, GNorm = 0.8151, lr_0 = 1.0000e-04
Loss = 3.8800e-02, PNorm = 64.2002, GNorm = 0.6000, lr_0 = 1.0000e-04
Loss = 3.3456e-03, PNorm = 64.2009, GNorm = 0.1230, lr_0 = 1.0000e-04
Validation auc = 0.738095
Model 2 best validation auc = 0.758433 on epoch 21
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 2 test auc = 0.842840
Ensemble test auc = 0.863403
Fold 2
Splitting data with seed 2
Class sizes
hit 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 1,868 | val size = 233 | test size = 234
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 2.8291e-01, PNorm = 59.4444, GNorm = 0.5995, lr_0 = 2.3378e-04
Loss = 2.3245e-01, PNorm = 59.4707, GNorm = 0.3107, lr_0 = 3.5541e-04
Loss = 1.5342e-01, PNorm = 59.4999, GNorm = 0.4231, lr_0 = 4.7703e-04
Validation auc = 0.663677
Epoch 1
Loss = 2.8535e-01, PNorm = 59.5462, GNorm = 0.8209, lr_0 = 6.1081e-04
Loss = 2.1937e-01, PNorm = 59.5925, GNorm = 0.4126, lr_0 = 7.3243e-04
Loss = 1.4429e-01, PNorm = 59.6543, GNorm = 0.2557, lr_0 = 8.5405e-04
Loss = 2.2301e-01, PNorm = 59.7157, GNorm = 0.6187, lr_0 = 9.7568e-04
Validation auc = 0.873543
Epoch 2
Loss = 1.3521e-01, PNorm = 59.7905, GNorm = 0.2668, lr_0 = 9.8020e-04
Loss = 1.7483e-01, PNorm = 59.8618, GNorm = 0.2895, lr_0 = 9.5865e-04
Loss = 2.0183e-01, PNorm = 59.9384, GNorm = 0.4635, lr_0 = 9.3758e-04
Loss = 1.5536e-01, PNorm = 60.0256, GNorm = 0.2955, lr_0 = 9.1697e-04
Validation auc = 0.908072
Epoch 3
Loss = 1.8939e-01, PNorm = 60.1094, GNorm = 0.2297, lr_0 = 8.9681e-04
Loss = 1.4616e-01, PNorm = 60.1990, GNorm = 0.4935, lr_0 = 8.7710e-04
Loss = 1.5993e-01, PNorm = 60.2745, GNorm = 0.2681, lr_0 = 8.5782e-04
Validation auc = 0.920628
Epoch 4
Loss = 2.4314e-01, PNorm = 60.3451, GNorm = 0.4366, lr_0 = 8.3710e-04
Loss = 1.5903e-01, PNorm = 60.4192, GNorm = 0.7532, lr_0 = 8.1870e-04
Loss = 1.8392e-01, PNorm = 60.4933, GNorm = 0.4393, lr_0 = 8.0071e-04
Loss = 1.3105e-01, PNorm = 60.5786, GNorm = 0.1673, lr_0 = 7.8311e-04
Validation auc = 0.943946
Epoch 5
Loss = 1.3870e-01, PNorm = 60.6331, GNorm = 0.4499, lr_0 = 7.6420e-04
Loss = 1.5790e-01, PNorm = 60.6940, GNorm = 0.2557, lr_0 = 7.4740e-04
Loss = 1.3835e-01, PNorm = 60.7694, GNorm = 0.3160, lr_0 = 7.3097e-04
Loss = 1.2112e-01, PNorm = 60.8358, GNorm = 1.4636, lr_0 = 7.1490e-04
Validation auc = 0.881614
Epoch 6
Loss = 1.3459e-01, PNorm = 60.8948, GNorm = 0.3198, lr_0 = 6.9919e-04
Loss = 1.7005e-01, PNorm = 60.9588, GNorm = 0.5918, lr_0 = 6.8382e-04
Loss = 1.5138e-01, PNorm = 61.0169, GNorm = 0.2957, lr_0 = 6.6879e-04
Loss = 1.2406e-01, PNorm = 61.0900, GNorm = 0.9173, lr_0 = 6.5409e-04
Validation auc = 0.916592
Epoch 7
Loss = 1.3144e-01, PNorm = 61.1619, GNorm = 0.2638, lr_0 = 6.3829e-04
Loss = 9.6882e-02, PNorm = 61.2225, GNorm = 0.4478, lr_0 = 6.2426e-04
Loss = 1.5546e-01, PNorm = 61.2759, GNorm = 0.4343, lr_0 = 6.1054e-04
Validation auc = 0.912108
Epoch 8
Loss = 1.3735e-01, PNorm = 61.3411, GNorm = 0.5886, lr_0 = 5.9579e-04
Loss = 1.0701e-01, PNorm = 61.4085, GNorm = 0.4182, lr_0 = 5.8270e-04
Loss = 9.8691e-02, PNorm = 61.4700, GNorm = 0.9569, lr_0 = 5.6989e-04
Loss = 1.7267e-01, PNorm = 61.5138, GNorm = 0.3288, lr_0 = 5.5736e-04
Validation auc = 0.920179
Epoch 9
Loss = 1.6471e-01, PNorm = 61.5756, GNorm = 0.5976, lr_0 = 5.4511e-04
Loss = 1.1969e-01, PNorm = 61.6198, GNorm = 0.4924, lr_0 = 5.3313e-04
Loss = 1.4360e-01, PNorm = 61.6807, GNorm = 0.3895, lr_0 = 5.2141e-04
Loss = 9.9506e-02, PNorm = 61.7643, GNorm = 0.2517, lr_0 = 5.0995e-04
Validation auc = 0.924215
Epoch 10
Loss = 1.0389e-01, PNorm = 61.8099, GNorm = 0.5630, lr_0 = 4.9764e-04
Loss = 1.3962e-01, PNorm = 61.8616, GNorm = 0.3562, lr_0 = 4.8670e-04
Loss = 1.3653e-01, PNorm = 61.9038, GNorm = 0.2218, lr_0 = 4.7600e-04
Loss = 9.7088e-02, PNorm = 61.9588, GNorm = 0.2899, lr_0 = 4.6554e-04
Loss = 3.0077e-02, PNorm = 61.9645, GNorm = 0.4208, lr_0 = 4.6450e-04
Validation auc = 0.938117
Epoch 11
Loss = 9.0188e-02, PNorm = 62.0210, GNorm = 0.1989, lr_0 = 4.5429e-04
Loss = 1.1181e-01, PNorm = 62.0654, GNorm = 0.4415, lr_0 = 4.4431e-04
Loss = 1.0973e-01, PNorm = 62.1138, GNorm = 0.5617, lr_0 = 4.3454e-04
Validation auc = 0.934081
Epoch 12
Loss = 1.0777e-01, PNorm = 62.1771, GNorm = 0.3405, lr_0 = 4.2499e-04
Loss = 9.6737e-02, PNorm = 62.2268, GNorm = 0.4350, lr_0 = 4.1565e-04
Loss = 1.0055e-01, PNorm = 62.2876, GNorm = 0.1496, lr_0 = 4.0651e-04
Loss = 1.2821e-01, PNorm = 62.3147, GNorm = 0.4161, lr_0 = 3.9758e-04
Validation auc = 0.940807
Epoch 13
Loss = 9.1175e-02, PNorm = 62.3794, GNorm = 0.4864, lr_0 = 3.8797e-04
Loss = 9.4090e-02, PNorm = 62.4343, GNorm = 0.3132, lr_0 = 3.7945e-04
Loss = 1.0048e-01, PNorm = 62.4809, GNorm = 0.8918, lr_0 = 3.7111e-04
Loss = 1.1156e-01, PNorm = 62.5114, GNorm = 0.4664, lr_0 = 3.6295e-04
Validation auc = 0.944843
Epoch 14
Loss = 9.0397e-02, PNorm = 62.5727, GNorm = 0.2600, lr_0 = 3.5497e-04
Loss = 9.2378e-02, PNorm = 62.6246, GNorm = 0.5304, lr_0 = 3.4717e-04
Loss = 9.1583e-02, PNorm = 62.6659, GNorm = 0.5844, lr_0 = 3.3954e-04
Loss = 1.0387e-01, PNorm = 62.6924, GNorm = 0.4313, lr_0 = 3.3207e-04
Loss = 4.0781e-02, PNorm = 62.6970, GNorm = 0.5984, lr_0 = 3.3134e-04
Validation auc = 0.940807
Epoch 15
Loss = 1.0718e-01, PNorm = 62.7459, GNorm = 0.5564, lr_0 = 3.2405e-04
Loss = 6.1070e-02, PNorm = 62.7952, GNorm = 0.4427, lr_0 = 3.1693e-04
Loss = 8.0326e-02, PNorm = 62.8212, GNorm = 0.6852, lr_0 = 3.0997e-04
Validation auc = 0.934081
Epoch 16
Loss = 9.3103e-02, PNorm = 62.8507, GNorm = 0.4587, lr_0 = 3.0248e-04
Loss = 1.0587e-01, PNorm = 62.8940, GNorm = 0.9416, lr_0 = 2.9583e-04
Loss = 9.2374e-02, PNorm = 62.9339, GNorm = 0.2150, lr_0 = 2.8933e-04
Loss = 8.4160e-02, PNorm = 62.9673, GNorm = 0.3348, lr_0 = 2.8297e-04
Validation auc = 0.926009
Epoch 17
Loss = 1.2197e-01, PNorm = 63.0000, GNorm = 0.3664, lr_0 = 2.7675e-04
Loss = 7.2203e-02, PNorm = 63.0415, GNorm = 0.5306, lr_0 = 2.7067e-04
Loss = 6.9445e-02, PNorm = 63.0816, GNorm = 0.3392, lr_0 = 2.6472e-04
Loss = 9.2396e-02, PNorm = 63.1154, GNorm = 0.0660, lr_0 = 2.5890e-04
Validation auc = 0.914798
Epoch 18
Loss = 1.0513e-01, PNorm = 63.1235, GNorm = 0.3043, lr_0 = 2.5264e-04
Loss = 9.3762e-02, PNorm = 63.1584, GNorm = 0.3554, lr_0 = 2.4709e-04
Loss = 5.2698e-02, PNorm = 63.1907, GNorm = 0.2622, lr_0 = 2.4166e-04
Validation auc = 0.934081
Epoch 19
Loss = 9.7690e-02, PNorm = 63.2168, GNorm = 0.4377, lr_0 = 2.3582e-04
Loss = 6.7884e-02, PNorm = 63.2447, GNorm = 0.3606, lr_0 = 2.3064e-04
Loss = 6.4551e-02, PNorm = 63.2768, GNorm = 0.3854, lr_0 = 2.2557e-04
Loss = 7.3788e-02, PNorm = 63.2986, GNorm = 0.7768, lr_0 = 2.2061e-04
Validation auc = 0.936771
Epoch 20
Loss = 7.6110e-02, PNorm = 63.3272, GNorm = 0.7242, lr_0 = 2.1576e-04
Loss = 8.2179e-02, PNorm = 63.3497, GNorm = 0.6365, lr_0 = 2.1102e-04
Loss = 7.0018e-02, PNorm = 63.3846, GNorm = 0.4240, lr_0 = 2.0638e-04
Loss = 5.0254e-02, PNorm = 63.4108, GNorm = 0.5406, lr_0 = 2.0185e-04
Validation auc = 0.940807
Epoch 21
Loss = 4.8516e-02, PNorm = 63.4280, GNorm = 0.2729, lr_0 = 1.9697e-04
Loss = 7.2119e-02, PNorm = 63.4553, GNorm = 0.1107, lr_0 = 1.9264e-04
Loss = 5.4557e-02, PNorm = 63.4764, GNorm = 0.8029, lr_0 = 1.8841e-04
Loss = 8.0527e-02, PNorm = 63.5064, GNorm = 0.4460, lr_0 = 1.8427e-04
Validation auc = 0.947085
Epoch 22
Loss = 4.1084e-02, PNorm = 63.5256, GNorm = 0.5673, lr_0 = 1.7982e-04
Loss = 8.5409e-02, PNorm = 63.5396, GNorm = 0.4898, lr_0 = 1.7586e-04
Loss = 8.0065e-02, PNorm = 63.5664, GNorm = 0.6303, lr_0 = 1.7200e-04
Validation auc = 0.936323
Epoch 23
Loss = 3.1527e-02, PNorm = 63.5885, GNorm = 0.3761, lr_0 = 1.6822e-04
Loss = 6.5384e-02, PNorm = 63.6046, GNorm = 0.6471, lr_0 = 1.6452e-04
Loss = 5.2723e-02, PNorm = 63.6272, GNorm = 0.3272, lr_0 = 1.6090e-04
Loss = 6.9474e-02, PNorm = 63.6455, GNorm = 0.4878, lr_0 = 1.5737e-04
Validation auc = 0.940807
Epoch 24
Loss = 4.8480e-02, PNorm = 63.6664, GNorm = 0.6965, lr_0 = 1.5357e-04
Loss = 7.8721e-02, PNorm = 63.6754, GNorm = 0.7965, lr_0 = 1.5019e-04
Loss = 7.1122e-02, PNorm = 63.7039, GNorm = 0.4734, lr_0 = 1.4689e-04
Loss = 3.9387e-02, PNorm = 63.7229, GNorm = 0.3111, lr_0 = 1.4366e-04
Validation auc = 0.950224
Epoch 25
Loss = 5.2688e-02, PNorm = 63.7310, GNorm = 0.6853, lr_0 = 1.4050e-04
Loss = 3.6928e-02, PNorm = 63.7382, GNorm = 0.2063, lr_0 = 1.3741e-04
Loss = 5.7762e-02, PNorm = 63.7468, GNorm = 0.5972, lr_0 = 1.3439e-04
Loss = 7.0778e-02, PNorm = 63.7618, GNorm = 0.6598, lr_0 = 1.3144e-04
Validation auc = 0.937668
Epoch 26
Loss = 4.9110e-02, PNorm = 63.7837, GNorm = 0.6601, lr_0 = 1.2826e-04
Loss = 6.3416e-02, PNorm = 63.7973, GNorm = 0.6806, lr_0 = 1.2545e-04
Loss = 5.0752e-02, PNorm = 63.8129, GNorm = 0.4947, lr_0 = 1.2269e-04
Validation auc = 0.945740
Epoch 27
Loss = 6.5043e-02, PNorm = 63.8252, GNorm = 0.5757, lr_0 = 1.1973e-04
Loss = 4.7446e-02, PNorm = 63.8407, GNorm = 0.7176, lr_0 = 1.1709e-04
Loss = 3.9337e-02, PNorm = 63.8470, GNorm = 0.1947, lr_0 = 1.1452e-04
Loss = 5.4739e-02, PNorm = 63.8586, GNorm = 0.4094, lr_0 = 1.1200e-04
Validation auc = 0.944843
Epoch 28
Loss = 2.9532e-02, PNorm = 63.8737, GNorm = 0.2510, lr_0 = 1.0954e-04
Loss = 4.3806e-02, PNorm = 63.8823, GNorm = 0.7503, lr_0 = 1.0713e-04
Loss = 2.9740e-02, PNorm = 63.8912, GNorm = 0.1385, lr_0 = 1.0478e-04
Loss = 5.6466e-02, PNorm = 63.9035, GNorm = 0.4252, lr_0 = 1.0247e-04
Validation auc = 0.916592
Epoch 29
Loss = 4.6767e-02, PNorm = 63.9127, GNorm = 0.8241, lr_0 = 1.0000e-04
Loss = 3.1158e-02, PNorm = 63.9212, GNorm = 0.3350, lr_0 = 1.0000e-04
Loss = 5.4566e-02, PNorm = 63.9295, GNorm = 0.3564, lr_0 = 1.0000e-04
Loss = 5.6547e-02, PNorm = 63.9454, GNorm = 0.3479, lr_0 = 1.0000e-04
Loss = 3.2187e-02, PNorm = 63.9468, GNorm = 0.8243, lr_0 = 1.0000e-04
Validation auc = 0.924215
Model 0 best validation auc = 0.950224 on epoch 24
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = 0.827867
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 3.7804e-01, PNorm = 59.4705, GNorm = 0.5507, lr_0 = 2.3378e-04
Loss = 2.3134e-01, PNorm = 59.5053, GNorm = 1.0791, lr_0 = 3.5541e-04
Loss = 2.0386e-01, PNorm = 59.5394, GNorm = 0.8285, lr_0 = 4.7703e-04
Validation auc = 0.765471
Epoch 1
Loss = 1.5976e-01, PNorm = 59.5826, GNorm = 0.3737, lr_0 = 6.1081e-04
Loss = 1.9466e-01, PNorm = 59.6094, GNorm = 0.3974, lr_0 = 7.3243e-04
Loss = 1.9161e-01, PNorm = 59.6470, GNorm = 0.2639, lr_0 = 8.5405e-04
Loss = 1.7258e-01, PNorm = 59.6829, GNorm = 0.2878, lr_0 = 9.7568e-04
Validation auc = 0.925561
Epoch 2
Loss = 2.2637e-01, PNorm = 59.7486, GNorm = 0.3489, lr_0 = 9.8020e-04
Loss = 1.4430e-01, PNorm = 59.8181, GNorm = 0.2601, lr_0 = 9.5865e-04
Loss = 1.7567e-01, PNorm = 59.8876, GNorm = 0.5740, lr_0 = 9.3758e-04
Loss = 1.8527e-01, PNorm = 59.9454, GNorm = 0.5117, lr_0 = 9.1697e-04
Validation auc = 0.852915
Epoch 3
Loss = 1.3501e-01, PNorm = 60.0201, GNorm = 0.5359, lr_0 = 8.9681e-04
Loss = 2.0399e-01, PNorm = 60.0864, GNorm = 0.2534, lr_0 = 8.7710e-04
Loss = 1.9109e-01, PNorm = 60.1376, GNorm = 0.2577, lr_0 = 8.5782e-04
Validation auc = 0.907623
Epoch 4
Loss = 1.3157e-01, PNorm = 60.2093, GNorm = 0.2378, lr_0 = 8.3710e-04
Loss = 1.3545e-01, PNorm = 60.2643, GNorm = 1.4785, lr_0 = 8.1870e-04
Loss = 1.6523e-01, PNorm = 60.3343, GNorm = 1.0233, lr_0 = 8.0071e-04
Loss = 1.8264e-01, PNorm = 60.3915, GNorm = 0.2802, lr_0 = 7.8311e-04
Validation auc = 0.920628
Epoch 5
Loss = 1.5837e-01, PNorm = 60.4529, GNorm = 0.4888, lr_0 = 7.6420e-04
Loss = 1.4627e-01, PNorm = 60.5235, GNorm = 0.2463, lr_0 = 7.4740e-04
Loss = 1.5851e-01, PNorm = 60.5953, GNorm = 0.3940, lr_0 = 7.3097e-04
Loss = 1.6156e-01, PNorm = 60.6576, GNorm = 0.3764, lr_0 = 7.1490e-04
Validation auc = 0.908520
Epoch 6
Loss = 1.0985e-01, PNorm = 60.7153, GNorm = 0.4598, lr_0 = 6.9919e-04
Loss = 1.5439e-01, PNorm = 60.7810, GNorm = 0.4064, lr_0 = 6.8382e-04
Loss = 1.7736e-01, PNorm = 60.8290, GNorm = 0.3585, lr_0 = 6.6879e-04
Loss = 1.4751e-01, PNorm = 60.9018, GNorm = 0.2331, lr_0 = 6.5409e-04
Validation auc = 0.916143
Epoch 7
Loss = 1.1943e-01, PNorm = 60.9690, GNorm = 0.3945, lr_0 = 6.3829e-04
Loss = 1.3366e-01, PNorm = 61.0266, GNorm = 0.2409, lr_0 = 6.2426e-04
Loss = 1.1531e-01, PNorm = 61.0867, GNorm = 0.1955, lr_0 = 6.1054e-04
Validation auc = 0.926457
Epoch 8
Loss = 7.2200e-02, PNorm = 61.1593, GNorm = 0.2928, lr_0 = 5.9579e-04
Loss = 1.0061e-01, PNorm = 61.2167, GNorm = 0.2625, lr_0 = 5.8270e-04
Loss = 1.4613e-01, PNorm = 61.2723, GNorm = 0.5418, lr_0 = 5.6989e-04
Loss = 1.5279e-01, PNorm = 61.3254, GNorm = 0.2328, lr_0 = 5.5736e-04
Validation auc = 0.920179
Epoch 9
Loss = 1.1367e-01, PNorm = 61.3923, GNorm = 0.2588, lr_0 = 5.4511e-04
Loss = 1.2037e-01, PNorm = 61.4608, GNorm = 0.7988, lr_0 = 5.3313e-04
Loss = 1.3474e-01, PNorm = 61.5149, GNorm = 0.3293, lr_0 = 5.2141e-04
Loss = 1.3666e-01, PNorm = 61.5760, GNorm = 0.6487, lr_0 = 5.0995e-04
Validation auc = 0.925561
Epoch 10
Loss = 8.4010e-02, PNorm = 61.6340, GNorm = 0.1675, lr_0 = 4.9764e-04
Loss = 1.3017e-01, PNorm = 61.6766, GNorm = 0.2935, lr_0 = 4.8670e-04
Loss = 1.0216e-01, PNorm = 61.7302, GNorm = 0.3595, lr_0 = 4.7600e-04
Loss = 1.4326e-01, PNorm = 61.7742, GNorm = 0.3310, lr_0 = 4.6554e-04
Loss = 2.6729e-01, PNorm = 61.7769, GNorm = 0.7949, lr_0 = 4.6450e-04
Validation auc = 0.933632
Epoch 11
Loss = 1.1847e-01, PNorm = 61.8393, GNorm = 0.3300, lr_0 = 4.5429e-04
Loss = 1.0411e-01, PNorm = 61.8915, GNorm = 0.3347, lr_0 = 4.4431e-04
Loss = 1.4306e-01, PNorm = 61.9460, GNorm = 0.3777, lr_0 = 4.3454e-04
Validation auc = 0.926906
Epoch 12
Loss = 1.1100e-01, PNorm = 61.9958, GNorm = 0.2053, lr_0 = 4.2499e-04
Loss = 1.1146e-01, PNorm = 62.0378, GNorm = 0.4297, lr_0 = 4.1565e-04
Loss = 1.0191e-01, PNorm = 62.0886, GNorm = 0.2413, lr_0 = 4.0651e-04
Loss = 1.3523e-01, PNorm = 62.1329, GNorm = 0.6113, lr_0 = 3.9758e-04
Validation auc = 0.920179
Epoch 13
Loss = 7.5390e-02, PNorm = 62.1822, GNorm = 0.3448, lr_0 = 3.8797e-04
Loss = 1.0353e-01, PNorm = 62.2254, GNorm = 0.6374, lr_0 = 3.7945e-04
Loss = 1.0682e-01, PNorm = 62.2775, GNorm = 0.6268, lr_0 = 3.7111e-04
Loss = 1.1590e-01, PNorm = 62.3169, GNorm = 0.4681, lr_0 = 3.6295e-04
Validation auc = 0.932735
Epoch 14
Loss = 9.6612e-02, PNorm = 62.3687, GNorm = 0.5177, lr_0 = 3.5497e-04
Loss = 1.0379e-01, PNorm = 62.4009, GNorm = 0.6573, lr_0 = 3.4717e-04
Loss = 1.1101e-01, PNorm = 62.4411, GNorm = 0.3003, lr_0 = 3.3954e-04
Loss = 1.0373e-01, PNorm = 62.4823, GNorm = 0.2184, lr_0 = 3.3207e-04
Loss = 1.0427e-02, PNorm = 62.4869, GNorm = 0.1595, lr_0 = 3.3134e-04
Validation auc = 0.923318
Epoch 15
Loss = 8.8368e-02, PNorm = 62.5213, GNorm = 0.3899, lr_0 = 3.2405e-04
Loss = 9.3503e-02, PNorm = 62.5595, GNorm = 0.3287, lr_0 = 3.1693e-04
Loss = 1.0257e-01, PNorm = 62.5907, GNorm = 0.1528, lr_0 = 3.0997e-04
Validation auc = 0.921076
Epoch 16
Loss = 5.2989e-02, PNorm = 62.6275, GNorm = 0.3306, lr_0 = 3.0248e-04
Loss = 1.2079e-01, PNorm = 62.6674, GNorm = 0.8871, lr_0 = 2.9583e-04
Loss = 6.7417e-02, PNorm = 62.7213, GNorm = 0.1163, lr_0 = 2.8933e-04
Loss = 1.0929e-01, PNorm = 62.7428, GNorm = 0.9655, lr_0 = 2.8297e-04
Validation auc = 0.924215
Epoch 17
Loss = 5.9919e-02, PNorm = 62.7814, GNorm = 0.2215, lr_0 = 2.7675e-04
Loss = 1.0029e-01, PNorm = 62.8223, GNorm = 0.3618, lr_0 = 2.7067e-04
Loss = 1.2166e-01, PNorm = 62.8640, GNorm = 1.4030, lr_0 = 2.6472e-04
Loss = 8.1642e-02, PNorm = 62.8984, GNorm = 0.2602, lr_0 = 2.5890e-04
Validation auc = 0.922870
Epoch 18
Loss = 1.0478e-01, PNorm = 62.9392, GNorm = 0.6047, lr_0 = 2.5264e-04
Loss = 9.9756e-02, PNorm = 62.9746, GNorm = 0.2920, lr_0 = 2.4709e-04
Loss = 1.0690e-01, PNorm = 62.9983, GNorm = 0.6775, lr_0 = 2.4166e-04
Validation auc = 0.917040
Epoch 19
Loss = 1.5703e-01, PNorm = 63.0423, GNorm = 0.4907, lr_0 = 2.3582e-04
Loss = 8.1994e-02, PNorm = 63.0632, GNorm = 0.2729, lr_0 = 2.3064e-04
Loss = 1.1325e-01, PNorm = 63.0816, GNorm = 0.6483, lr_0 = 2.2557e-04
Loss = 6.3974e-02, PNorm = 63.1244, GNorm = 0.1770, lr_0 = 2.2061e-04
Validation auc = 0.908969
Epoch 20
Loss = 5.7095e-02, PNorm = 63.1559, GNorm = 0.2880, lr_0 = 2.1576e-04
Loss = 9.4168e-02, PNorm = 63.1665, GNorm = 0.6293, lr_0 = 2.1102e-04
Loss = 7.8497e-02, PNorm = 63.1935, GNorm = 0.3683, lr_0 = 2.0638e-04
Loss = 8.6143e-02, PNorm = 63.2138, GNorm = 0.3643, lr_0 = 2.0185e-04
Validation auc = 0.918386
Epoch 21
Loss = 8.7663e-02, PNorm = 63.2400, GNorm = 0.5524, lr_0 = 1.9697e-04
Loss = 6.6490e-02, PNorm = 63.2664, GNorm = 0.6296, lr_0 = 1.9264e-04
Loss = 6.8876e-02, PNorm = 63.2883, GNorm = 0.6561, lr_0 = 1.8841e-04
Loss = 7.1807e-02, PNorm = 63.3142, GNorm = 0.2760, lr_0 = 1.8427e-04
Validation auc = 0.911659
Epoch 22
Loss = 6.4218e-02, PNorm = 63.3370, GNorm = 0.7846, lr_0 = 1.7982e-04
Loss = 7.5880e-02, PNorm = 63.3616, GNorm = 0.7590, lr_0 = 1.7586e-04
Loss = 7.0059e-02, PNorm = 63.3873, GNorm = 0.7998, lr_0 = 1.7200e-04
Validation auc = 0.917937
Epoch 23
Loss = 2.9683e-02, PNorm = 63.4027, GNorm = 0.2679, lr_0 = 1.6822e-04
Loss = 4.6664e-02, PNorm = 63.4205, GNorm = 0.3406, lr_0 = 1.6452e-04
Loss = 9.2115e-02, PNorm = 63.4330, GNorm = 0.7503, lr_0 = 1.6090e-04
Loss = 5.8868e-02, PNorm = 63.4605, GNorm = 0.7304, lr_0 = 1.5737e-04
Validation auc = 0.918386
Epoch 24
Loss = 4.9123e-02, PNorm = 63.4738, GNorm = 0.4975, lr_0 = 1.5357e-04
Loss = 6.2463e-02, PNorm = 63.5037, GNorm = 0.4906, lr_0 = 1.5019e-04
Loss = 6.8009e-02, PNorm = 63.5140, GNorm = 0.6254, lr_0 = 1.4689e-04
Loss = 8.8963e-02, PNorm = 63.5374, GNorm = 0.4722, lr_0 = 1.4366e-04
Validation auc = 0.901345
Epoch 25
Loss = 3.7366e-02, PNorm = 63.5619, GNorm = 0.3267, lr_0 = 1.4050e-04
Loss = 7.6895e-02, PNorm = 63.5761, GNorm = 0.4341, lr_0 = 1.3741e-04
Loss = 5.1877e-02, PNorm = 63.5911, GNorm = 0.4056, lr_0 = 1.3439e-04
Loss = 6.4018e-02, PNorm = 63.6081, GNorm = 0.5240, lr_0 = 1.3144e-04
Validation auc = 0.907175
Epoch 26
Loss = 6.2505e-02, PNorm = 63.6276, GNorm = 0.9955, lr_0 = 1.2826e-04
Loss = 6.3737e-02, PNorm = 63.6465, GNorm = 1.2068, lr_0 = 1.2545e-04
Loss = 5.4107e-02, PNorm = 63.6533, GNorm = 0.4140, lr_0 = 1.2269e-04
Validation auc = 0.905381
Epoch 27
Loss = 8.3363e-02, PNorm = 63.6654, GNorm = 0.8411, lr_0 = 1.1973e-04
Loss = 4.4336e-02, PNorm = 63.6753, GNorm = 0.1821, lr_0 = 1.1709e-04
Loss = 4.8218e-02, PNorm = 63.6901, GNorm = 0.4053, lr_0 = 1.1452e-04
Loss = 7.0601e-02, PNorm = 63.6986, GNorm = 0.6133, lr_0 = 1.1200e-04
Validation auc = 0.907623
Epoch 28
Loss = 4.3478e-02, PNorm = 63.7154, GNorm = 0.6067, lr_0 = 1.0954e-04
Loss = 5.7681e-02, PNorm = 63.7295, GNorm = 0.8652, lr_0 = 1.0713e-04
Loss = 6.7803e-02, PNorm = 63.7396, GNorm = 0.6072, lr_0 = 1.0478e-04
Loss = 5.7812e-02, PNorm = 63.7499, GNorm = 1.2891, lr_0 = 1.0247e-04
Validation auc = 0.906726
Epoch 29
Loss = 4.9117e-02, PNorm = 63.7652, GNorm = 0.7462, lr_0 = 1.0000e-04
Loss = 6.0582e-02, PNorm = 63.7695, GNorm = 0.9296, lr_0 = 1.0000e-04
Loss = 5.0079e-02, PNorm = 63.7848, GNorm = 0.1745, lr_0 = 1.0000e-04
Loss = 4.7938e-02, PNorm = 63.7968, GNorm = 1.1546, lr_0 = 1.0000e-04
Loss = 6.4524e-03, PNorm = 63.7974, GNorm = 0.1495, lr_0 = 1.0000e-04
Validation auc = 0.911211
Model 1 best validation auc = 0.933632 on epoch 10
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 1 test auc = 0.666576
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 3.1165e-01, PNorm = 59.4782, GNorm = 0.9573, lr_0 = 2.3378e-04
Loss = 2.3192e-01, PNorm = 59.5084, GNorm = 0.2501, lr_0 = 3.5541e-04
Loss = 1.7531e-01, PNorm = 59.5387, GNorm = 0.4245, lr_0 = 4.7703e-04
Validation auc = 0.822422
Epoch 1
Loss = 2.4751e-01, PNorm = 59.5776, GNorm = 0.7808, lr_0 = 6.1081e-04
Loss = 1.8226e-01, PNorm = 59.6184, GNorm = 0.2682, lr_0 = 7.3243e-04
Loss = 1.7303e-01, PNorm = 59.6599, GNorm = 0.4857, lr_0 = 8.5405e-04
Loss = 2.1779e-01, PNorm = 59.7063, GNorm = 0.3498, lr_0 = 9.7568e-04
Validation auc = 0.745291
Epoch 2
Loss = 2.0061e-01, PNorm = 59.7806, GNorm = 0.3355, lr_0 = 9.8020e-04
Loss = 1.8575e-01, PNorm = 59.8636, GNorm = 0.5041, lr_0 = 9.5865e-04
Loss = 1.5665e-01, PNorm = 59.9517, GNorm = 0.6174, lr_0 = 9.3758e-04
Loss = 2.0072e-01, PNorm = 60.0193, GNorm = 0.2262, lr_0 = 9.1697e-04
Validation auc = 0.905381
Epoch 3
Loss = 1.8694e-01, PNorm = 60.0844, GNorm = 0.3157, lr_0 = 8.9681e-04
Loss = 1.9504e-01, PNorm = 60.1622, GNorm = 0.3392, lr_0 = 8.7710e-04
Loss = 1.3634e-01, PNorm = 60.2461, GNorm = 0.3681, lr_0 = 8.5782e-04
Validation auc = 0.861883
Epoch 4
Loss = 2.8496e-02, PNorm = 60.3198, GNorm = 0.2826, lr_0 = 8.3710e-04
Loss = 1.8239e-01, PNorm = 60.3966, GNorm = 0.3580, lr_0 = 8.1870e-04
Loss = 1.5778e-01, PNorm = 60.4712, GNorm = 0.3669, lr_0 = 8.0071e-04
Loss = 1.4041e-01, PNorm = 60.5648, GNorm = 0.3774, lr_0 = 7.8311e-04
Validation auc = 0.912556
Epoch 5
Loss = 1.6848e-01, PNorm = 60.6510, GNorm = 0.3394, lr_0 = 7.6420e-04
Loss = 1.7658e-01, PNorm = 60.7362, GNorm = 0.9263, lr_0 = 7.4740e-04
Loss = 1.1409e-01, PNorm = 60.8266, GNorm = 0.2184, lr_0 = 7.3097e-04
Loss = 1.3929e-01, PNorm = 60.9109, GNorm = 0.2088, lr_0 = 7.1490e-04
Validation auc = 0.895516
Epoch 6
Loss = 1.4681e-01, PNorm = 60.9860, GNorm = 0.5632, lr_0 = 6.9919e-04
Loss = 1.6784e-01, PNorm = 61.0684, GNorm = 0.3802, lr_0 = 6.8382e-04
Loss = 1.3268e-01, PNorm = 61.1560, GNorm = 0.2732, lr_0 = 6.6879e-04
Loss = 1.1476e-01, PNorm = 61.2430, GNorm = 0.2054, lr_0 = 6.5409e-04
Validation auc = 0.914350
Epoch 7
Loss = 1.4359e-01, PNorm = 61.3046, GNorm = 0.2552, lr_0 = 6.3829e-04
Loss = 1.3781e-01, PNorm = 61.3917, GNorm = 0.5605, lr_0 = 6.2426e-04
Loss = 1.6074e-01, PNorm = 61.4456, GNorm = 0.2382, lr_0 = 6.1054e-04
Validation auc = 0.903139
Epoch 8
Loss = 1.0968e-01, PNorm = 61.5304, GNorm = 0.4949, lr_0 = 5.9579e-04
Loss = 1.4214e-01, PNorm = 61.6063, GNorm = 0.3096, lr_0 = 5.8270e-04
Loss = 1.4433e-01, PNorm = 61.6736, GNorm = 0.2056, lr_0 = 5.6989e-04
Loss = 1.6736e-01, PNorm = 61.7404, GNorm = 0.4102, lr_0 = 5.5736e-04
Validation auc = 0.928251
Epoch 9
Loss = 1.3548e-01, PNorm = 61.8240, GNorm = 0.6936, lr_0 = 5.4511e-04
Loss = 1.6709e-01, PNorm = 61.8955, GNorm = 0.2543, lr_0 = 5.3313e-04
Loss = 1.0319e-01, PNorm = 61.9668, GNorm = 0.2838, lr_0 = 5.2141e-04
Loss = 1.0737e-01, PNorm = 62.0275, GNorm = 0.1791, lr_0 = 5.0995e-04
Validation auc = 0.930942
Epoch 10
Loss = 1.1377e-01, PNorm = 62.0996, GNorm = 0.6675, lr_0 = 4.9764e-04
Loss = 1.2783e-01, PNorm = 62.1430, GNorm = 0.3701, lr_0 = 4.8670e-04
Loss = 1.2249e-01, PNorm = 62.2094, GNorm = 0.2678, lr_0 = 4.7600e-04
Loss = 1.1525e-01, PNorm = 62.2695, GNorm = 0.8080, lr_0 = 4.6554e-04
Loss = 5.1545e-02, PNorm = 62.2720, GNorm = 0.5236, lr_0 = 4.6450e-04
Validation auc = 0.928251
Epoch 11
Loss = 1.0891e-01, PNorm = 62.3277, GNorm = 0.4070, lr_0 = 4.5429e-04
Loss = 1.4973e-01, PNorm = 62.3788, GNorm = 0.4173, lr_0 = 4.4431e-04
Loss = 1.0667e-01, PNorm = 62.4373, GNorm = 0.3453, lr_0 = 4.3454e-04
Validation auc = 0.942601
Epoch 12
Loss = 6.2772e-02, PNorm = 62.4841, GNorm = 0.3560, lr_0 = 4.2499e-04
Loss = 1.1286e-01, PNorm = 62.5332, GNorm = 0.3424, lr_0 = 4.1565e-04
Loss = 9.4916e-02, PNorm = 62.5755, GNorm = 0.4634, lr_0 = 4.0651e-04
Loss = 1.4205e-01, PNorm = 62.6385, GNorm = 0.6723, lr_0 = 3.9758e-04
Validation auc = 0.934978
Epoch 13
Loss = 4.1897e-02, PNorm = 62.7058, GNorm = 0.2062, lr_0 = 3.8797e-04
Loss = 1.2622e-01, PNorm = 62.7463, GNorm = 0.2776, lr_0 = 3.7945e-04
Loss = 1.3299e-01, PNorm = 62.7932, GNorm = 0.5730, lr_0 = 3.7111e-04
Loss = 7.4633e-02, PNorm = 62.8519, GNorm = 0.2776, lr_0 = 3.6295e-04
Validation auc = 0.934081
Epoch 14
Loss = 9.9685e-02, PNorm = 62.8900, GNorm = 0.4815, lr_0 = 3.5497e-04
Loss = 8.8517e-02, PNorm = 62.9373, GNorm = 0.3815, lr_0 = 3.4717e-04
Loss = 9.2925e-02, PNorm = 62.9768, GNorm = 0.4891, lr_0 = 3.3954e-04
Loss = 1.0804e-01, PNorm = 63.0233, GNorm = 0.2984, lr_0 = 3.3207e-04
Loss = 4.7614e-02, PNorm = 63.0308, GNorm = 0.5688, lr_0 = 3.3134e-04
Validation auc = 0.926906
Epoch 15
Loss = 1.0204e-01, PNorm = 63.0801, GNorm = 0.5842, lr_0 = 3.2405e-04
Loss = 8.0258e-02, PNorm = 63.1377, GNorm = 0.3683, lr_0 = 3.1693e-04
Loss = 8.4858e-02, PNorm = 63.1722, GNorm = 0.1530, lr_0 = 3.0997e-04
Validation auc = 0.927803
Epoch 16
Loss = 9.7214e-02, PNorm = 63.2072, GNorm = 0.4787, lr_0 = 3.0248e-04
Loss = 8.7782e-02, PNorm = 63.2780, GNorm = 0.5624, lr_0 = 2.9583e-04
Loss = 8.0576e-02, PNorm = 63.3249, GNorm = 0.5399, lr_0 = 2.8933e-04
Loss = 1.0628e-01, PNorm = 63.3561, GNorm = 0.5654, lr_0 = 2.8297e-04
Validation auc = 0.932287
Epoch 17
Loss = 8.6188e-02, PNorm = 63.3957, GNorm = 0.3726, lr_0 = 2.7675e-04
Loss = 8.6639e-02, PNorm = 63.4459, GNorm = 0.1839, lr_0 = 2.7067e-04
Loss = 8.3639e-02, PNorm = 63.5045, GNorm = 0.3541, lr_0 = 2.6472e-04
Loss = 8.8009e-02, PNorm = 63.5314, GNorm = 0.2275, lr_0 = 2.5890e-04
Validation auc = 0.915247
Epoch 18
Loss = 8.0929e-02, PNorm = 63.5792, GNorm = 0.7206, lr_0 = 2.5264e-04
Loss = 7.4958e-02, PNorm = 63.6126, GNorm = 0.5618, lr_0 = 2.4709e-04
Loss = 7.6112e-02, PNorm = 63.6537, GNorm = 0.3782, lr_0 = 2.4166e-04
Validation auc = 0.932735
Epoch 19
Loss = 9.7367e-02, PNorm = 63.6734, GNorm = 0.3217, lr_0 = 2.3582e-04
Loss = 7.2065e-02, PNorm = 63.7217, GNorm = 0.3090, lr_0 = 2.3064e-04
Loss = 8.1704e-02, PNorm = 63.7532, GNorm = 0.3612, lr_0 = 2.2557e-04
Loss = 6.3104e-02, PNorm = 63.7931, GNorm = 0.5126, lr_0 = 2.2061e-04
Validation auc = 0.929596
Epoch 20
Loss = 4.4757e-02, PNorm = 63.8091, GNorm = 0.2305, lr_0 = 2.1576e-04
Loss = 6.0149e-02, PNorm = 63.8457, GNorm = 0.2876, lr_0 = 2.1102e-04
Loss = 8.5130e-02, PNorm = 63.8658, GNorm = 0.3971, lr_0 = 2.0638e-04
Loss = 7.4091e-02, PNorm = 63.9078, GNorm = 0.6407, lr_0 = 2.0185e-04
Validation auc = 0.930045
Epoch 21
Loss = 6.8066e-02, PNorm = 63.9370, GNorm = 0.4003, lr_0 = 1.9697e-04
Loss = 7.5710e-02, PNorm = 63.9636, GNorm = 0.4320, lr_0 = 1.9264e-04
Loss = 6.1512e-02, PNorm = 63.9962, GNorm = 0.1672, lr_0 = 1.8841e-04
Loss = 9.5668e-02, PNorm = 64.0136, GNorm = 0.7674, lr_0 = 1.8427e-04
Validation auc = 0.916143
Epoch 22
Loss = 5.1378e-02, PNorm = 64.0607, GNorm = 0.3296, lr_0 = 1.7982e-04
Loss = 7.3444e-02, PNorm = 64.0753, GNorm = 0.4012, lr_0 = 1.7586e-04
Loss = 8.1227e-02, PNorm = 64.0948, GNorm = 0.5117, lr_0 = 1.7200e-04
Validation auc = 0.917937
Epoch 23
Loss = 2.7874e-02, PNorm = 64.1234, GNorm = 0.2416, lr_0 = 1.6822e-04
Loss = 6.7142e-02, PNorm = 64.1444, GNorm = 0.6307, lr_0 = 1.6452e-04
Loss = 3.6751e-02, PNorm = 64.1723, GNorm = 0.3368, lr_0 = 1.6090e-04
Loss = 6.4625e-02, PNorm = 64.1856, GNorm = 0.5152, lr_0 = 1.5737e-04
Validation auc = 0.925112
Epoch 24
Loss = 8.0112e-02, PNorm = 64.2131, GNorm = 0.8411, lr_0 = 1.5357e-04
Loss = 5.6586e-02, PNorm = 64.2413, GNorm = 0.5000, lr_0 = 1.5019e-04
Loss = 5.3726e-02, PNorm = 64.2621, GNorm = 0.5140, lr_0 = 1.4689e-04
Loss = 7.1719e-02, PNorm = 64.2800, GNorm = 0.1773, lr_0 = 1.4366e-04
Validation auc = 0.928700
Epoch 25
Loss = 4.5122e-02, PNorm = 64.2982, GNorm = 0.5215, lr_0 = 1.4050e-04
Loss = 6.2286e-02, PNorm = 64.3218, GNorm = 0.2554, lr_0 = 1.3741e-04
Loss = 5.5613e-02, PNorm = 64.3343, GNorm = 0.3977, lr_0 = 1.3439e-04
Loss = 6.0768e-02, PNorm = 64.3544, GNorm = 0.6233, lr_0 = 1.3144e-04
Validation auc = 0.925561
Epoch 26
Loss = 4.5093e-02, PNorm = 64.3689, GNorm = 0.1772, lr_0 = 1.2826e-04
Loss = 3.5468e-02, PNorm = 64.3808, GNorm = 0.4810, lr_0 = 1.2545e-04
Loss = 6.1856e-02, PNorm = 64.3947, GNorm = 0.6262, lr_0 = 1.2269e-04
Validation auc = 0.917040
Epoch 27
Loss = 5.3765e-02, PNorm = 64.4108, GNorm = 0.3445, lr_0 = 1.1973e-04
Loss = 4.4158e-02, PNorm = 64.4269, GNorm = 0.3765, lr_0 = 1.1709e-04
Loss = 4.8817e-02, PNorm = 64.4416, GNorm = 0.8864, lr_0 = 1.1452e-04
Loss = 5.3919e-02, PNorm = 64.4527, GNorm = 0.4445, lr_0 = 1.1200e-04
Validation auc = 0.918834
Epoch 28
Loss = 4.9704e-02, PNorm = 64.4674, GNorm = 0.3246, lr_0 = 1.0954e-04
Loss = 4.7425e-02, PNorm = 64.4812, GNorm = 0.8869, lr_0 = 1.0713e-04
Loss = 4.8566e-02, PNorm = 64.4956, GNorm = 1.4739, lr_0 = 1.0478e-04
Loss = 4.5299e-02, PNorm = 64.5061, GNorm = 0.7311, lr_0 = 1.0247e-04
Validation auc = 0.918386
Epoch 29
Loss = 5.8585e-02, PNorm = 64.5169, GNorm = 0.2650, lr_0 = 1.0000e-04
Loss = 6.0166e-02, PNorm = 64.5343, GNorm = 1.0111, lr_0 = 1.0000e-04
Loss = 2.9463e-02, PNorm = 64.5494, GNorm = 0.1528, lr_0 = 1.0000e-04
Loss = 4.7896e-02, PNorm = 64.5536, GNorm = 0.5670, lr_0 = 1.0000e-04
Loss = 1.2511e-02, PNorm = 64.5545, GNorm = 0.2528, lr_0 = 1.0000e-04
Validation auc = 0.913901
Model 2 best validation auc = 0.942601 on epoch 11
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 2 test auc = 0.740309
Ensemble test auc = 0.727568
Fold 3
Splitting data with seed 3
Class sizes
hit 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 1,868 | val size = 233 | test size = 234
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 3.0066e-01, PNorm = 59.4437, GNorm = 1.3393, lr_0 = 2.3378e-04
Loss = 2.0129e-01, PNorm = 59.4694, GNorm = 0.3849, lr_0 = 3.5541e-04
Loss = 1.9235e-01, PNorm = 59.4961, GNorm = 0.5181, lr_0 = 4.7703e-04
Validation auc = 0.720734
Epoch 1
Loss = 1.9042e-01, PNorm = 59.5371, GNorm = 0.6483, lr_0 = 6.1081e-04
Loss = 2.2017e-01, PNorm = 59.5875, GNorm = 0.5175, lr_0 = 7.3243e-04
Loss = 1.4517e-01, PNorm = 59.6473, GNorm = 0.2075, lr_0 = 8.5405e-04
Loss = 2.2838e-01, PNorm = 59.7108, GNorm = 1.3498, lr_0 = 9.7568e-04
Validation auc = 0.745040
Epoch 2
Loss = 1.9924e-01, PNorm = 59.7957, GNorm = 0.3197, lr_0 = 9.8020e-04
Loss = 1.5370e-01, PNorm = 59.8809, GNorm = 0.2326, lr_0 = 9.5865e-04
Loss = 1.9616e-01, PNorm = 59.9512, GNorm = 0.4373, lr_0 = 9.3758e-04
Loss = 2.2142e-01, PNorm = 60.0118, GNorm = 0.8511, lr_0 = 9.1697e-04
Validation auc = 0.750496
Epoch 3
Loss = 1.9396e-01, PNorm = 60.0938, GNorm = 0.2409, lr_0 = 8.9681e-04
Loss = 1.8968e-01, PNorm = 60.1436, GNorm = 0.5323, lr_0 = 8.7710e-04
Loss = 1.8280e-01, PNorm = 60.1968, GNorm = 0.2727, lr_0 = 8.5782e-04
Validation auc = 0.805556
Epoch 4
Loss = 8.7032e-02, PNorm = 60.2621, GNorm = 0.2975, lr_0 = 8.3710e-04
Loss = 1.8884e-01, PNorm = 60.3145, GNorm = 0.4592, lr_0 = 8.1870e-04
Loss = 1.3762e-01, PNorm = 60.3917, GNorm = 0.2941, lr_0 = 8.0071e-04
Loss = 1.8292e-01, PNorm = 60.4638, GNorm = 0.5022, lr_0 = 7.8311e-04
Validation auc = 0.748016
Epoch 5
Loss = 6.8258e-02, PNorm = 60.5477, GNorm = 0.1853, lr_0 = 7.6420e-04
Loss = 1.2994e-01, PNorm = 60.6146, GNorm = 0.4880, lr_0 = 7.4740e-04
Loss = 1.5412e-01, PNorm = 60.6794, GNorm = 0.2532, lr_0 = 7.3097e-04
Loss = 1.8133e-01, PNorm = 60.7593, GNorm = 0.4694, lr_0 = 7.1490e-04
Validation auc = 0.723214
Epoch 6
Loss = 1.4639e-01, PNorm = 60.8495, GNorm = 0.3137, lr_0 = 6.9919e-04
Loss = 1.4447e-01, PNorm = 60.9660, GNorm = 0.3102, lr_0 = 6.8382e-04
Loss = 1.3356e-01, PNorm = 61.0493, GNorm = 0.5065, lr_0 = 6.6879e-04
Loss = 1.8222e-01, PNorm = 61.1060, GNorm = 1.1932, lr_0 = 6.5409e-04
Validation auc = 0.765873
Epoch 7
Loss = 1.7305e-01, PNorm = 61.1729, GNorm = 0.3734, lr_0 = 6.3829e-04
Loss = 1.3213e-01, PNorm = 61.2410, GNorm = 0.2972, lr_0 = 6.2426e-04
Loss = 1.4871e-01, PNorm = 61.3145, GNorm = 0.4550, lr_0 = 6.1054e-04
Validation auc = 0.736607
Epoch 8
Loss = 1.5588e-01, PNorm = 61.3830, GNorm = 0.3954, lr_0 = 5.9579e-04
Loss = 1.2698e-01, PNorm = 61.4501, GNorm = 0.3410, lr_0 = 5.8270e-04
Loss = 1.7418e-01, PNorm = 61.5082, GNorm = 0.5597, lr_0 = 5.6989e-04
Loss = 1.2193e-01, PNorm = 61.5870, GNorm = 0.3416, lr_0 = 5.5736e-04
Validation auc = 0.751984
Epoch 9
Loss = 1.0441e-01, PNorm = 61.6621, GNorm = 0.7928, lr_0 = 5.4511e-04
Loss = 1.6922e-01, PNorm = 61.7267, GNorm = 0.2344, lr_0 = 5.3313e-04
Loss = 1.4532e-01, PNorm = 61.7936, GNorm = 0.2517, lr_0 = 5.2141e-04
Loss = 1.2878e-01, PNorm = 61.8577, GNorm = 0.2235, lr_0 = 5.0995e-04
Validation auc = 0.750000
Epoch 10
Loss = 1.0768e-01, PNorm = 61.9245, GNorm = 0.1741, lr_0 = 4.9764e-04
Loss = 1.2200e-01, PNorm = 61.9664, GNorm = 0.7960, lr_0 = 4.8670e-04
Loss = 1.4090e-01, PNorm = 62.0007, GNorm = 0.5837, lr_0 = 4.7600e-04
Loss = 1.1252e-01, PNorm = 62.0618, GNorm = 0.4035, lr_0 = 4.6554e-04
Loss = 3.2431e-02, PNorm = 62.0697, GNorm = 0.3782, lr_0 = 4.6450e-04
Validation auc = 0.749504
Epoch 11
Loss = 1.0735e-01, PNorm = 62.1199, GNorm = 0.5042, lr_0 = 4.5429e-04
Loss = 1.1748e-01, PNorm = 62.1929, GNorm = 0.6713, lr_0 = 4.4431e-04
Loss = 1.2671e-01, PNorm = 62.2265, GNorm = 0.3397, lr_0 = 4.3454e-04
Validation auc = 0.760913
Epoch 12
Loss = 1.8498e-01, PNorm = 62.2938, GNorm = 0.8287, lr_0 = 4.2499e-04
Loss = 1.0965e-01, PNorm = 62.3310, GNorm = 0.3606, lr_0 = 4.1565e-04
Loss = 1.1027e-01, PNorm = 62.3795, GNorm = 0.4606, lr_0 = 4.0651e-04
Loss = 1.0437e-01, PNorm = 62.4269, GNorm = 0.2000, lr_0 = 3.9758e-04
Validation auc = 0.796627
Epoch 13
Loss = 6.8399e-02, PNorm = 62.4830, GNorm = 0.2970, lr_0 = 3.8797e-04
Loss = 9.1857e-02, PNorm = 62.5236, GNorm = 0.2807, lr_0 = 3.7945e-04
Loss = 1.0305e-01, PNorm = 62.5713, GNorm = 0.2359, lr_0 = 3.7111e-04
Loss = 1.4637e-01, PNorm = 62.6042, GNorm = 0.4995, lr_0 = 3.6295e-04
Validation auc = 0.761905
Epoch 14
Loss = 1.2873e-01, PNorm = 62.6578, GNorm = 0.1904, lr_0 = 3.5497e-04
Loss = 1.2166e-01, PNorm = 62.6944, GNorm = 0.3224, lr_0 = 3.4717e-04
Loss = 8.6499e-02, PNorm = 62.7416, GNorm = 0.2112, lr_0 = 3.3954e-04
Loss = 8.3807e-02, PNorm = 62.7810, GNorm = 0.2859, lr_0 = 3.3207e-04
Loss = 4.6381e-02, PNorm = 62.7852, GNorm = 0.5994, lr_0 = 3.3134e-04
Validation auc = 0.808036
Epoch 15
Loss = 8.8588e-02, PNorm = 62.8254, GNorm = 0.4541, lr_0 = 3.2405e-04
Loss = 1.0553e-01, PNorm = 62.8624, GNorm = 0.4626, lr_0 = 3.1693e-04
Loss = 9.9649e-02, PNorm = 62.8933, GNorm = 0.3000, lr_0 = 3.0997e-04
Validation auc = 0.800099
Epoch 16
Loss = 1.1578e-01, PNorm = 62.9465, GNorm = 0.5981, lr_0 = 3.0248e-04
Loss = 5.7732e-02, PNorm = 62.9848, GNorm = 0.3397, lr_0 = 2.9583e-04
Loss = 9.1180e-02, PNorm = 63.0162, GNorm = 0.4887, lr_0 = 2.8933e-04
Loss = 1.2269e-01, PNorm = 63.0398, GNorm = 0.5553, lr_0 = 2.8297e-04
Validation auc = 0.756448
Epoch 17
Loss = 9.1641e-02, PNorm = 63.0723, GNorm = 0.4611, lr_0 = 2.7675e-04
Loss = 6.0855e-02, PNorm = 63.1195, GNorm = 0.5997, lr_0 = 2.7067e-04
Loss = 1.1607e-01, PNorm = 63.1438, GNorm = 0.6659, lr_0 = 2.6472e-04
Loss = 1.0079e-01, PNorm = 63.2040, GNorm = 0.1515, lr_0 = 2.5890e-04
Validation auc = 0.773810
Epoch 18
Loss = 9.5437e-02, PNorm = 63.2340, GNorm = 0.3699, lr_0 = 2.5264e-04
Loss = 1.0690e-01, PNorm = 63.2779, GNorm = 0.3261, lr_0 = 2.4709e-04
Loss = 9.3758e-02, PNorm = 63.3064, GNorm = 0.4214, lr_0 = 2.4166e-04
Validation auc = 0.787698
Epoch 19
Loss = 4.9271e-02, PNorm = 63.3345, GNorm = 0.4863, lr_0 = 2.3582e-04
Loss = 5.0975e-02, PNorm = 63.3642, GNorm = 0.3387, lr_0 = 2.3064e-04
Loss = 7.0433e-02, PNorm = 63.3912, GNorm = 0.4153, lr_0 = 2.2557e-04
Loss = 1.1822e-01, PNorm = 63.4142, GNorm = 0.6541, lr_0 = 2.2061e-04
Validation auc = 0.783730
Epoch 20
Loss = 5.5336e-02, PNorm = 63.4439, GNorm = 0.3434, lr_0 = 2.1576e-04
Loss = 7.6792e-02, PNorm = 63.4637, GNorm = 0.3699, lr_0 = 2.1102e-04
Loss = 5.2643e-02, PNorm = 63.4945, GNorm = 0.4256, lr_0 = 2.0638e-04
Loss = 9.3283e-02, PNorm = 63.5120, GNorm = 0.4994, lr_0 = 2.0185e-04
Validation auc = 0.780754
Epoch 21
Loss = 6.7776e-02, PNorm = 63.5445, GNorm = 0.3582, lr_0 = 1.9697e-04
Loss = 5.5609e-02, PNorm = 63.5712, GNorm = 0.8172, lr_0 = 1.9264e-04
Loss = 5.1711e-02, PNorm = 63.5884, GNorm = 0.1960, lr_0 = 1.8841e-04
Loss = 1.0265e-01, PNorm = 63.6059, GNorm = 0.4975, lr_0 = 1.8427e-04
Validation auc = 0.791667
Epoch 22
Loss = 6.1130e-02, PNorm = 63.6397, GNorm = 0.5622, lr_0 = 1.7982e-04
Loss = 7.5267e-02, PNorm = 63.6592, GNorm = 0.5509, lr_0 = 1.7586e-04
Loss = 6.2125e-02, PNorm = 63.6862, GNorm = 0.5188, lr_0 = 1.7200e-04
Validation auc = 0.809524
Epoch 23
Loss = 4.0602e-02, PNorm = 63.7047, GNorm = 0.3932, lr_0 = 1.6822e-04
Loss = 5.4610e-02, PNorm = 63.7246, GNorm = 0.5468, lr_0 = 1.6452e-04
Loss = 7.5982e-02, PNorm = 63.7464, GNorm = 0.1970, lr_0 = 1.6090e-04
Loss = 5.5031e-02, PNorm = 63.7675, GNorm = 0.2593, lr_0 = 1.5737e-04
Validation auc = 0.809524
Epoch 24
Loss = 1.3256e-02, PNorm = 63.7936, GNorm = 0.0861, lr_0 = 1.5357e-04
Loss = 6.8790e-02, PNorm = 63.8090, GNorm = 0.3395, lr_0 = 1.5019e-04
Loss = 7.6792e-02, PNorm = 63.8285, GNorm = 0.1570, lr_0 = 1.4689e-04
Loss = 6.9465e-02, PNorm = 63.8466, GNorm = 0.5404, lr_0 = 1.4366e-04
Validation auc = 0.795635
Epoch 25
Loss = 4.7485e-02, PNorm = 63.8676, GNorm = 0.5877, lr_0 = 1.4050e-04
Loss = 3.5394e-02, PNorm = 63.8833, GNorm = 0.1633, lr_0 = 1.3741e-04
Loss = 6.8362e-02, PNorm = 63.9032, GNorm = 0.2224, lr_0 = 1.3439e-04
Loss = 7.6543e-02, PNorm = 63.9152, GNorm = 0.6908, lr_0 = 1.3144e-04
Validation auc = 0.800099
Epoch 26
Loss = 2.8113e-02, PNorm = 63.9375, GNorm = 0.4210, lr_0 = 1.2826e-04
Loss = 6.2219e-02, PNorm = 63.9478, GNorm = 0.6836, lr_0 = 1.2545e-04
Loss = 7.6257e-02, PNorm = 63.9744, GNorm = 0.0827, lr_0 = 1.2269e-04
Validation auc = 0.796627
Epoch 27
Loss = 5.7030e-02, PNorm = 63.9849, GNorm = 0.6796, lr_0 = 1.1973e-04
Loss = 4.6077e-02, PNorm = 64.0056, GNorm = 0.5609, lr_0 = 1.1709e-04
Loss = 5.0349e-02, PNorm = 64.0176, GNorm = 0.9148, lr_0 = 1.1452e-04
Loss = 5.7789e-02, PNorm = 64.0312, GNorm = 1.1910, lr_0 = 1.1200e-04
Validation auc = 0.797619
Epoch 28
Loss = 5.4980e-02, PNorm = 64.0484, GNorm = 0.5140, lr_0 = 1.0954e-04
Loss = 3.1682e-02, PNorm = 64.0609, GNorm = 0.2559, lr_0 = 1.0713e-04
Loss = 5.5687e-02, PNorm = 64.0768, GNorm = 0.3004, lr_0 = 1.0478e-04
Loss = 4.9737e-02, PNorm = 64.0882, GNorm = 0.2185, lr_0 = 1.0247e-04
Validation auc = 0.820933
Epoch 29
Loss = 6.4042e-02, PNorm = 64.0971, GNorm = 1.0692, lr_0 = 1.0000e-04
Loss = 3.5171e-02, PNorm = 64.1126, GNorm = 0.4062, lr_0 = 1.0000e-04
Loss = 5.0712e-02, PNorm = 64.1240, GNorm = 0.6930, lr_0 = 1.0000e-04
Loss = 4.2491e-02, PNorm = 64.1359, GNorm = 1.4301, lr_0 = 1.0000e-04
Loss = 3.9166e-02, PNorm = 64.1363, GNorm = 0.9659, lr_0 = 1.0000e-04
Validation auc = 0.786706
Model 0 best validation auc = 0.820933 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = 0.870363
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 3.2219e-01, PNorm = 59.4707, GNorm = 0.6634, lr_0 = 2.3378e-04
Loss = 2.2453e-01, PNorm = 59.5022, GNorm = 1.5069, lr_0 = 3.5541e-04
Loss = 1.9744e-01, PNorm = 59.5325, GNorm = 0.3464, lr_0 = 4.7703e-04
Validation auc = 0.750000
Epoch 1
Loss = 2.4359e-01, PNorm = 59.5662, GNorm = 0.5892, lr_0 = 6.1081e-04
Loss = 2.0330e-01, PNorm = 59.6019, GNorm = 0.9900, lr_0 = 7.3243e-04
Loss = 1.9347e-01, PNorm = 59.6355, GNorm = 0.4692, lr_0 = 8.5405e-04
Loss = 1.9632e-01, PNorm = 59.6850, GNorm = 0.3397, lr_0 = 9.7568e-04
Validation auc = 0.787698
Epoch 2
Loss = 2.2164e-01, PNorm = 59.7582, GNorm = 0.7109, lr_0 = 9.8020e-04
Loss = 2.1270e-01, PNorm = 59.8414, GNorm = 0.4614, lr_0 = 9.5865e-04
Loss = 1.5853e-01, PNorm = 59.9397, GNorm = 0.2304, lr_0 = 9.3758e-04
Loss = 1.9039e-01, PNorm = 60.0016, GNorm = 0.4236, lr_0 = 9.1697e-04
Validation auc = 0.765873
Epoch 3
Loss = 1.4503e-01, PNorm = 60.0706, GNorm = 0.4056, lr_0 = 8.9681e-04
Loss = 2.0398e-01, PNorm = 60.1423, GNorm = 1.1802, lr_0 = 8.7710e-04
Loss = 1.7982e-01, PNorm = 60.2163, GNorm = 0.2248, lr_0 = 8.5782e-04
Validation auc = 0.728175
Epoch 4
Loss = 7.8163e-02, PNorm = 60.2833, GNorm = 0.4619, lr_0 = 8.3710e-04
Loss = 1.8275e-01, PNorm = 60.3481, GNorm = 0.2687, lr_0 = 8.1870e-04
Loss = 1.8028e-01, PNorm = 60.4186, GNorm = 0.2892, lr_0 = 8.0071e-04
Loss = 1.6532e-01, PNorm = 60.4912, GNorm = 0.4447, lr_0 = 7.8311e-04
Validation auc = 0.700397
Epoch 5
Loss = 1.7394e-01, PNorm = 60.5471, GNorm = 0.3816, lr_0 = 7.6420e-04
Loss = 1.2073e-01, PNorm = 60.6220, GNorm = 0.2083, lr_0 = 7.4740e-04
Loss = 1.5050e-01, PNorm = 60.6761, GNorm = 0.3930, lr_0 = 7.3097e-04
Loss = 1.6568e-01, PNorm = 60.7325, GNorm = 0.3977, lr_0 = 7.1490e-04
Validation auc = 0.775298
Epoch 6
Loss = 1.7590e-01, PNorm = 60.7943, GNorm = 0.3740, lr_0 = 6.9919e-04
Loss = 1.8101e-01, PNorm = 60.8594, GNorm = 0.2524, lr_0 = 6.8382e-04
Loss = 1.2339e-01, PNorm = 60.9474, GNorm = 0.5048, lr_0 = 6.6879e-04
Loss = 1.4886e-01, PNorm = 61.0332, GNorm = 0.4764, lr_0 = 6.5409e-04
Validation auc = 0.752480
Epoch 7
Loss = 1.3553e-01, PNorm = 61.1067, GNorm = 0.2793, lr_0 = 6.3829e-04
Loss = 1.4971e-01, PNorm = 61.1797, GNorm = 0.2332, lr_0 = 6.2426e-04
Loss = 1.6776e-01, PNorm = 61.2268, GNorm = 0.5335, lr_0 = 6.1054e-04
Validation auc = 0.720734
Epoch 8
Loss = 2.0973e-01, PNorm = 61.2984, GNorm = 0.2528, lr_0 = 5.9579e-04
Loss = 1.2564e-01, PNorm = 61.3635, GNorm = 1.0903, lr_0 = 5.8270e-04
Loss = 1.1925e-01, PNorm = 61.4250, GNorm = 0.9111, lr_0 = 5.6989e-04
Loss = 1.3186e-01, PNorm = 61.4897, GNorm = 0.3486, lr_0 = 5.5736e-04
Validation auc = 0.779266
Epoch 9
Loss = 9.1280e-02, PNorm = 61.5541, GNorm = 0.1823, lr_0 = 5.4511e-04
Loss = 1.1382e-01, PNorm = 61.6104, GNorm = 0.2769, lr_0 = 5.3313e-04
Loss = 1.6204e-01, PNorm = 61.6811, GNorm = 0.1773, lr_0 = 5.2141e-04
Loss = 1.1776e-01, PNorm = 61.7381, GNorm = 0.2488, lr_0 = 5.0995e-04
Validation auc = 0.737599
Epoch 10
Loss = 1.2565e-01, PNorm = 61.8114, GNorm = 0.5170, lr_0 = 4.9764e-04
Loss = 9.9958e-02, PNorm = 61.8789, GNorm = 0.7436, lr_0 = 4.8670e-04
Loss = 1.4014e-01, PNorm = 61.9476, GNorm = 0.6899, lr_0 = 4.7600e-04
Loss = 1.4879e-01, PNorm = 61.9937, GNorm = 0.4684, lr_0 = 4.6554e-04
Loss = 4.1345e-02, PNorm = 62.0007, GNorm = 0.4600, lr_0 = 4.6450e-04
Validation auc = 0.780754
Epoch 11
Loss = 1.5024e-01, PNorm = 62.0571, GNorm = 0.4715, lr_0 = 4.5429e-04
Loss = 1.2917e-01, PNorm = 62.1298, GNorm = 0.5272, lr_0 = 4.4431e-04
Loss = 6.7941e-02, PNorm = 62.1829, GNorm = 0.2795, lr_0 = 4.3454e-04
Validation auc = 0.778274
Epoch 12
Loss = 4.9071e-02, PNorm = 62.2169, GNorm = 0.2334, lr_0 = 4.2499e-04
Loss = 8.2055e-02, PNorm = 62.2687, GNorm = 0.4877, lr_0 = 4.1565e-04
Loss = 1.3906e-01, PNorm = 62.3139, GNorm = 0.6748, lr_0 = 4.0651e-04
Loss = 1.2508e-01, PNorm = 62.3658, GNorm = 1.1833, lr_0 = 3.9758e-04
Validation auc = 0.796131
Epoch 13
Loss = 8.0208e-02, PNorm = 62.4248, GNorm = 0.4893, lr_0 = 3.8797e-04
Loss = 1.0979e-01, PNorm = 62.4656, GNorm = 0.8774, lr_0 = 3.7945e-04
Loss = 1.1947e-01, PNorm = 62.5085, GNorm = 0.3024, lr_0 = 3.7111e-04
Loss = 8.9400e-02, PNorm = 62.5515, GNorm = 0.8708, lr_0 = 3.6295e-04
Validation auc = 0.778770
Epoch 14
Loss = 8.9752e-02, PNorm = 62.5923, GNorm = 0.4630, lr_0 = 3.5497e-04
Loss = 1.0291e-01, PNorm = 62.6455, GNorm = 0.4854, lr_0 = 3.4717e-04
Loss = 9.4638e-02, PNorm = 62.6849, GNorm = 0.4890, lr_0 = 3.3954e-04
Loss = 1.0382e-01, PNorm = 62.7168, GNorm = 0.5416, lr_0 = 3.3207e-04
Loss = 8.4248e-02, PNorm = 62.7176, GNorm = 0.6084, lr_0 = 3.3134e-04
Validation auc = 0.788194
Epoch 15
Loss = 9.5505e-02, PNorm = 62.7588, GNorm = 0.1938, lr_0 = 3.2405e-04
Loss = 1.2336e-01, PNorm = 62.7894, GNorm = 1.0748, lr_0 = 3.1693e-04
Loss = 8.5994e-02, PNorm = 62.8390, GNorm = 0.5152, lr_0 = 3.0997e-04
Validation auc = 0.793155
Epoch 16
Loss = 7.4736e-02, PNorm = 62.8799, GNorm = 0.8009, lr_0 = 3.0248e-04
Loss = 9.7441e-02, PNorm = 62.9189, GNorm = 0.3447, lr_0 = 2.9583e-04
Loss = 7.6513e-02, PNorm = 62.9563, GNorm = 0.3027, lr_0 = 2.8933e-04
Loss = 8.9607e-02, PNorm = 62.9941, GNorm = 0.3748, lr_0 = 2.8297e-04
Validation auc = 0.799603
Epoch 17
Loss = 7.3160e-02, PNorm = 63.0217, GNorm = 0.3000, lr_0 = 2.7675e-04
Loss = 7.2991e-02, PNorm = 63.0543, GNorm = 0.4984, lr_0 = 2.7067e-04
Loss = 5.2822e-02, PNorm = 63.0870, GNorm = 0.3307, lr_0 = 2.6472e-04
Loss = 1.3419e-01, PNorm = 63.1079, GNorm = 2.0360, lr_0 = 2.5890e-04
Validation auc = 0.786210
Epoch 18
Loss = 7.0214e-02, PNorm = 63.1551, GNorm = 0.2761, lr_0 = 2.5264e-04
Loss = 7.4782e-02, PNorm = 63.1854, GNorm = 0.6834, lr_0 = 2.4709e-04
Loss = 1.1110e-01, PNorm = 63.2162, GNorm = 0.3779, lr_0 = 2.4166e-04
Validation auc = 0.796131
Epoch 19
Loss = 5.6322e-02, PNorm = 63.2497, GNorm = 0.4009, lr_0 = 2.3582e-04
Loss = 9.5896e-02, PNorm = 63.2695, GNorm = 0.8320, lr_0 = 2.3064e-04
Loss = 8.7119e-02, PNorm = 63.2983, GNorm = 0.2370, lr_0 = 2.2557e-04
Loss = 6.2010e-02, PNorm = 63.3280, GNorm = 0.1821, lr_0 = 2.2061e-04
Validation auc = 0.814484
Epoch 20
Loss = 4.3528e-02, PNorm = 63.3543, GNorm = 0.2567, lr_0 = 2.1576e-04
Loss = 9.3024e-02, PNorm = 63.3801, GNorm = 0.2902, lr_0 = 2.1102e-04
Loss = 6.3941e-02, PNorm = 63.3994, GNorm = 0.3127, lr_0 = 2.0638e-04
Loss = 6.0000e-02, PNorm = 63.4213, GNorm = 0.3956, lr_0 = 2.0185e-04
Validation auc = 0.799107
Epoch 21
Loss = 5.6536e-02, PNorm = 63.4540, GNorm = 0.4970, lr_0 = 1.9697e-04
Loss = 8.2584e-02, PNorm = 63.4730, GNorm = 0.4072, lr_0 = 1.9264e-04
Loss = 3.3887e-02, PNorm = 63.4995, GNorm = 0.0864, lr_0 = 1.8841e-04
Loss = 8.0383e-02, PNorm = 63.5079, GNorm = 0.6125, lr_0 = 1.8427e-04
Validation auc = 0.794643
Epoch 22
Loss = 6.7239e-02, PNorm = 63.5395, GNorm = 0.2026, lr_0 = 1.7982e-04
Loss = 5.6665e-02, PNorm = 63.5580, GNorm = 0.7691, lr_0 = 1.7586e-04
Loss = 5.9385e-02, PNorm = 63.5782, GNorm = 0.2179, lr_0 = 1.7200e-04
Validation auc = 0.799107
Epoch 23
Loss = 2.0638e-02, PNorm = 63.5945, GNorm = 0.1868, lr_0 = 1.6822e-04
Loss = 8.1391e-02, PNorm = 63.6124, GNorm = 0.5075, lr_0 = 1.6452e-04
Loss = 6.3532e-02, PNorm = 63.6384, GNorm = 0.1217, lr_0 = 1.6090e-04
Loss = 6.4352e-02, PNorm = 63.6544, GNorm = 0.2834, lr_0 = 1.5737e-04
Validation auc = 0.805060
Epoch 24
Loss = 3.2120e-02, PNorm = 63.6796, GNorm = 0.3466, lr_0 = 1.5357e-04
Loss = 4.7613e-02, PNorm = 63.6925, GNorm = 0.2289, lr_0 = 1.5019e-04
Loss = 8.0544e-02, PNorm = 63.7009, GNorm = 0.5519, lr_0 = 1.4689e-04
Loss = 6.1371e-02, PNorm = 63.7232, GNorm = 0.5839, lr_0 = 1.4366e-04
Validation auc = 0.808036
Epoch 25
Loss = 6.4733e-02, PNorm = 63.7315, GNorm = 1.1233, lr_0 = 1.4050e-04
Loss = 7.3415e-02, PNorm = 63.7579, GNorm = 0.7712, lr_0 = 1.3741e-04
Loss = 4.8496e-02, PNorm = 63.7740, GNorm = 0.5513, lr_0 = 1.3439e-04
Loss = 5.5094e-02, PNorm = 63.7833, GNorm = 0.4783, lr_0 = 1.3144e-04
Validation auc = 0.795635
Epoch 26
Loss = 6.0759e-02, PNorm = 63.7943, GNorm = 0.5336, lr_0 = 1.2826e-04
Loss = 5.5438e-02, PNorm = 63.8087, GNorm = 0.1703, lr_0 = 1.2545e-04
Loss = 5.1715e-02, PNorm = 63.8273, GNorm = 1.0818, lr_0 = 1.2269e-04
Validation auc = 0.819444
Epoch 27
Loss = 5.1588e-02, PNorm = 63.8364, GNorm = 0.3886, lr_0 = 1.1973e-04
Loss = 4.7003e-02, PNorm = 63.8516, GNorm = 0.1908, lr_0 = 1.1709e-04
Loss = 4.3541e-02, PNorm = 63.8636, GNorm = 0.4995, lr_0 = 1.1452e-04
Loss = 7.7697e-02, PNorm = 63.8677, GNorm = 0.6039, lr_0 = 1.1200e-04
Validation auc = 0.812996
Epoch 28
Loss = 4.7122e-02, PNorm = 63.8877, GNorm = 0.9000, lr_0 = 1.0954e-04
Loss = 4.5339e-02, PNorm = 63.8983, GNorm = 0.2611, lr_0 = 1.0713e-04
Loss = 6.3545e-02, PNorm = 63.9092, GNorm = 0.6093, lr_0 = 1.0478e-04
Loss = 4.8393e-02, PNorm = 63.9206, GNorm = 1.0001, lr_0 = 1.0247e-04
Validation auc = 0.801587
Epoch 29
Loss = 4.2645e-02, PNorm = 63.9335, GNorm = 0.1834, lr_0 = 1.0000e-04
Loss = 2.5681e-02, PNorm = 63.9447, GNorm = 0.2697, lr_0 = 1.0000e-04
Loss = 5.2024e-02, PNorm = 63.9541, GNorm = 0.2488, lr_0 = 1.0000e-04
Loss = 6.2509e-02, PNorm = 63.9620, GNorm = 0.1359, lr_0 = 1.0000e-04
Loss = 1.1585e-01, PNorm = 63.9617, GNorm = 1.8957, lr_0 = 1.0000e-04
Validation auc = 0.801091
Model 1 best validation auc = 0.819444 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 1 test auc = 0.887892
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 3.1299e-01, PNorm = 59.4763, GNorm = 0.7959, lr_0 = 2.3378e-04
Loss = 2.3841e-01, PNorm = 59.4984, GNorm = 0.4443, lr_0 = 3.5541e-04
Loss = 1.8720e-01, PNorm = 59.5266, GNorm = 0.2413, lr_0 = 4.7703e-04
Validation auc = 0.765873
Epoch 1
Loss = 2.0054e-01, PNorm = 59.5568, GNorm = 0.3701, lr_0 = 6.1081e-04
Loss = 1.9343e-01, PNorm = 59.5885, GNorm = 0.4421, lr_0 = 7.3243e-04
Loss = 2.0282e-01, PNorm = 59.6395, GNorm = 1.0932, lr_0 = 8.5405e-04
Loss = 2.0776e-01, PNorm = 59.7125, GNorm = 0.6197, lr_0 = 9.7568e-04
Validation auc = 0.806548
Epoch 2
Loss = 1.9779e-01, PNorm = 59.8144, GNorm = 0.2432, lr_0 = 9.8020e-04
Loss = 1.5599e-01, PNorm = 59.8929, GNorm = 0.3197, lr_0 = 9.5865e-04
Loss = 2.1460e-01, PNorm = 59.9714, GNorm = 0.4231, lr_0 = 9.3758e-04
Loss = 1.9626e-01, PNorm = 60.0469, GNorm = 0.8725, lr_0 = 9.1697e-04
Validation auc = 0.768849
Epoch 3
Loss = 1.9905e-01, PNorm = 60.1209, GNorm = 0.3305, lr_0 = 8.9681e-04
Loss = 1.8340e-01, PNorm = 60.1881, GNorm = 0.3114, lr_0 = 8.7710e-04
Loss = 1.5749e-01, PNorm = 60.2512, GNorm = 0.4543, lr_0 = 8.5782e-04
Validation auc = 0.767857
Epoch 4
Loss = 9.8784e-02, PNorm = 60.3183, GNorm = 0.4318, lr_0 = 8.3710e-04
Loss = 1.3930e-01, PNorm = 60.3922, GNorm = 0.5774, lr_0 = 8.1870e-04
Loss = 2.0247e-01, PNorm = 60.4666, GNorm = 0.3472, lr_0 = 8.0071e-04
Loss = 1.8330e-01, PNorm = 60.5479, GNorm = 0.2725, lr_0 = 7.8311e-04
Validation auc = 0.747024
Epoch 5
Loss = 1.6940e-01, PNorm = 60.6390, GNorm = 0.6166, lr_0 = 7.6420e-04
Loss = 1.5866e-01, PNorm = 60.7081, GNorm = 0.4606, lr_0 = 7.4740e-04
Loss = 1.4659e-01, PNorm = 60.7813, GNorm = 0.8743, lr_0 = 7.3097e-04
Loss = 1.9126e-01, PNorm = 60.8545, GNorm = 0.3751, lr_0 = 7.1490e-04
Validation auc = 0.746528
Epoch 6
Loss = 1.3097e-01, PNorm = 60.9294, GNorm = 0.5470, lr_0 = 6.9919e-04
Loss = 1.3861e-01, PNorm = 60.9998, GNorm = 0.3353, lr_0 = 6.8382e-04
Loss = 1.3120e-01, PNorm = 61.0611, GNorm = 0.2254, lr_0 = 6.6879e-04
Loss = 1.7815e-01, PNorm = 61.1370, GNorm = 0.4226, lr_0 = 6.5409e-04
Validation auc = 0.761409
Epoch 7
Loss = 1.4683e-01, PNorm = 61.2014, GNorm = 0.2983, lr_0 = 6.3829e-04
Loss = 1.5080e-01, PNorm = 61.2797, GNorm = 0.3006, lr_0 = 6.2426e-04
Loss = 1.4793e-01, PNorm = 61.3165, GNorm = 0.4499, lr_0 = 6.1054e-04
Validation auc = 0.778274
Epoch 8
Loss = 1.0496e-01, PNorm = 61.3899, GNorm = 0.3427, lr_0 = 5.9579e-04
Loss = 1.0597e-01, PNorm = 61.4707, GNorm = 0.5091, lr_0 = 5.8270e-04
Loss = 1.1781e-01, PNorm = 61.5266, GNorm = 0.6055, lr_0 = 5.6989e-04
Loss = 1.6786e-01, PNorm = 61.5716, GNorm = 0.5468, lr_0 = 5.5736e-04
Validation auc = 0.720734
Epoch 9
Loss = 1.9135e-01, PNorm = 61.6340, GNorm = 0.5717, lr_0 = 5.4511e-04
Loss = 1.4871e-01, PNorm = 61.6889, GNorm = 0.2610, lr_0 = 5.3313e-04
Loss = 8.6511e-02, PNorm = 61.7530, GNorm = 0.2122, lr_0 = 5.2141e-04
Loss = 1.1311e-01, PNorm = 61.8183, GNorm = 0.2059, lr_0 = 5.0995e-04
Validation auc = 0.775794
Epoch 10
Loss = 8.4320e-02, PNorm = 61.8909, GNorm = 0.4329, lr_0 = 4.9764e-04
Loss = 1.4285e-01, PNorm = 61.9246, GNorm = 0.6597, lr_0 = 4.8670e-04
Loss = 1.3546e-01, PNorm = 61.9805, GNorm = 0.2218, lr_0 = 4.7600e-04
Loss = 1.3771e-01, PNorm = 62.0405, GNorm = 0.2886, lr_0 = 4.6554e-04
Loss = 1.1118e-01, PNorm = 62.0476, GNorm = 1.1903, lr_0 = 4.6450e-04
Validation auc = 0.747024
Epoch 11
Loss = 1.3689e-01, PNorm = 62.1003, GNorm = 0.4428, lr_0 = 4.5429e-04
Loss = 7.3580e-02, PNorm = 62.1782, GNorm = 0.3726, lr_0 = 4.4431e-04
Loss = 1.5391e-01, PNorm = 62.2245, GNorm = 0.5025, lr_0 = 4.3454e-04
Validation auc = 0.780258
Epoch 12
Loss = 1.5489e-01, PNorm = 62.2851, GNorm = 0.4409, lr_0 = 4.2499e-04
Loss = 9.7635e-02, PNorm = 62.3241, GNorm = 0.3918, lr_0 = 4.1565e-04
Loss = 1.3903e-01, PNorm = 62.3819, GNorm = 0.2451, lr_0 = 4.0651e-04
Loss = 1.0564e-01, PNorm = 62.4386, GNorm = 0.7788, lr_0 = 3.9758e-04
Validation auc = 0.758433
Epoch 13
Loss = 6.9898e-02, PNorm = 62.4989, GNorm = 0.5167, lr_0 = 3.8797e-04
Loss = 1.1532e-01, PNorm = 62.5370, GNorm = 0.2823, lr_0 = 3.7945e-04
Loss = 1.1134e-01, PNorm = 62.5746, GNorm = 0.3276, lr_0 = 3.7111e-04
Loss = 1.1303e-01, PNorm = 62.6232, GNorm = 1.2054, lr_0 = 3.6295e-04
Validation auc = 0.718750
Epoch 14
Loss = 1.0964e-01, PNorm = 62.6721, GNorm = 0.2544, lr_0 = 3.5497e-04
Loss = 7.7692e-02, PNorm = 62.7196, GNorm = 0.6009, lr_0 = 3.4717e-04
Loss = 1.1966e-01, PNorm = 62.7522, GNorm = 0.5046, lr_0 = 3.3954e-04
Loss = 9.3867e-02, PNorm = 62.7922, GNorm = 0.3009, lr_0 = 3.3207e-04
Loss = 1.3841e-01, PNorm = 62.7962, GNorm = 0.6517, lr_0 = 3.3134e-04
Validation auc = 0.753472
Epoch 15
Loss = 9.5004e-02, PNorm = 62.8382, GNorm = 0.2724, lr_0 = 3.2405e-04
Loss = 9.5301e-02, PNorm = 62.8816, GNorm = 0.6795, lr_0 = 3.1693e-04
Loss = 9.0600e-02, PNorm = 62.9270, GNorm = 0.3716, lr_0 = 3.0997e-04
Validation auc = 0.803075
Epoch 16
Loss = 1.1097e-01, PNorm = 62.9836, GNorm = 0.2390, lr_0 = 3.0248e-04
Loss = 1.2839e-01, PNorm = 63.0214, GNorm = 0.5922, lr_0 = 2.9583e-04
Loss = 5.8150e-02, PNorm = 63.0754, GNorm = 0.4191, lr_0 = 2.8933e-04
Loss = 1.0173e-01, PNorm = 63.1120, GNorm = 0.4415, lr_0 = 2.8297e-04
Validation auc = 0.771825
Epoch 17
Loss = 1.1734e-01, PNorm = 63.1428, GNorm = 0.8480, lr_0 = 2.7675e-04
Loss = 8.9860e-02, PNorm = 63.1769, GNorm = 0.6019, lr_0 = 2.7067e-04
Loss = 7.6892e-02, PNorm = 63.2092, GNorm = 0.5229, lr_0 = 2.6472e-04
Loss = 7.3983e-02, PNorm = 63.2383, GNorm = 0.3479, lr_0 = 2.5890e-04
Validation auc = 0.798611
Epoch 18
Loss = 6.1983e-02, PNorm = 63.2822, GNorm = 1.4123, lr_0 = 2.5264e-04
Loss = 1.0997e-01, PNorm = 63.3047, GNorm = 0.1813, lr_0 = 2.4709e-04
Loss = 8.0240e-02, PNorm = 63.3372, GNorm = 0.4070, lr_0 = 2.4166e-04
Validation auc = 0.772817
Epoch 19
Loss = 2.7962e-02, PNorm = 63.3685, GNorm = 0.3542, lr_0 = 2.3582e-04
Loss = 5.2908e-02, PNorm = 63.4058, GNorm = 0.3527, lr_0 = 2.3064e-04
Loss = 6.2042e-02, PNorm = 63.4402, GNorm = 0.4488, lr_0 = 2.2557e-04
Loss = 8.3745e-02, PNorm = 63.4535, GNorm = 1.2046, lr_0 = 2.2061e-04
Validation auc = 0.774306
Epoch 20
Loss = 9.3351e-02, PNorm = 63.4779, GNorm = 0.5647, lr_0 = 2.1576e-04
Loss = 8.1762e-02, PNorm = 63.5081, GNorm = 0.2912, lr_0 = 2.1102e-04
Loss = 5.0582e-02, PNorm = 63.5420, GNorm = 0.2115, lr_0 = 2.0638e-04
Loss = 7.3318e-02, PNorm = 63.5602, GNorm = 0.1415, lr_0 = 2.0185e-04
Validation auc = 0.779266
Epoch 21
Loss = 7.5282e-02, PNorm = 63.5865, GNorm = 0.4754, lr_0 = 1.9697e-04
Loss = 6.1056e-02, PNorm = 63.6066, GNorm = 0.4187, lr_0 = 1.9264e-04
Loss = 6.1578e-02, PNorm = 63.6309, GNorm = 0.4740, lr_0 = 1.8841e-04
Loss = 9.4132e-02, PNorm = 63.6456, GNorm = 0.7986, lr_0 = 1.8427e-04
Validation auc = 0.789187
Epoch 22
Loss = 7.0504e-02, PNorm = 63.6762, GNorm = 0.2940, lr_0 = 1.7982e-04
Loss = 7.0840e-02, PNorm = 63.6948, GNorm = 0.5913, lr_0 = 1.7586e-04
Loss = 6.2099e-02, PNorm = 63.7248, GNorm = 0.3192, lr_0 = 1.7200e-04
Validation auc = 0.792163
Epoch 23
Loss = 4.5170e-02, PNorm = 63.7442, GNorm = 0.3606, lr_0 = 1.6822e-04
Loss = 4.6323e-02, PNorm = 63.7620, GNorm = 0.7115, lr_0 = 1.6452e-04
Loss = 6.8591e-02, PNorm = 63.7759, GNorm = 0.6892, lr_0 = 1.6090e-04
Loss = 6.0587e-02, PNorm = 63.7958, GNorm = 0.3504, lr_0 = 1.5737e-04
Validation auc = 0.806052
Epoch 24
Loss = 4.4512e-02, PNorm = 63.8157, GNorm = 0.7318, lr_0 = 1.5357e-04
Loss = 7.0908e-02, PNorm = 63.8330, GNorm = 0.8634, lr_0 = 1.5019e-04
Loss = 4.6426e-02, PNorm = 63.8555, GNorm = 0.6301, lr_0 = 1.4689e-04
Loss = 5.4259e-02, PNorm = 63.8666, GNorm = 0.3101, lr_0 = 1.4366e-04
Validation auc = 0.813492
Epoch 25
Loss = 7.0061e-02, PNorm = 63.8926, GNorm = 0.4672, lr_0 = 1.4050e-04
Loss = 6.5510e-02, PNorm = 63.8993, GNorm = 0.5860, lr_0 = 1.3741e-04
Loss = 4.9881e-02, PNorm = 63.9223, GNorm = 0.4681, lr_0 = 1.3439e-04
Loss = 5.7519e-02, PNorm = 63.9351, GNorm = 0.2116, lr_0 = 1.3144e-04
Validation auc = 0.807540
Epoch 26
Loss = 5.8400e-02, PNorm = 63.9522, GNorm = 1.0408, lr_0 = 1.2826e-04
Loss = 5.2802e-02, PNorm = 63.9698, GNorm = 0.8908, lr_0 = 1.2545e-04
Loss = 3.9981e-02, PNorm = 63.9829, GNorm = 0.0714, lr_0 = 1.2269e-04
Validation auc = 0.783234
Epoch 27
Loss = 2.8259e-02, PNorm = 63.9908, GNorm = 0.1939, lr_0 = 1.1973e-04
Loss = 5.2805e-02, PNorm = 64.0013, GNorm = 0.4168, lr_0 = 1.1709e-04
Loss = 5.0474e-02, PNorm = 64.0124, GNorm = 0.3621, lr_0 = 1.1452e-04
Loss = 3.6177e-02, PNorm = 64.0281, GNorm = 0.4466, lr_0 = 1.1200e-04
Validation auc = 0.789187
Epoch 28
Loss = 4.7969e-02, PNorm = 64.0334, GNorm = 0.4921, lr_0 = 1.0954e-04
Loss = 3.7169e-02, PNorm = 64.0508, GNorm = 0.2655, lr_0 = 1.0713e-04
Loss = 4.0525e-02, PNorm = 64.0611, GNorm = 0.7064, lr_0 = 1.0478e-04
Loss = 5.1209e-02, PNorm = 64.0694, GNorm = 0.2118, lr_0 = 1.0247e-04
Validation auc = 0.801587
Epoch 29
Loss = 3.5005e-02, PNorm = 64.0797, GNorm = 0.4660, lr_0 = 1.0000e-04
Loss = 3.5554e-02, PNorm = 64.0886, GNorm = 0.4570, lr_0 = 1.0000e-04
Loss = 5.4094e-02, PNorm = 64.1002, GNorm = 1.0528, lr_0 = 1.0000e-04
Loss = 3.8825e-02, PNorm = 64.1157, GNorm = 0.6213, lr_0 = 1.0000e-04
Loss = 6.1147e-02, PNorm = 64.1167, GNorm = 0.9969, lr_0 = 1.0000e-04
Validation auc = 0.807044
Model 2 best validation auc = 0.813492 on epoch 24
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 2 test auc = 0.924990
Ensemble test auc = 0.901345
Fold 4
Splitting data with seed 4
Class sizes
hit 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 1,868 | val size = 233 | test size = 234
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 2.5594e-01, PNorm = 59.4448, GNorm = 0.6054, lr_0 = 2.3378e-04
Loss = 2.5337e-01, PNorm = 59.4673, GNorm = 0.5134, lr_0 = 3.5541e-04
Loss = 2.3023e-01, PNorm = 59.4970, GNorm = 0.4805, lr_0 = 4.7703e-04
Validation auc = 0.678475
Epoch 1
Loss = 1.2997e-01, PNorm = 59.5388, GNorm = 0.4393, lr_0 = 6.1081e-04
Loss = 2.0764e-01, PNorm = 59.5832, GNorm = 0.3642, lr_0 = 7.3243e-04
Loss = 2.3848e-01, PNorm = 59.6379, GNorm = 0.6386, lr_0 = 8.5405e-04
Loss = 1.6703e-01, PNorm = 59.7071, GNorm = 0.4292, lr_0 = 9.7568e-04
Validation auc = 0.760538
Epoch 2
Loss = 1.6538e-01, PNorm = 59.7954, GNorm = 0.3592, lr_0 = 9.8020e-04
Loss = 1.6096e-01, PNorm = 59.8634, GNorm = 0.5170, lr_0 = 9.5865e-04
Loss = 2.0968e-01, PNorm = 59.9267, GNorm = 0.5430, lr_0 = 9.3758e-04
Loss = 2.0687e-01, PNorm = 60.0035, GNorm = 0.1856, lr_0 = 9.1697e-04
Validation auc = 0.885202
Epoch 3
Loss = 1.6856e-01, PNorm = 60.0804, GNorm = 0.4111, lr_0 = 8.9681e-04
Loss = 1.6465e-01, PNorm = 60.1650, GNorm = 0.3378, lr_0 = 8.7710e-04
Loss = 2.0075e-01, PNorm = 60.2517, GNorm = 0.4097, lr_0 = 8.5782e-04
Validation auc = 0.818386
Epoch 4
Loss = 1.9270e-01, PNorm = 60.3359, GNorm = 0.3163, lr_0 = 8.3710e-04
Loss = 1.7938e-01, PNorm = 60.4220, GNorm = 0.6864, lr_0 = 8.1870e-04
Loss = 1.2319e-01, PNorm = 60.4977, GNorm = 0.4052, lr_0 = 8.0071e-04
Loss = 1.6925e-01, PNorm = 60.5753, GNorm = 0.2990, lr_0 = 7.8311e-04
Validation auc = 0.795067
Epoch 5
Loss = 1.8008e-01, PNorm = 60.6648, GNorm = 0.5674, lr_0 = 7.6420e-04
Loss = 1.4607e-01, PNorm = 60.7451, GNorm = 0.4506, lr_0 = 7.4740e-04
Loss = 1.7512e-01, PNorm = 60.8313, GNorm = 0.6704, lr_0 = 7.3097e-04
Loss = 1.4146e-01, PNorm = 60.9179, GNorm = 0.5542, lr_0 = 7.1490e-04
Validation auc = 0.820179
Epoch 6
Loss = 8.6815e-02, PNorm = 61.0128, GNorm = 0.1834, lr_0 = 6.9919e-04
Loss = 1.6948e-01, PNorm = 61.0772, GNorm = 0.3483, lr_0 = 6.8382e-04
Loss = 1.7952e-01, PNorm = 61.1271, GNorm = 0.3384, lr_0 = 6.6879e-04
Loss = 1.4607e-01, PNorm = 61.2200, GNorm = 0.8889, lr_0 = 6.5409e-04
Validation auc = 0.813901
Epoch 7
Loss = 1.2305e-01, PNorm = 61.3021, GNorm = 0.2642, lr_0 = 6.3829e-04
Loss = 1.8051e-01, PNorm = 61.3747, GNorm = 0.4453, lr_0 = 6.2426e-04
Loss = 1.1213e-01, PNorm = 61.4441, GNorm = 0.3198, lr_0 = 6.1054e-04
Validation auc = 0.809417
Epoch 8
Loss = 4.7506e-02, PNorm = 61.5212, GNorm = 0.1781, lr_0 = 5.9579e-04
Loss = 1.0901e-01, PNorm = 61.6079, GNorm = 0.5522, lr_0 = 5.8270e-04
Loss = 1.6238e-01, PNorm = 61.6696, GNorm = 0.6152, lr_0 = 5.6989e-04
Loss = 1.1673e-01, PNorm = 61.7465, GNorm = 0.4005, lr_0 = 5.5736e-04
Validation auc = 0.809865
Epoch 9
Loss = 1.2674e-01, PNorm = 61.7890, GNorm = 0.4827, lr_0 = 5.4511e-04
Loss = 1.3484e-01, PNorm = 61.8515, GNorm = 0.7635, lr_0 = 5.3313e-04
Loss = 1.4805e-01, PNorm = 61.9110, GNorm = 0.5629, lr_0 = 5.2141e-04
Loss = 1.1664e-01, PNorm = 61.9743, GNorm = 1.3838, lr_0 = 5.0995e-04
Validation auc = 0.822870
Epoch 10
Loss = 1.2489e-01, PNorm = 62.0386, GNorm = 0.3650, lr_0 = 4.9764e-04
Loss = 1.0832e-01, PNorm = 62.1114, GNorm = 0.3616, lr_0 = 4.8670e-04
Loss = 8.9625e-02, PNorm = 62.1768, GNorm = 0.6666, lr_0 = 4.7600e-04
Loss = 1.5455e-01, PNorm = 62.2000, GNorm = 0.4351, lr_0 = 4.6554e-04
Loss = 3.0260e-01, PNorm = 62.2025, GNorm = 1.1988, lr_0 = 4.6450e-04
Validation auc = 0.827354
Epoch 11
Loss = 9.7327e-02, PNorm = 62.2671, GNorm = 0.2996, lr_0 = 4.5429e-04
Loss = 1.2184e-01, PNorm = 62.3178, GNorm = 0.4647, lr_0 = 4.4431e-04
Loss = 1.2455e-01, PNorm = 62.3706, GNorm = 0.7042, lr_0 = 4.3454e-04
Validation auc = 0.829148
Epoch 12
Loss = 8.4489e-02, PNorm = 62.4190, GNorm = 0.6406, lr_0 = 4.2499e-04
Loss = 1.0393e-01, PNorm = 62.4782, GNorm = 0.6593, lr_0 = 4.1565e-04
Loss = 9.6977e-02, PNorm = 62.5241, GNorm = 0.4419, lr_0 = 4.0651e-04
Loss = 1.1814e-01, PNorm = 62.5672, GNorm = 0.2441, lr_0 = 3.9758e-04
Validation auc = 0.835426
Epoch 13
Loss = 1.0589e-01, PNorm = 62.6150, GNorm = 0.1946, lr_0 = 3.8797e-04
Loss = 1.2682e-01, PNorm = 62.6528, GNorm = 0.2754, lr_0 = 3.7945e-04
Loss = 9.8912e-02, PNorm = 62.6963, GNorm = 0.2869, lr_0 = 3.7111e-04
Loss = 6.7052e-02, PNorm = 62.7361, GNorm = 0.3923, lr_0 = 3.6295e-04
Validation auc = 0.826457
Epoch 14
Loss = 8.2294e-02, PNorm = 62.7762, GNorm = 0.5649, lr_0 = 3.5497e-04
Loss = 1.0881e-01, PNorm = 62.8057, GNorm = 0.3849, lr_0 = 3.4717e-04
Loss = 8.5544e-02, PNorm = 62.8673, GNorm = 0.3744, lr_0 = 3.3954e-04
Loss = 1.3415e-01, PNorm = 62.8939, GNorm = 0.5880, lr_0 = 3.3207e-04
Loss = 1.1955e-01, PNorm = 62.9001, GNorm = 1.1842, lr_0 = 3.3134e-04
Validation auc = 0.850224
Epoch 15
Loss = 9.2097e-02, PNorm = 62.9659, GNorm = 0.4321, lr_0 = 3.2405e-04
Loss = 9.8527e-02, PNorm = 63.0036, GNorm = 0.2825, lr_0 = 3.1693e-04
Loss = 8.7451e-02, PNorm = 63.0360, GNorm = 0.4024, lr_0 = 3.0997e-04
Validation auc = 0.825561
Epoch 16
Loss = 4.3737e-02, PNorm = 63.0716, GNorm = 0.5356, lr_0 = 3.0248e-04
Loss = 1.0232e-01, PNorm = 63.0925, GNorm = 0.5067, lr_0 = 2.9583e-04
Loss = 9.6512e-02, PNorm = 63.1373, GNorm = 0.8082, lr_0 = 2.8933e-04
Loss = 8.0652e-02, PNorm = 63.1605, GNorm = 0.4691, lr_0 = 2.8297e-04
Validation auc = 0.817489
Epoch 17
Loss = 6.6070e-02, PNorm = 63.2099, GNorm = 0.2745, lr_0 = 2.7675e-04
Loss = 9.7553e-02, PNorm = 63.2238, GNorm = 0.2710, lr_0 = 2.7067e-04
Loss = 9.7259e-02, PNorm = 63.2523, GNorm = 0.3568, lr_0 = 2.6472e-04
Loss = 7.9358e-02, PNorm = 63.2887, GNorm = 0.6593, lr_0 = 2.5890e-04
Validation auc = 0.820628
Epoch 18
Loss = 6.7761e-02, PNorm = 63.3192, GNorm = 0.4074, lr_0 = 2.5264e-04
Loss = 8.6128e-02, PNorm = 63.3465, GNorm = 0.4533, lr_0 = 2.4709e-04
Loss = 9.0995e-02, PNorm = 63.3669, GNorm = 0.2106, lr_0 = 2.4166e-04
Validation auc = 0.825112
Epoch 19
Loss = 1.1104e-01, PNorm = 63.4062, GNorm = 0.6544, lr_0 = 2.3582e-04
Loss = 5.8478e-02, PNorm = 63.4313, GNorm = 0.2282, lr_0 = 2.3064e-04
Loss = 7.0805e-02, PNorm = 63.4568, GNorm = 0.7119, lr_0 = 2.2557e-04
Loss = 7.8294e-02, PNorm = 63.4844, GNorm = 0.5451, lr_0 = 2.2061e-04
Validation auc = 0.820179
Epoch 20
Loss = 6.6133e-02, PNorm = 63.5043, GNorm = 0.5210, lr_0 = 2.1576e-04
Loss = 6.9440e-02, PNorm = 63.5495, GNorm = 0.6317, lr_0 = 2.1102e-04
Loss = 9.3204e-02, PNorm = 63.5677, GNorm = 0.9580, lr_0 = 2.0638e-04
Loss = 6.4729e-02, PNorm = 63.5970, GNorm = 0.4753, lr_0 = 2.0185e-04
Validation auc = 0.805830
Epoch 21
Loss = 5.1628e-02, PNorm = 63.6222, GNorm = 0.3409, lr_0 = 1.9697e-04
Loss = 7.1650e-02, PNorm = 63.6409, GNorm = 0.2951, lr_0 = 1.9264e-04
Loss = 6.0724e-02, PNorm = 63.6554, GNorm = 0.4261, lr_0 = 1.8841e-04
Loss = 6.0167e-02, PNorm = 63.6742, GNorm = 0.3847, lr_0 = 1.8427e-04
Validation auc = 0.828251
Epoch 22
Loss = 4.3390e-02, PNorm = 63.7034, GNorm = 0.2960, lr_0 = 1.7982e-04
Loss = 6.9608e-02, PNorm = 63.7186, GNorm = 0.4687, lr_0 = 1.7586e-04
Loss = 5.3361e-02, PNorm = 63.7469, GNorm = 0.5489, lr_0 = 1.7200e-04
Validation auc = 0.821973
Epoch 23
Loss = 4.3124e-02, PNorm = 63.7571, GNorm = 0.6055, lr_0 = 1.6822e-04
Loss = 6.5602e-02, PNorm = 63.7897, GNorm = 0.2041, lr_0 = 1.6452e-04
Loss = 6.5064e-02, PNorm = 63.8082, GNorm = 0.7061, lr_0 = 1.6090e-04
Loss = 5.3987e-02, PNorm = 63.8242, GNorm = 0.3162, lr_0 = 1.5737e-04
Validation auc = 0.823767
Epoch 24
Loss = 3.6534e-02, PNorm = 63.8413, GNorm = 0.2367, lr_0 = 1.5357e-04
Loss = 7.3025e-02, PNorm = 63.8678, GNorm = 0.5270, lr_0 = 1.5019e-04
Loss = 3.5470e-02, PNorm = 63.8845, GNorm = 0.5410, lr_0 = 1.4689e-04
Loss = 5.9152e-02, PNorm = 63.8903, GNorm = 0.2716, lr_0 = 1.4366e-04
Validation auc = 0.825561
Epoch 25
Loss = 6.5232e-02, PNorm = 63.9118, GNorm = 0.4535, lr_0 = 1.4050e-04
Loss = 4.0592e-02, PNorm = 63.9331, GNorm = 0.9331, lr_0 = 1.3741e-04
Loss = 6.4369e-02, PNorm = 63.9331, GNorm = 0.5770, lr_0 = 1.3439e-04
Loss = 5.1790e-02, PNorm = 63.9552, GNorm = 0.6096, lr_0 = 1.3144e-04
Validation auc = 0.819731
Epoch 26
Loss = 2.8270e-02, PNorm = 63.9715, GNorm = 0.6430, lr_0 = 1.2826e-04
Loss = 4.9029e-02, PNorm = 63.9881, GNorm = 0.3610, lr_0 = 1.2545e-04
Loss = 7.7992e-02, PNorm = 63.9927, GNorm = 0.2919, lr_0 = 1.2269e-04
Validation auc = 0.812556
Epoch 27
Loss = 4.7367e-02, PNorm = 64.0072, GNorm = 0.4985, lr_0 = 1.1973e-04
Loss = 2.9359e-02, PNorm = 64.0246, GNorm = 0.6455, lr_0 = 1.1709e-04
Loss = 7.0204e-02, PNorm = 64.0331, GNorm = 0.2925, lr_0 = 1.1452e-04
Loss = 6.3934e-02, PNorm = 64.0409, GNorm = 0.6754, lr_0 = 1.1200e-04
Validation auc = 0.819283
Epoch 28
Loss = 4.1306e-02, PNorm = 64.0618, GNorm = 0.8330, lr_0 = 1.0954e-04
Loss = 3.4863e-02, PNorm = 64.0743, GNorm = 0.1798, lr_0 = 1.0713e-04
Loss = 5.9186e-02, PNorm = 64.0823, GNorm = 0.5835, lr_0 = 1.0478e-04
Loss = 3.8892e-02, PNorm = 64.0928, GNorm = 0.7622, lr_0 = 1.0247e-04
Validation auc = 0.814798
Epoch 29
Loss = 3.0357e-02, PNorm = 64.1022, GNorm = 0.6608, lr_0 = 1.0000e-04
Loss = 4.2758e-02, PNorm = 64.1100, GNorm = 0.1961, lr_0 = 1.0000e-04
Loss = 3.5065e-02, PNorm = 64.1181, GNorm = 0.2253, lr_0 = 1.0000e-04
Loss = 4.2124e-02, PNorm = 64.1262, GNorm = 0.7363, lr_0 = 1.0000e-04
Loss = 1.2009e-03, PNorm = 64.1269, GNorm = 0.0450, lr_0 = 1.0000e-04
Validation auc = 0.815695
Model 0 best validation auc = 0.885202 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = 0.741235
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 2.6575e-01, PNorm = 59.4729, GNorm = 1.8786, lr_0 = 2.3378e-04
Loss = 2.6529e-01, PNorm = 59.5014, GNorm = 0.6742, lr_0 = 3.5541e-04
Loss = 2.1435e-01, PNorm = 59.5375, GNorm = 0.3699, lr_0 = 4.7703e-04
Validation auc = 0.853363
Epoch 1
Loss = 1.7756e-01, PNorm = 59.5901, GNorm = 0.3872, lr_0 = 6.1081e-04
Loss = 1.8993e-01, PNorm = 59.6276, GNorm = 0.2875, lr_0 = 7.3243e-04
Loss = 2.1511e-01, PNorm = 59.6686, GNorm = 0.3791, lr_0 = 8.5405e-04
Loss = 2.2435e-01, PNorm = 59.7081, GNorm = 0.4351, lr_0 = 9.7568e-04
Validation auc = 0.786099
Epoch 2
Loss = 2.4525e-01, PNorm = 59.7754, GNorm = 0.3204, lr_0 = 9.8020e-04
Loss = 1.9180e-01, PNorm = 59.8509, GNorm = 0.5295, lr_0 = 9.5865e-04
Loss = 1.9188e-01, PNorm = 59.9242, GNorm = 0.2838, lr_0 = 9.3758e-04
Loss = 1.5542e-01, PNorm = 59.9757, GNorm = 0.5518, lr_0 = 9.1697e-04
Validation auc = 0.869058
Epoch 3
Loss = 2.1191e-01, PNorm = 60.0470, GNorm = 0.4083, lr_0 = 8.9681e-04
Loss = 1.4739e-01, PNorm = 60.1240, GNorm = 0.8307, lr_0 = 8.7710e-04
Loss = 1.9158e-01, PNorm = 60.2158, GNorm = 0.2405, lr_0 = 8.5782e-04
Validation auc = 0.773094
Epoch 4
Loss = 1.0898e-01, PNorm = 60.3204, GNorm = 0.2928, lr_0 = 8.3710e-04
Loss = 1.9405e-01, PNorm = 60.3799, GNorm = 0.3065, lr_0 = 8.1870e-04
Loss = 1.4036e-01, PNorm = 60.4620, GNorm = 0.2113, lr_0 = 8.0071e-04
Loss = 1.7458e-01, PNorm = 60.5076, GNorm = 0.3501, lr_0 = 7.8311e-04
Validation auc = 0.817937
Epoch 5
Loss = 1.2406e-01, PNorm = 60.5870, GNorm = 0.2830, lr_0 = 7.6420e-04
Loss = 1.8183e-01, PNorm = 60.6500, GNorm = 0.8582, lr_0 = 7.4740e-04
Loss = 1.5944e-01, PNorm = 60.7526, GNorm = 0.2177, lr_0 = 7.3097e-04
Loss = 1.8378e-01, PNorm = 60.8196, GNorm = 0.3185, lr_0 = 7.1490e-04
Validation auc = 0.826457
Epoch 6
Loss = 1.3337e-01, PNorm = 60.9004, GNorm = 0.2640, lr_0 = 6.9919e-04
Loss = 1.6090e-01, PNorm = 60.9676, GNorm = 0.4554, lr_0 = 6.8382e-04
Loss = 1.9055e-01, PNorm = 61.0555, GNorm = 0.5027, lr_0 = 6.6879e-04
Loss = 1.2270e-01, PNorm = 61.1411, GNorm = 0.2332, lr_0 = 6.5409e-04
Validation auc = 0.809865
Epoch 7
Loss = 1.5972e-01, PNorm = 61.2175, GNorm = 0.3424, lr_0 = 6.3829e-04
Loss = 1.2098e-01, PNorm = 61.2718, GNorm = 0.2451, lr_0 = 6.2426e-04
Loss = 1.3369e-01, PNorm = 61.3369, GNorm = 0.6918, lr_0 = 6.1054e-04
Validation auc = 0.772646
Epoch 8
Loss = 2.1183e-01, PNorm = 61.3955, GNorm = 0.4304, lr_0 = 5.9579e-04
Loss = 1.3418e-01, PNorm = 61.4749, GNorm = 0.2802, lr_0 = 5.8270e-04
Loss = 1.4655e-01, PNorm = 61.5228, GNorm = 0.3798, lr_0 = 5.6989e-04
Loss = 1.5199e-01, PNorm = 61.6033, GNorm = 0.3067, lr_0 = 5.5736e-04
Validation auc = 0.676682
Epoch 9
Loss = 1.0438e-01, PNorm = 61.6664, GNorm = 0.3003, lr_0 = 5.4511e-04
Loss = 1.1024e-01, PNorm = 61.7369, GNorm = 0.3371, lr_0 = 5.3313e-04
Loss = 1.4992e-01, PNorm = 61.7899, GNorm = 0.3313, lr_0 = 5.2141e-04
Loss = 1.5188e-01, PNorm = 61.8483, GNorm = 0.2669, lr_0 = 5.0995e-04
Validation auc = 0.785650
Epoch 10
Loss = 1.7116e-01, PNorm = 61.9273, GNorm = 0.3955, lr_0 = 4.9764e-04
Loss = 1.3255e-01, PNorm = 62.0035, GNorm = 0.5468, lr_0 = 4.8670e-04
Loss = 9.8901e-02, PNorm = 62.0590, GNorm = 0.4946, lr_0 = 4.7600e-04
Loss = 1.2615e-01, PNorm = 62.1137, GNorm = 0.3787, lr_0 = 4.6554e-04
Loss = 3.4727e-02, PNorm = 62.1190, GNorm = 0.5097, lr_0 = 4.6450e-04
Validation auc = 0.794170
Epoch 11
Loss = 1.3970e-01, PNorm = 62.1772, GNorm = 0.2087, lr_0 = 4.5429e-04
Loss = 8.9123e-02, PNorm = 62.2377, GNorm = 0.2094, lr_0 = 4.4431e-04
Loss = 1.3829e-01, PNorm = 62.2871, GNorm = 0.5390, lr_0 = 4.3454e-04
Validation auc = 0.774439
Epoch 12
Loss = 1.4316e-01, PNorm = 62.3458, GNorm = 0.5751, lr_0 = 4.2499e-04
Loss = 1.2475e-01, PNorm = 62.3882, GNorm = 1.2112, lr_0 = 4.1565e-04
Loss = 1.1434e-01, PNorm = 62.4430, GNorm = 0.2420, lr_0 = 4.0651e-04
Loss = 1.0612e-01, PNorm = 62.4794, GNorm = 0.3802, lr_0 = 3.9758e-04
Validation auc = 0.839462
Epoch 13
Loss = 1.1898e-01, PNorm = 62.5395, GNorm = 0.5089, lr_0 = 3.8797e-04
Loss = 1.0735e-01, PNorm = 62.5860, GNorm = 0.4215, lr_0 = 3.7945e-04
Loss = 8.0079e-02, PNorm = 62.6459, GNorm = 0.3491, lr_0 = 3.7111e-04
Loss = 1.3882e-01, PNorm = 62.6788, GNorm = 0.4067, lr_0 = 3.6295e-04
Validation auc = 0.822422
Epoch 14
Loss = 1.1592e-01, PNorm = 62.7363, GNorm = 0.3634, lr_0 = 3.5497e-04
Loss = 1.2366e-01, PNorm = 62.7694, GNorm = 0.6082, lr_0 = 3.4717e-04
Loss = 8.7432e-02, PNorm = 62.8258, GNorm = 0.4122, lr_0 = 3.3954e-04
Loss = 9.3725e-02, PNorm = 62.8622, GNorm = 0.9159, lr_0 = 3.3207e-04
Loss = 2.2100e-02, PNorm = 62.8682, GNorm = 0.3179, lr_0 = 3.3134e-04
Validation auc = 0.822870
Epoch 15
Loss = 1.0145e-01, PNorm = 62.9061, GNorm = 0.3942, lr_0 = 3.2405e-04
Loss = 8.3568e-02, PNorm = 62.9580, GNorm = 0.2033, lr_0 = 3.1693e-04
Loss = 1.0576e-01, PNorm = 62.9926, GNorm = 0.3999, lr_0 = 3.0997e-04
Validation auc = 0.831390
Epoch 16
Loss = 1.5079e-01, PNorm = 63.0265, GNorm = 0.6150, lr_0 = 3.0248e-04
Loss = 7.3300e-02, PNorm = 63.0662, GNorm = 0.5296, lr_0 = 2.9583e-04
Loss = 7.9436e-02, PNorm = 63.1068, GNorm = 0.3020, lr_0 = 2.8933e-04
Loss = 9.3767e-02, PNorm = 63.1436, GNorm = 0.3735, lr_0 = 2.8297e-04
Validation auc = 0.806278
Epoch 17
Loss = 7.3958e-02, PNorm = 63.1902, GNorm = 0.1255, lr_0 = 2.7675e-04
Loss = 8.1271e-02, PNorm = 63.2179, GNorm = 0.4885, lr_0 = 2.7067e-04
Loss = 9.4940e-02, PNorm = 63.2477, GNorm = 0.6531, lr_0 = 2.6472e-04
Loss = 9.3746e-02, PNorm = 63.2877, GNorm = 0.9374, lr_0 = 2.5890e-04
Validation auc = 0.826457
Epoch 18
Loss = 6.6380e-02, PNorm = 63.3123, GNorm = 0.3865, lr_0 = 2.5264e-04
Loss = 6.3296e-02, PNorm = 63.3460, GNorm = 0.6543, lr_0 = 2.4709e-04
Loss = 1.0314e-01, PNorm = 63.3600, GNorm = 0.9642, lr_0 = 2.4166e-04
Validation auc = 0.786099
Epoch 19
Loss = 1.1387e-01, PNorm = 63.4100, GNorm = 0.4040, lr_0 = 2.3582e-04
Loss = 7.6686e-02, PNorm = 63.4379, GNorm = 0.4048, lr_0 = 2.3064e-04
Loss = 8.2020e-02, PNorm = 63.4684, GNorm = 0.4431, lr_0 = 2.2557e-04
Loss = 8.0866e-02, PNorm = 63.5006, GNorm = 0.7262, lr_0 = 2.2061e-04
Validation auc = 0.821076
Epoch 20
Loss = 1.2967e-01, PNorm = 63.5172, GNorm = 0.4933, lr_0 = 2.1576e-04
Loss = 5.9912e-02, PNorm = 63.5534, GNorm = 0.4677, lr_0 = 2.1102e-04
Loss = 7.9009e-02, PNorm = 63.5703, GNorm = 0.2538, lr_0 = 2.0638e-04
Loss = 9.9618e-02, PNorm = 63.5916, GNorm = 0.4895, lr_0 = 2.0185e-04
Validation auc = 0.821525
Epoch 21
Loss = 7.9532e-02, PNorm = 63.6232, GNorm = 0.6350, lr_0 = 1.9697e-04
Loss = 8.4955e-02, PNorm = 63.6535, GNorm = 0.8451, lr_0 = 1.9264e-04
Loss = 6.3094e-02, PNorm = 63.6753, GNorm = 0.4194, lr_0 = 1.8841e-04
Loss = 6.3398e-02, PNorm = 63.6969, GNorm = 0.3373, lr_0 = 1.8427e-04
Validation auc = 0.817937
Epoch 22
Loss = 6.4198e-02, PNorm = 63.7188, GNorm = 1.2486, lr_0 = 1.7982e-04
Loss = 7.9565e-02, PNorm = 63.7378, GNorm = 0.5076, lr_0 = 1.7586e-04
Loss = 4.6046e-02, PNorm = 63.7654, GNorm = 0.7145, lr_0 = 1.7200e-04
Validation auc = 0.813453
Epoch 23
Loss = 2.1704e-02, PNorm = 63.7743, GNorm = 0.3050, lr_0 = 1.6822e-04
Loss = 6.6019e-02, PNorm = 63.8005, GNorm = 0.4932, lr_0 = 1.6452e-04
Loss = 5.3476e-02, PNorm = 63.8236, GNorm = 1.2063, lr_0 = 1.6090e-04
Loss = 8.5394e-02, PNorm = 63.8332, GNorm = 0.7078, lr_0 = 1.5737e-04
Validation auc = 0.794619
Epoch 24
Loss = 8.7420e-02, PNorm = 63.8561, GNorm = 0.5605, lr_0 = 1.5357e-04
Loss = 6.8178e-02, PNorm = 63.8811, GNorm = 0.3276, lr_0 = 1.5019e-04
Loss = 5.5000e-02, PNorm = 63.9054, GNorm = 0.4918, lr_0 = 1.4689e-04
Loss = 3.6930e-02, PNorm = 63.9182, GNorm = 0.3353, lr_0 = 1.4366e-04
Validation auc = 0.835874
Epoch 25
Loss = 5.3517e-02, PNorm = 63.9311, GNorm = 0.3350, lr_0 = 1.4050e-04
Loss = 6.4426e-02, PNorm = 63.9460, GNorm = 0.3741, lr_0 = 1.3741e-04
Loss = 6.8417e-02, PNorm = 63.9568, GNorm = 0.7559, lr_0 = 1.3439e-04
Loss = 5.0108e-02, PNorm = 63.9724, GNorm = 0.5503, lr_0 = 1.3144e-04
Validation auc = 0.806726
Epoch 26
Loss = 6.3496e-02, PNorm = 63.9921, GNorm = 0.8421, lr_0 = 1.2826e-04
Loss = 5.7173e-02, PNorm = 64.0029, GNorm = 0.4905, lr_0 = 1.2545e-04
Loss = 5.2146e-02, PNorm = 64.0233, GNorm = 1.0106, lr_0 = 1.2269e-04
Validation auc = 0.831390
Epoch 27
Loss = 6.3909e-02, PNorm = 64.0337, GNorm = 0.6495, lr_0 = 1.1973e-04
Loss = 4.5410e-02, PNorm = 64.0451, GNorm = 0.7822, lr_0 = 1.1709e-04
Loss = 4.8295e-02, PNorm = 64.0554, GNorm = 0.6761, lr_0 = 1.1452e-04
Loss = 6.2915e-02, PNorm = 64.0695, GNorm = 0.1532, lr_0 = 1.1200e-04
Validation auc = 0.824215
Epoch 28
Loss = 3.1182e-02, PNorm = 64.0843, GNorm = 0.3707, lr_0 = 1.0954e-04
Loss = 6.0165e-02, PNorm = 64.0889, GNorm = 0.7244, lr_0 = 1.0713e-04
Loss = 3.6495e-02, PNorm = 64.1084, GNorm = 0.5951, lr_0 = 1.0478e-04
Loss = 5.3395e-02, PNorm = 64.1147, GNorm = 0.3641, lr_0 = 1.0247e-04
Validation auc = 0.834081
Epoch 29
Loss = 3.9955e-02, PNorm = 64.1279, GNorm = 0.6535, lr_0 = 1.0000e-04
Loss = 5.3442e-02, PNorm = 64.1403, GNorm = 0.9822, lr_0 = 1.0000e-04
Loss = 5.9414e-02, PNorm = 64.1446, GNorm = 0.8042, lr_0 = 1.0000e-04
Loss = 4.2306e-02, PNorm = 64.1643, GNorm = 0.4424, lr_0 = 1.0000e-04
Loss = 9.4782e-04, PNorm = 64.1659, GNorm = 0.0221, lr_0 = 1.0000e-04
Validation auc = 0.833184
Model 1 best validation auc = 0.869058 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 1 test auc = 0.773827
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 3.3834e-01, PNorm = 59.4790, GNorm = 0.8795, lr_0 = 2.3378e-04
Loss = 2.2832e-01, PNorm = 59.5123, GNorm = 0.3848, lr_0 = 3.5541e-04
Loss = 2.0355e-01, PNorm = 59.5419, GNorm = 0.6494, lr_0 = 4.7703e-04
Validation auc = 0.860538
Epoch 1
Loss = 1.0118e-01, PNorm = 59.5837, GNorm = 0.1852, lr_0 = 6.1081e-04
Loss = 2.8905e-01, PNorm = 59.6234, GNorm = 0.5480, lr_0 = 7.3243e-04
Loss = 2.4676e-01, PNorm = 59.6842, GNorm = 0.4554, lr_0 = 8.5405e-04
Loss = 1.8236e-01, PNorm = 59.7459, GNorm = 0.3429, lr_0 = 9.7568e-04
Validation auc = 0.868610
Epoch 2
Loss = 2.0745e-01, PNorm = 59.8284, GNorm = 0.1859, lr_0 = 9.8020e-04
Loss = 2.2936e-01, PNorm = 59.8917, GNorm = 0.3488, lr_0 = 9.5865e-04
Loss = 1.7897e-01, PNorm = 59.9559, GNorm = 0.3331, lr_0 = 9.3758e-04
Loss = 2.0220e-01, PNorm = 60.0120, GNorm = 0.3109, lr_0 = 9.1697e-04
Validation auc = 0.791031
Epoch 3
Loss = 2.4573e-01, PNorm = 60.0614, GNorm = 0.3533, lr_0 = 8.9681e-04
Loss = 1.8058e-01, PNorm = 60.1262, GNorm = 0.2726, lr_0 = 8.7710e-04
Loss = 1.6722e-01, PNorm = 60.1749, GNorm = 0.3205, lr_0 = 8.5782e-04
Validation auc = 0.823318
Epoch 4
Loss = 1.3000e-01, PNorm = 60.2276, GNorm = 0.2344, lr_0 = 8.3710e-04
Loss = 1.5353e-01, PNorm = 60.2800, GNorm = 0.7705, lr_0 = 8.1870e-04
Loss = 1.8106e-01, PNorm = 60.3464, GNorm = 1.0810, lr_0 = 8.0071e-04
Loss = 1.9335e-01, PNorm = 60.4221, GNorm = 0.2271, lr_0 = 7.8311e-04
Validation auc = 0.808520
Epoch 5
Loss = 1.4932e-01, PNorm = 60.4886, GNorm = 0.4640, lr_0 = 7.6420e-04
Loss = 1.2306e-01, PNorm = 60.5744, GNorm = 0.3196, lr_0 = 7.4740e-04
Loss = 1.5681e-01, PNorm = 60.6453, GNorm = 0.2495, lr_0 = 7.3097e-04
Loss = 2.3970e-01, PNorm = 60.7042, GNorm = 0.3199, lr_0 = 7.1490e-04
Validation auc = 0.813901
Epoch 6
Loss = 1.4941e-01, PNorm = 60.8126, GNorm = 0.5777, lr_0 = 6.9919e-04
Loss = 1.5487e-01, PNorm = 60.8851, GNorm = 0.3984, lr_0 = 6.8382e-04
Loss = 1.4836e-01, PNorm = 60.9447, GNorm = 0.9579, lr_0 = 6.6879e-04
Loss = 1.5601e-01, PNorm = 61.0131, GNorm = 0.4411, lr_0 = 6.5409e-04
Validation auc = 0.812556
Epoch 7
Loss = 1.6176e-01, PNorm = 61.0853, GNorm = 0.6081, lr_0 = 6.3829e-04
Loss = 1.6924e-01, PNorm = 61.1458, GNorm = 0.2565, lr_0 = 6.2426e-04
Loss = 1.6641e-01, PNorm = 61.2303, GNorm = 0.2064, lr_0 = 6.1054e-04
Validation auc = 0.829148
Epoch 8
Loss = 6.8268e-02, PNorm = 61.2988, GNorm = 0.3364, lr_0 = 5.9579e-04
Loss = 1.3809e-01, PNorm = 61.3477, GNorm = 1.6678, lr_0 = 5.8270e-04
Loss = 1.2961e-01, PNorm = 61.4103, GNorm = 0.5148, lr_0 = 5.6989e-04
Loss = 1.8888e-01, PNorm = 61.4682, GNorm = 0.4161, lr_0 = 5.5736e-04
Validation auc = 0.839013
Epoch 9
Loss = 1.1645e-01, PNorm = 61.5506, GNorm = 0.2372, lr_0 = 5.4511e-04
Loss = 1.2120e-01, PNorm = 61.6009, GNorm = 0.3997, lr_0 = 5.3313e-04
Loss = 1.4642e-01, PNorm = 61.6539, GNorm = 0.3099, lr_0 = 5.2141e-04
Loss = 1.0646e-01, PNorm = 61.7118, GNorm = 0.3183, lr_0 = 5.0995e-04
Validation auc = 0.769058
Epoch 10
Loss = 1.2700e-01, PNorm = 61.7856, GNorm = 0.3398, lr_0 = 4.9764e-04
Loss = 1.1316e-01, PNorm = 61.8425, GNorm = 0.7348, lr_0 = 4.8670e-04
Loss = 1.5444e-01, PNorm = 61.9086, GNorm = 0.4642, lr_0 = 4.7600e-04
Loss = 1.5565e-01, PNorm = 61.9683, GNorm = 0.3890, lr_0 = 4.6554e-04
Loss = 3.5467e-01, PNorm = 61.9722, GNorm = 0.8290, lr_0 = 4.6450e-04
Validation auc = 0.790583
Epoch 11
Loss = 1.3898e-01, PNorm = 62.0238, GNorm = 0.5359, lr_0 = 4.5429e-04
Loss = 8.7529e-02, PNorm = 62.0742, GNorm = 0.8383, lr_0 = 4.4431e-04
Loss = 1.4974e-01, PNorm = 62.1130, GNorm = 1.0852, lr_0 = 4.3454e-04
Validation auc = 0.819283
Epoch 12
Loss = 1.3055e-01, PNorm = 62.1728, GNorm = 0.2284, lr_0 = 4.2499e-04
Loss = 1.1963e-01, PNorm = 62.2290, GNorm = 0.4155, lr_0 = 4.1565e-04
Loss = 1.1315e-01, PNorm = 62.2696, GNorm = 0.5249, lr_0 = 4.0651e-04
Loss = 1.0084e-01, PNorm = 62.3204, GNorm = 0.2012, lr_0 = 3.9758e-04
Validation auc = 0.832287
Epoch 13
Loss = 1.0866e-01, PNorm = 62.3743, GNorm = 0.4488, lr_0 = 3.8797e-04
Loss = 1.3052e-01, PNorm = 62.4263, GNorm = 0.3417, lr_0 = 3.7945e-04
Loss = 1.2025e-01, PNorm = 62.4899, GNorm = 0.3623, lr_0 = 3.7111e-04
Loss = 9.0934e-02, PNorm = 62.5461, GNorm = 0.8313, lr_0 = 3.6295e-04
Validation auc = 0.805381
Epoch 14
Loss = 1.1698e-01, PNorm = 62.5850, GNorm = 0.6966, lr_0 = 3.5497e-04
Loss = 9.1876e-02, PNorm = 62.6267, GNorm = 0.3512, lr_0 = 3.4717e-04
Loss = 8.7652e-02, PNorm = 62.6699, GNorm = 0.5108, lr_0 = 3.3954e-04
Loss = 1.3388e-01, PNorm = 62.6922, GNorm = 0.4168, lr_0 = 3.3207e-04
Loss = 2.4654e-01, PNorm = 62.6947, GNorm = 0.8018, lr_0 = 3.3134e-04
Validation auc = 0.821076
Epoch 15
Loss = 1.1970e-01, PNorm = 62.7411, GNorm = 0.6000, lr_0 = 3.2405e-04
Loss = 1.1538e-01, PNorm = 62.7822, GNorm = 0.3699, lr_0 = 3.1693e-04
Loss = 9.4013e-02, PNorm = 62.8307, GNorm = 0.4050, lr_0 = 3.0997e-04
Validation auc = 0.798206
Epoch 16
Loss = 1.2231e-01, PNorm = 62.8747, GNorm = 0.8006, lr_0 = 3.0248e-04
Loss = 6.4105e-02, PNorm = 62.9244, GNorm = 0.1372, lr_0 = 2.9583e-04
Loss = 1.3161e-01, PNorm = 62.9544, GNorm = 0.5912, lr_0 = 2.8933e-04
Loss = 9.6908e-02, PNorm = 62.9874, GNorm = 0.6362, lr_0 = 2.8297e-04
Validation auc = 0.825112
Epoch 17
Loss = 8.5444e-02, PNorm = 63.0251, GNorm = 0.6380, lr_0 = 2.7675e-04
Loss = 1.0611e-01, PNorm = 63.0504, GNorm = 0.2714, lr_0 = 2.7067e-04
Loss = 9.9490e-02, PNorm = 63.0911, GNorm = 0.4439, lr_0 = 2.6472e-04
Loss = 9.7060e-02, PNorm = 63.1193, GNorm = 0.4314, lr_0 = 2.5890e-04
Validation auc = 0.835874
Epoch 18
Loss = 7.0165e-02, PNorm = 63.1544, GNorm = 0.3273, lr_0 = 2.5264e-04
Loss = 8.7245e-02, PNorm = 63.1806, GNorm = 0.7125, lr_0 = 2.4709e-04
Loss = 8.9330e-02, PNorm = 63.2162, GNorm = 0.1576, lr_0 = 2.4166e-04
Validation auc = 0.831839
Epoch 19
Loss = 1.3180e-01, PNorm = 63.2291, GNorm = 1.0887, lr_0 = 2.3582e-04
Loss = 9.8385e-02, PNorm = 63.2822, GNorm = 0.9199, lr_0 = 2.3064e-04
Loss = 1.1194e-01, PNorm = 63.3041, GNorm = 0.5220, lr_0 = 2.2557e-04
Loss = 8.5118e-02, PNorm = 63.3420, GNorm = 0.3764, lr_0 = 2.2061e-04
Validation auc = 0.815247
Epoch 20
Loss = 1.2491e-01, PNorm = 63.3676, GNorm = 0.6491, lr_0 = 2.1576e-04
Loss = 7.1698e-02, PNorm = 63.3810, GNorm = 0.3846, lr_0 = 2.1102e-04
Loss = 7.5842e-02, PNorm = 63.4084, GNorm = 0.3457, lr_0 = 2.0638e-04
Loss = 8.5168e-02, PNorm = 63.4362, GNorm = 0.4012, lr_0 = 2.0185e-04
Validation auc = 0.816592
Epoch 21
Loss = 4.8965e-02, PNorm = 63.4695, GNorm = 0.2805, lr_0 = 1.9697e-04
Loss = 8.5143e-02, PNorm = 63.4882, GNorm = 0.5903, lr_0 = 1.9264e-04
Loss = 6.7400e-02, PNorm = 63.5095, GNorm = 1.0781, lr_0 = 1.8841e-04
Loss = 1.0491e-01, PNorm = 63.5330, GNorm = 0.3941, lr_0 = 1.8427e-04
Validation auc = 0.817937
Epoch 22
Loss = 1.1168e-01, PNorm = 63.5631, GNorm = 1.0425, lr_0 = 1.7982e-04
Loss = 7.2624e-02, PNorm = 63.5857, GNorm = 0.2850, lr_0 = 1.7586e-04
Loss = 7.8794e-02, PNorm = 63.6160, GNorm = 0.2098, lr_0 = 1.7200e-04
Validation auc = 0.805830
Epoch 23
Loss = 1.2492e-01, PNorm = 63.6376, GNorm = 1.0015, lr_0 = 1.6822e-04
Loss = 7.6344e-02, PNorm = 63.6532, GNorm = 0.4924, lr_0 = 1.6452e-04
Loss = 8.2666e-02, PNorm = 63.6730, GNorm = 0.6210, lr_0 = 1.6090e-04
Loss = 6.5769e-02, PNorm = 63.6956, GNorm = 0.4274, lr_0 = 1.5737e-04
Validation auc = 0.821076
Epoch 24
Loss = 4.4835e-02, PNorm = 63.7136, GNorm = 0.7549, lr_0 = 1.5357e-04
Loss = 7.1790e-02, PNorm = 63.7342, GNorm = 0.2308, lr_0 = 1.5019e-04
Loss = 8.1240e-02, PNorm = 63.7494, GNorm = 0.6463, lr_0 = 1.4689e-04
Loss = 5.8218e-02, PNorm = 63.7675, GNorm = 0.2400, lr_0 = 1.4366e-04
Validation auc = 0.817040
Epoch 25
Loss = 5.1256e-02, PNorm = 63.7829, GNorm = 0.4365, lr_0 = 1.4050e-04
Loss = 5.6393e-02, PNorm = 63.8031, GNorm = 0.1729, lr_0 = 1.3741e-04
Loss = 7.2555e-02, PNorm = 63.8132, GNorm = 0.5318, lr_0 = 1.3439e-04
Loss = 8.4636e-02, PNorm = 63.8346, GNorm = 1.2837, lr_0 = 1.3144e-04
Validation auc = 0.818386
Epoch 26
Loss = 5.6725e-02, PNorm = 63.8563, GNorm = 0.3684, lr_0 = 1.2826e-04
Loss = 6.8047e-02, PNorm = 63.8761, GNorm = 0.4457, lr_0 = 1.2545e-04
Loss = 9.1348e-02, PNorm = 63.8887, GNorm = 0.5783, lr_0 = 1.2269e-04
Validation auc = 0.810762
Epoch 27
Loss = 8.8809e-02, PNorm = 63.9085, GNorm = 0.2574, lr_0 = 1.1973e-04
Loss = 5.3418e-02, PNorm = 63.9182, GNorm = 0.4481, lr_0 = 1.1709e-04
Loss = 6.0353e-02, PNorm = 63.9365, GNorm = 0.3893, lr_0 = 1.1452e-04
Loss = 6.9408e-02, PNorm = 63.9441, GNorm = 0.8324, lr_0 = 1.1200e-04
Validation auc = 0.817489
Epoch 28
Loss = 5.7666e-02, PNorm = 63.9639, GNorm = 0.6356, lr_0 = 1.0954e-04
Loss = 6.6806e-02, PNorm = 63.9793, GNorm = 0.4992, lr_0 = 1.0713e-04
Loss = 6.2679e-02, PNorm = 63.9940, GNorm = 0.3933, lr_0 = 1.0478e-04
Loss = 5.0264e-02, PNorm = 64.0107, GNorm = 0.8784, lr_0 = 1.0247e-04
Validation auc = 0.792377
Epoch 29
Loss = 5.3601e-02, PNorm = 64.0189, GNorm = 0.4289, lr_0 = 1.0000e-04
Loss = 5.8500e-02, PNorm = 64.0315, GNorm = 0.4092, lr_0 = 1.0000e-04
Loss = 4.5925e-02, PNorm = 64.0403, GNorm = 0.1906, lr_0 = 1.0000e-04
Loss = 5.5317e-02, PNorm = 64.0511, GNorm = 1.0692, lr_0 = 1.0000e-04
Loss = 3.4162e-03, PNorm = 64.0519, GNorm = 0.0907, lr_0 = 1.0000e-04
Validation auc = 0.821525
Model 2 best validation auc = 0.868610 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 2 test auc = 0.775802
Ensemble test auc = 0.763457
Fold 5
Splitting data with seed 5
Class sizes
hit 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 1,868 | val size = 233 | test size = 234
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 2.4502e-01, PNorm = 59.4444, GNorm = 0.7847, lr_0 = 2.3378e-04
Loss = 2.1429e-01, PNorm = 59.4658, GNorm = 0.6070, lr_0 = 3.5541e-04
Loss = 1.9884e-01, PNorm = 59.4940, GNorm = 0.3614, lr_0 = 4.7703e-04
Validation auc = 0.620968
Epoch 1
Loss = 1.3461e-01, PNorm = 59.5376, GNorm = 0.6286, lr_0 = 6.1081e-04
Loss = 2.2780e-01, PNorm = 59.5902, GNorm = 0.2922, lr_0 = 7.3243e-04
Loss = 1.5827e-01, PNorm = 59.6541, GNorm = 0.4820, lr_0 = 8.5405e-04
Loss = 1.9577e-01, PNorm = 59.7269, GNorm = 0.2744, lr_0 = 9.7568e-04
Validation auc = 0.783122
Epoch 2
Loss = 1.7309e-01, PNorm = 59.8119, GNorm = 0.2618, lr_0 = 9.8020e-04
Loss = 1.4529e-01, PNorm = 59.8929, GNorm = 0.3592, lr_0 = 9.5865e-04
Loss = 2.2746e-01, PNorm = 59.9737, GNorm = 0.4810, lr_0 = 9.3758e-04
Loss = 1.5796e-01, PNorm = 60.0982, GNorm = 0.1928, lr_0 = 9.1697e-04
Validation auc = 0.771601
Epoch 3
Loss = 2.1359e-01, PNorm = 60.1813, GNorm = 0.3535, lr_0 = 8.9681e-04
Loss = 1.8215e-01, PNorm = 60.2644, GNorm = 0.3661, lr_0 = 8.7710e-04
Loss = 1.8590e-01, PNorm = 60.3354, GNorm = 0.4953, lr_0 = 8.5782e-04
Validation auc = 0.799539
Epoch 4
Loss = 1.1521e-01, PNorm = 60.4038, GNorm = 0.2836, lr_0 = 8.3710e-04
Loss = 1.3755e-01, PNorm = 60.4466, GNorm = 0.6856, lr_0 = 8.1870e-04
Loss = 2.0825e-01, PNorm = 60.5036, GNorm = 0.3769, lr_0 = 8.0071e-04
Loss = 1.6712e-01, PNorm = 60.5798, GNorm = 0.5001, lr_0 = 7.8311e-04
Validation auc = 0.814804
Epoch 5
Loss = 1.0665e-01, PNorm = 60.6268, GNorm = 0.2836, lr_0 = 7.6420e-04
Loss = 1.7953e-01, PNorm = 60.6727, GNorm = 0.2395, lr_0 = 7.4740e-04
Loss = 1.3186e-01, PNorm = 60.7366, GNorm = 0.5256, lr_0 = 7.3097e-04
Loss = 1.5178e-01, PNorm = 60.7889, GNorm = 0.4487, lr_0 = 7.1490e-04
Validation auc = 0.825173
Epoch 6
Loss = 9.3662e-02, PNorm = 60.8429, GNorm = 0.3885, lr_0 = 6.9919e-04
Loss = 1.2192e-01, PNorm = 60.8929, GNorm = 0.2580, lr_0 = 6.8382e-04
Loss = 1.4925e-01, PNorm = 60.9332, GNorm = 0.2999, lr_0 = 6.6879e-04
Loss = 1.5207e-01, PNorm = 60.9908, GNorm = 0.3137, lr_0 = 6.5409e-04
Validation auc = 0.805876
Epoch 7
Loss = 1.2482e-01, PNorm = 61.0556, GNorm = 0.2970, lr_0 = 6.3829e-04
Loss = 1.4897e-01, PNorm = 61.1271, GNorm = 0.3372, lr_0 = 6.2426e-04
Loss = 1.6813e-01, PNorm = 61.1787, GNorm = 0.3076, lr_0 = 6.1054e-04
Validation auc = 0.859735
Epoch 8
Loss = 1.6353e-01, PNorm = 61.2497, GNorm = 0.2956, lr_0 = 5.9579e-04
Loss = 1.3923e-01, PNorm = 61.3080, GNorm = 0.7825, lr_0 = 5.8270e-04
Loss = 1.2734e-01, PNorm = 61.3771, GNorm = 0.2559, lr_0 = 5.6989e-04
Loss = 1.2991e-01, PNorm = 61.4204, GNorm = 0.8705, lr_0 = 5.5736e-04
Validation auc = 0.828053
Epoch 9
Loss = 1.1569e-01, PNorm = 61.4791, GNorm = 0.3086, lr_0 = 5.4511e-04
Loss = 9.7328e-02, PNorm = 61.5234, GNorm = 0.4245, lr_0 = 5.3313e-04
Loss = 1.1687e-01, PNorm = 61.5768, GNorm = 0.3656, lr_0 = 5.2141e-04
Loss = 1.6426e-01, PNorm = 61.6162, GNorm = 0.5713, lr_0 = 5.0995e-04
Validation auc = 0.856855
Epoch 10
Loss = 1.1706e-01, PNorm = 61.6951, GNorm = 0.4263, lr_0 = 4.9764e-04
Loss = 1.5041e-01, PNorm = 61.7399, GNorm = 0.3986, lr_0 = 4.8670e-04
Loss = 1.3445e-01, PNorm = 61.8075, GNorm = 0.3155, lr_0 = 4.7600e-04
Loss = 7.0618e-02, PNorm = 61.8643, GNorm = 0.1390, lr_0 = 4.6554e-04
Loss = 4.4184e-02, PNorm = 61.8703, GNorm = 0.4879, lr_0 = 4.6450e-04
Validation auc = 0.884217
Epoch 11
Loss = 1.6370e-01, PNorm = 61.8870, GNorm = 0.5979, lr_0 = 4.5429e-04
Loss = 1.2744e-01, PNorm = 61.9467, GNorm = 0.4787, lr_0 = 4.4431e-04
Loss = 1.1967e-01, PNorm = 62.0012, GNorm = 0.3054, lr_0 = 4.3454e-04
Validation auc = 0.880472
Epoch 12
Loss = 1.1576e-01, PNorm = 62.0601, GNorm = 0.7615, lr_0 = 4.2499e-04
Loss = 1.1101e-01, PNorm = 62.0899, GNorm = 0.3259, lr_0 = 4.1565e-04
Loss = 1.2356e-01, PNorm = 62.1247, GNorm = 0.2528, lr_0 = 4.0651e-04
Loss = 8.2155e-02, PNorm = 62.1684, GNorm = 0.3262, lr_0 = 3.9758e-04
Validation auc = 0.872984
Epoch 13
Loss = 1.2110e-01, PNorm = 62.2102, GNorm = 0.2358, lr_0 = 3.8797e-04
Loss = 6.4931e-02, PNorm = 62.2692, GNorm = 0.2184, lr_0 = 3.7945e-04
Loss = 1.2510e-01, PNorm = 62.3046, GNorm = 0.5133, lr_0 = 3.7111e-04
Loss = 1.0165e-01, PNorm = 62.3623, GNorm = 0.1938, lr_0 = 3.6295e-04
Validation auc = 0.893145
Epoch 14
Loss = 9.9152e-02, PNorm = 62.3985, GNorm = 0.3697, lr_0 = 3.5497e-04
Loss = 8.4010e-02, PNorm = 62.4391, GNorm = 0.1660, lr_0 = 3.4717e-04
Loss = 1.0771e-01, PNorm = 62.4819, GNorm = 0.3549, lr_0 = 3.3954e-04
Loss = 8.8254e-02, PNorm = 62.5258, GNorm = 0.3980, lr_0 = 3.3207e-04
Loss = 1.8308e-02, PNorm = 62.5305, GNorm = 0.2975, lr_0 = 3.3134e-04
Validation auc = 0.891129
Epoch 15
Loss = 1.0235e-01, PNorm = 62.5696, GNorm = 0.1648, lr_0 = 3.2405e-04
Loss = 6.9120e-02, PNorm = 62.6076, GNorm = 0.1701, lr_0 = 3.1693e-04
Loss = 8.4330e-02, PNorm = 62.6456, GNorm = 0.3205, lr_0 = 3.0997e-04
Validation auc = 0.891705
Epoch 16
Loss = 5.7270e-02, PNorm = 62.6829, GNorm = 0.3106, lr_0 = 3.0248e-04
Loss = 8.4377e-02, PNorm = 62.7155, GNorm = 0.6613, lr_0 = 2.9583e-04
Loss = 1.0033e-01, PNorm = 62.7441, GNorm = 0.4545, lr_0 = 2.8933e-04
Loss = 9.6706e-02, PNorm = 62.7883, GNorm = 0.5176, lr_0 = 2.8297e-04
Validation auc = 0.894297
Epoch 17
Loss = 4.3822e-02, PNorm = 62.8148, GNorm = 0.4024, lr_0 = 2.7675e-04
Loss = 7.9076e-02, PNorm = 62.8456, GNorm = 0.2310, lr_0 = 2.7067e-04
Loss = 7.2338e-02, PNorm = 62.8740, GNorm = 0.2917, lr_0 = 2.6472e-04
Loss = 8.1288e-02, PNorm = 62.8987, GNorm = 0.3267, lr_0 = 2.5890e-04
Validation auc = 0.885081
Epoch 18
Loss = 8.2835e-02, PNorm = 62.9320, GNorm = 0.2210, lr_0 = 2.5264e-04
Loss = 6.8088e-02, PNorm = 62.9790, GNorm = 0.3829, lr_0 = 2.4709e-04
Loss = 9.5371e-02, PNorm = 63.0024, GNorm = 0.2511, lr_0 = 2.4166e-04
Validation auc = 0.893721
Epoch 19
Loss = 1.5835e-02, PNorm = 63.0410, GNorm = 0.2173, lr_0 = 2.3582e-04
Loss = 8.0241e-02, PNorm = 63.0656, GNorm = 0.4622, lr_0 = 2.3064e-04
Loss = 5.7570e-02, PNorm = 63.0959, GNorm = 0.4413, lr_0 = 2.2557e-04
Loss = 7.7751e-02, PNorm = 63.1300, GNorm = 0.4956, lr_0 = 2.2061e-04
Validation auc = 0.894585
Epoch 20
Loss = 1.1018e-01, PNorm = 63.1520, GNorm = 0.9049, lr_0 = 2.1576e-04
Loss = 7.7928e-02, PNorm = 63.1956, GNorm = 0.3408, lr_0 = 2.1102e-04
Loss = 6.7134e-02, PNorm = 63.2231, GNorm = 0.4195, lr_0 = 2.0638e-04
Loss = 4.7698e-02, PNorm = 63.2576, GNorm = 0.3145, lr_0 = 2.0185e-04
Validation auc = 0.888537
Epoch 21
Loss = 5.7971e-02, PNorm = 63.2802, GNorm = 1.0881, lr_0 = 1.9697e-04
Loss = 6.6222e-02, PNorm = 63.3054, GNorm = 1.3219, lr_0 = 1.9264e-04
Loss = 7.5036e-02, PNorm = 63.3270, GNorm = 0.3184, lr_0 = 1.8841e-04
Loss = 4.6432e-02, PNorm = 63.3640, GNorm = 0.1273, lr_0 = 1.8427e-04
Validation auc = 0.891993
Epoch 22
Loss = 4.3261e-02, PNorm = 63.3849, GNorm = 0.2436, lr_0 = 1.7982e-04
Loss = 6.0601e-02, PNorm = 63.4034, GNorm = 0.6079, lr_0 = 1.7586e-04
Loss = 5.2648e-02, PNorm = 63.4215, GNorm = 0.3582, lr_0 = 1.7200e-04
Validation auc = 0.890841
Epoch 23
Loss = 5.0478e-02, PNorm = 63.4416, GNorm = 0.3764, lr_0 = 1.6822e-04
Loss = 4.0482e-02, PNorm = 63.4626, GNorm = 0.1662, lr_0 = 1.6452e-04
Loss = 6.2743e-02, PNorm = 63.4802, GNorm = 1.0737, lr_0 = 1.6090e-04
Loss = 7.2514e-02, PNorm = 63.5047, GNorm = 0.3628, lr_0 = 1.5737e-04
Validation auc = 0.886521
Epoch 24
Loss = 5.0041e-02, PNorm = 63.5261, GNorm = 0.2270, lr_0 = 1.5357e-04
Loss = 4.3055e-02, PNorm = 63.5507, GNorm = 0.2740, lr_0 = 1.5019e-04
Loss = 5.5866e-02, PNorm = 63.5671, GNorm = 0.6588, lr_0 = 1.4689e-04
Loss = 5.8156e-02, PNorm = 63.5855, GNorm = 0.2541, lr_0 = 1.4366e-04
Validation auc = 0.892857
Epoch 25
Loss = 3.4497e-02, PNorm = 63.6051, GNorm = 0.2124, lr_0 = 1.4050e-04
Loss = 3.7649e-02, PNorm = 63.6229, GNorm = 0.5879, lr_0 = 1.3741e-04
Loss = 6.5804e-02, PNorm = 63.6359, GNorm = 0.4581, lr_0 = 1.3439e-04
Loss = 5.5183e-02, PNorm = 63.6532, GNorm = 0.9030, lr_0 = 1.3144e-04
Validation auc = 0.885369
Epoch 26
Loss = 4.7746e-02, PNorm = 63.6698, GNorm = 0.3726, lr_0 = 1.2826e-04
Loss = 5.8286e-02, PNorm = 63.6980, GNorm = 1.3150, lr_0 = 1.2545e-04
Loss = 4.7315e-02, PNorm = 63.7093, GNorm = 0.7027, lr_0 = 1.2269e-04
Validation auc = 0.895449
Epoch 27
Loss = 3.2700e-02, PNorm = 63.7298, GNorm = 0.2734, lr_0 = 1.1973e-04
Loss = 4.4108e-02, PNorm = 63.7451, GNorm = 0.2906, lr_0 = 1.1709e-04
Loss = 2.9055e-02, PNorm = 63.7538, GNorm = 0.6586, lr_0 = 1.1452e-04
Loss = 5.9246e-02, PNorm = 63.7618, GNorm = 0.5058, lr_0 = 1.1200e-04
Validation auc = 0.886521
Epoch 28
Loss = 6.8573e-02, PNorm = 63.7799, GNorm = 0.9934, lr_0 = 1.0954e-04
Loss = 3.9918e-02, PNorm = 63.7947, GNorm = 0.6239, lr_0 = 1.0713e-04
Loss = 3.9633e-02, PNorm = 63.8082, GNorm = 0.3079, lr_0 = 1.0478e-04
Loss = 2.5405e-02, PNorm = 63.8216, GNorm = 0.0617, lr_0 = 1.0247e-04
Validation auc = 0.882776
Epoch 29
Loss = 5.8275e-02, PNorm = 63.8295, GNorm = 0.4634, lr_0 = 1.0000e-04
Loss = 4.3661e-02, PNorm = 63.8486, GNorm = 1.2854, lr_0 = 1.0000e-04
Loss = 2.0413e-02, PNorm = 63.8591, GNorm = 0.0354, lr_0 = 1.0000e-04
Loss = 5.5217e-02, PNorm = 63.8630, GNorm = 0.1879, lr_0 = 1.0000e-04
Loss = 4.3401e-02, PNorm = 63.8634, GNorm = 0.9941, lr_0 = 1.0000e-04
Validation auc = 0.894873
Model 0 best validation auc = 0.895449 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = 0.869955
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 3.3782e-01, PNorm = 59.4725, GNorm = 0.3933, lr_0 = 2.3378e-04
Loss = 2.3924e-01, PNorm = 59.5054, GNorm = 1.7863, lr_0 = 3.5541e-04
Loss = 2.0772e-01, PNorm = 59.5379, GNorm = 0.4696, lr_0 = 4.7703e-04
Validation auc = 0.806740
Epoch 1
Loss = 2.4139e-01, PNorm = 59.5742, GNorm = 0.3324, lr_0 = 6.1081e-04
Loss = 2.1865e-01, PNorm = 59.6037, GNorm = 0.9916, lr_0 = 7.3243e-04
Loss = 1.6736e-01, PNorm = 59.6369, GNorm = 0.3544, lr_0 = 8.5405e-04
Loss = 1.4011e-01, PNorm = 59.6850, GNorm = 0.2196, lr_0 = 9.7568e-04
Validation auc = 0.805876
Epoch 2
Loss = 1.6632e-01, PNorm = 59.7613, GNorm = 0.6608, lr_0 = 9.8020e-04
Loss = 1.8053e-01, PNorm = 59.8348, GNorm = 0.5187, lr_0 = 9.5865e-04
Loss = 2.0301e-01, PNorm = 59.8915, GNorm = 0.4241, lr_0 = 9.3758e-04
Loss = 1.9468e-01, PNorm = 59.9600, GNorm = 0.6468, lr_0 = 9.1697e-04
Validation auc = 0.827189
Epoch 3
Loss = 1.7957e-01, PNorm = 60.0070, GNorm = 0.3299, lr_0 = 8.9681e-04
Loss = 1.8919e-01, PNorm = 60.0653, GNorm = 0.3837, lr_0 = 8.7710e-04
Loss = 1.4043e-01, PNorm = 60.1361, GNorm = 0.2920, lr_0 = 8.5782e-04
Validation auc = 0.838134
Epoch 4
Loss = 1.8931e-01, PNorm = 60.1986, GNorm = 0.4476, lr_0 = 8.3710e-04
Loss = 1.6066e-01, PNorm = 60.2721, GNorm = 0.3153, lr_0 = 8.1870e-04
Loss = 1.7829e-01, PNorm = 60.3474, GNorm = 0.6129, lr_0 = 8.0071e-04
Loss = 1.5883e-01, PNorm = 60.4024, GNorm = 0.2327, lr_0 = 7.8311e-04
Validation auc = 0.852823
Epoch 5
Loss = 1.2149e-01, PNorm = 60.4804, GNorm = 0.4967, lr_0 = 7.6420e-04
Loss = 1.6812e-01, PNorm = 60.5550, GNorm = 0.2046, lr_0 = 7.4740e-04
Loss = 1.9118e-01, PNorm = 60.6370, GNorm = 0.8091, lr_0 = 7.3097e-04
Loss = 1.2851e-01, PNorm = 60.7431, GNorm = 1.2497, lr_0 = 7.1490e-04
Validation auc = 0.849078
Epoch 6
Loss = 1.5006e-01, PNorm = 60.7912, GNorm = 0.2877, lr_0 = 6.9919e-04
Loss = 1.2066e-01, PNorm = 60.8785, GNorm = 0.3221, lr_0 = 6.8382e-04
Loss = 1.3444e-01, PNorm = 60.9485, GNorm = 0.2507, lr_0 = 6.6879e-04
Loss = 1.8720e-01, PNorm = 60.9948, GNorm = 0.2999, lr_0 = 6.5409e-04
Validation auc = 0.834677
Epoch 7
Loss = 1.4702e-01, PNorm = 61.0576, GNorm = 0.2717, lr_0 = 6.3829e-04
Loss = 1.1763e-01, PNorm = 61.1170, GNorm = 0.3711, lr_0 = 6.2426e-04
Loss = 1.1702e-01, PNorm = 61.1722, GNorm = 0.5082, lr_0 = 6.1054e-04
Validation auc = 0.821429
Epoch 8
Loss = 1.1727e-01, PNorm = 61.2319, GNorm = 0.5928, lr_0 = 5.9579e-04
Loss = 1.2571e-01, PNorm = 61.2871, GNorm = 0.3533, lr_0 = 5.8270e-04
Loss = 1.1941e-01, PNorm = 61.3379, GNorm = 0.3068, lr_0 = 5.6989e-04
Loss = 1.0878e-01, PNorm = 61.3980, GNorm = 0.3520, lr_0 = 5.5736e-04
Validation auc = 0.839862
Epoch 9
Loss = 1.4747e-01, PNorm = 61.4565, GNorm = 0.7398, lr_0 = 5.4511e-04
Loss = 1.0946e-01, PNorm = 61.5178, GNorm = 0.4549, lr_0 = 5.3313e-04
Loss = 1.2430e-01, PNorm = 61.5739, GNorm = 0.6197, lr_0 = 5.2141e-04
Loss = 1.3555e-01, PNorm = 61.6331, GNorm = 0.3352, lr_0 = 5.0995e-04
Validation auc = 0.862903
Epoch 10
Loss = 8.3122e-02, PNorm = 61.6984, GNorm = 0.2682, lr_0 = 4.9764e-04
Loss = 1.2034e-01, PNorm = 61.7371, GNorm = 0.4120, lr_0 = 4.8670e-04
Loss = 1.1790e-01, PNorm = 61.7858, GNorm = 0.3036, lr_0 = 4.7600e-04
Loss = 1.4118e-01, PNorm = 61.8391, GNorm = 0.3470, lr_0 = 4.6554e-04
Loss = 4.1578e-02, PNorm = 61.8450, GNorm = 0.2989, lr_0 = 4.6450e-04
Validation auc = 0.841878
Epoch 11
Loss = 1.1431e-01, PNorm = 61.9006, GNorm = 0.2557, lr_0 = 4.5429e-04
Loss = 1.1552e-01, PNorm = 61.9410, GNorm = 0.1939, lr_0 = 4.4431e-04
Loss = 9.8882e-02, PNorm = 61.9910, GNorm = 0.5541, lr_0 = 4.3454e-04
Validation auc = 0.858295
Epoch 12
Loss = 1.0740e-01, PNorm = 62.0312, GNorm = 0.6890, lr_0 = 4.2499e-04
Loss = 1.5295e-01, PNorm = 62.0701, GNorm = 0.4261, lr_0 = 4.1565e-04
Loss = 1.0141e-01, PNorm = 62.1283, GNorm = 0.3608, lr_0 = 4.0651e-04
Loss = 1.2283e-01, PNorm = 62.1649, GNorm = 0.2639, lr_0 = 3.9758e-04
Validation auc = 0.859159
Epoch 13
Loss = 7.7747e-02, PNorm = 62.2190, GNorm = 0.3941, lr_0 = 3.8797e-04
Loss = 1.3435e-01, PNorm = 62.2521, GNorm = 0.4512, lr_0 = 3.7945e-04
Loss = 9.2781e-02, PNorm = 62.2863, GNorm = 0.1917, lr_0 = 3.7111e-04
Loss = 8.1158e-02, PNorm = 62.3178, GNorm = 0.4889, lr_0 = 3.6295e-04
Validation auc = 0.860023
Epoch 14
Loss = 8.8404e-02, PNorm = 62.3688, GNorm = 0.2207, lr_0 = 3.5497e-04
Loss = 1.0942e-01, PNorm = 62.4049, GNorm = 0.2763, lr_0 = 3.4717e-04
Loss = 9.5839e-02, PNorm = 62.4538, GNorm = 0.6251, lr_0 = 3.3954e-04
Loss = 1.2368e-01, PNorm = 62.4880, GNorm = 0.4176, lr_0 = 3.3207e-04
Loss = 7.1364e-02, PNorm = 62.4905, GNorm = 0.8579, lr_0 = 3.3134e-04
Validation auc = 0.868664
Epoch 15
Loss = 1.0352e-01, PNorm = 62.5276, GNorm = 0.5088, lr_0 = 3.2405e-04
Loss = 8.9434e-02, PNorm = 62.5556, GNorm = 0.2179, lr_0 = 3.1693e-04
Loss = 9.3115e-02, PNorm = 62.5964, GNorm = 0.9554, lr_0 = 3.0997e-04
Validation auc = 0.850806
Epoch 16
Loss = 1.2582e-01, PNorm = 62.6242, GNorm = 0.3307, lr_0 = 3.0248e-04
Loss = 6.3286e-02, PNorm = 62.6643, GNorm = 0.4530, lr_0 = 2.9583e-04
Loss = 1.0523e-01, PNorm = 62.6884, GNorm = 0.4953, lr_0 = 2.8933e-04
Loss = 9.1307e-02, PNorm = 62.7149, GNorm = 0.3931, lr_0 = 2.8297e-04
Validation auc = 0.867224
Epoch 17
Loss = 5.8583e-02, PNorm = 62.7453, GNorm = 0.5115, lr_0 = 2.7675e-04
Loss = 7.9707e-02, PNorm = 62.7729, GNorm = 0.1995, lr_0 = 2.7067e-04
Loss = 9.2919e-02, PNorm = 62.8002, GNorm = 1.1533, lr_0 = 2.6472e-04
Loss = 1.0793e-01, PNorm = 62.8296, GNorm = 0.1799, lr_0 = 2.5890e-04
Validation auc = 0.875000
Epoch 18
Loss = 9.6361e-02, PNorm = 62.8629, GNorm = 0.6358, lr_0 = 2.5264e-04
Loss = 7.9984e-02, PNorm = 62.9033, GNorm = 0.3091, lr_0 = 2.4709e-04
Loss = 6.0217e-02, PNorm = 62.9320, GNorm = 0.4349, lr_0 = 2.4166e-04
Validation auc = 0.869528
Epoch 19
Loss = 2.6531e-02, PNorm = 62.9537, GNorm = 0.2024, lr_0 = 2.3582e-04
Loss = 8.4785e-02, PNorm = 62.9800, GNorm = 0.5158, lr_0 = 2.3064e-04
Loss = 7.3187e-02, PNorm = 63.0066, GNorm = 0.3444, lr_0 = 2.2557e-04
Loss = 9.1560e-02, PNorm = 63.0249, GNorm = 0.7917, lr_0 = 2.2061e-04
Validation auc = 0.857431
Epoch 20
Loss = 8.3094e-02, PNorm = 63.0540, GNorm = 0.4495, lr_0 = 2.1576e-04
Loss = 8.1635e-02, PNorm = 63.0745, GNorm = 0.4721, lr_0 = 2.1102e-04
Loss = 6.9146e-02, PNorm = 63.1007, GNorm = 0.1330, lr_0 = 2.0638e-04
Loss = 8.3588e-02, PNorm = 63.1253, GNorm = 0.7751, lr_0 = 2.0185e-04
Validation auc = 0.858871
Epoch 21
Loss = 7.6910e-02, PNorm = 63.1448, GNorm = 0.3853, lr_0 = 1.9697e-04
Loss = 8.5395e-02, PNorm = 63.1651, GNorm = 0.5323, lr_0 = 1.9264e-04
Loss = 5.2301e-02, PNorm = 63.1897, GNorm = 0.1330, lr_0 = 1.8841e-04
Loss = 6.1295e-02, PNorm = 63.2088, GNorm = 1.2254, lr_0 = 1.8427e-04
Validation auc = 0.867224
Epoch 22
Loss = 7.4396e-02, PNorm = 63.2325, GNorm = 1.1078, lr_0 = 1.7982e-04
Loss = 6.0595e-02, PNorm = 63.2573, GNorm = 0.4677, lr_0 = 1.7586e-04
Loss = 6.9358e-02, PNorm = 63.2750, GNorm = 0.1758, lr_0 = 1.7200e-04
Validation auc = 0.851094
Epoch 23
Loss = 3.3762e-02, PNorm = 63.2933, GNorm = 0.2302, lr_0 = 1.6822e-04
Loss = 4.6528e-02, PNorm = 63.3132, GNorm = 0.4605, lr_0 = 1.6452e-04
Loss = 7.3996e-02, PNorm = 63.3296, GNorm = 0.7074, lr_0 = 1.6090e-04
Loss = 6.2882e-02, PNorm = 63.3448, GNorm = 0.5409, lr_0 = 1.5737e-04
Validation auc = 0.836982
Epoch 24
Loss = 1.5170e-02, PNorm = 63.3702, GNorm = 0.2232, lr_0 = 1.5357e-04
Loss = 6.3380e-02, PNorm = 63.3861, GNorm = 0.4587, lr_0 = 1.5019e-04
Loss = 6.7780e-02, PNorm = 63.4074, GNorm = 0.6459, lr_0 = 1.4689e-04
Loss = 5.4841e-02, PNorm = 63.4218, GNorm = 0.6203, lr_0 = 1.4366e-04
Validation auc = 0.847926
Epoch 25
Loss = 4.4161e-02, PNorm = 63.4396, GNorm = 0.3564, lr_0 = 1.4050e-04
Loss = 6.1651e-02, PNorm = 63.4614, GNorm = 0.3361, lr_0 = 1.3741e-04
Loss = 7.4304e-02, PNorm = 63.4783, GNorm = 1.0035, lr_0 = 1.3439e-04
Loss = 5.2359e-02, PNorm = 63.4912, GNorm = 0.5477, lr_0 = 1.3144e-04
Validation auc = 0.842742
Epoch 26
Loss = 5.9193e-02, PNorm = 63.5111, GNorm = 0.1946, lr_0 = 1.2826e-04
Loss = 5.3624e-02, PNorm = 63.5252, GNorm = 0.5159, lr_0 = 1.2545e-04
Loss = 5.3300e-02, PNorm = 63.5440, GNorm = 1.0762, lr_0 = 1.2269e-04
Validation auc = 0.837558
Epoch 27
Loss = 3.1032e-02, PNorm = 63.5530, GNorm = 0.1654, lr_0 = 1.1973e-04
Loss = 6.3339e-02, PNorm = 63.5730, GNorm = 0.5081, lr_0 = 1.1709e-04
Loss = 5.7476e-02, PNorm = 63.5884, GNorm = 0.6145, lr_0 = 1.1452e-04
Loss = 6.1327e-02, PNorm = 63.5947, GNorm = 0.3362, lr_0 = 1.1200e-04
Validation auc = 0.854839
Epoch 28
Loss = 4.1002e-02, PNorm = 63.6083, GNorm = 0.2199, lr_0 = 1.0954e-04
Loss = 6.1398e-02, PNorm = 63.6196, GNorm = 0.5722, lr_0 = 1.0713e-04
Loss = 4.3486e-02, PNorm = 63.6350, GNorm = 0.2811, lr_0 = 1.0478e-04
Loss = 2.7841e-02, PNorm = 63.6442, GNorm = 0.2030, lr_0 = 1.0247e-04
Validation auc = 0.844758
Epoch 29
Loss = 4.1801e-02, PNorm = 63.6550, GNorm = 0.5438, lr_0 = 1.0000e-04
Loss = 3.5069e-02, PNorm = 63.6632, GNorm = 0.7879, lr_0 = 1.0000e-04
Loss = 5.7232e-02, PNorm = 63.6727, GNorm = 0.2702, lr_0 = 1.0000e-04
Loss = 4.9958e-02, PNorm = 63.6828, GNorm = 0.1644, lr_0 = 1.0000e-04
Loss = 5.0023e-02, PNorm = 63.6846, GNorm = 1.8052, lr_0 = 1.0000e-04
Validation auc = 0.843318
Model 1 best validation auc = 0.875000 on epoch 17
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 1 test auc = 0.842234
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 2.4055e-01, PNorm = 59.4785, GNorm = 0.5354, lr_0 = 2.3378e-04
Loss = 2.1102e-01, PNorm = 59.5059, GNorm = 0.5211, lr_0 = 3.5541e-04
Loss = 2.3476e-01, PNorm = 59.5350, GNorm = 0.4201, lr_0 = 4.7703e-04
Validation auc = 0.776210
Epoch 1
Loss = 2.2668e-01, PNorm = 59.5778, GNorm = 0.3546, lr_0 = 6.1081e-04
Loss = 2.0574e-01, PNorm = 59.6259, GNorm = 0.4253, lr_0 = 7.3243e-04
Loss = 1.9426e-01, PNorm = 59.6879, GNorm = 0.4221, lr_0 = 8.5405e-04
Loss = 1.7928e-01, PNorm = 59.7528, GNorm = 0.3896, lr_0 = 9.7568e-04
Validation auc = 0.716014
Epoch 2
Loss = 2.1999e-01, PNorm = 59.8387, GNorm = 0.5165, lr_0 = 9.8020e-04
Loss = 1.6994e-01, PNorm = 59.9162, GNorm = 0.2746, lr_0 = 9.5865e-04
Loss = 1.8150e-01, PNorm = 59.9655, GNorm = 0.3040, lr_0 = 9.3758e-04
Loss = 1.7590e-01, PNorm = 60.0272, GNorm = 0.3495, lr_0 = 9.1697e-04
Validation auc = 0.799539
Epoch 3
Loss = 1.5207e-01, PNorm = 60.0971, GNorm = 0.2991, lr_0 = 8.9681e-04
Loss = 2.4236e-01, PNorm = 60.1545, GNorm = 0.3883, lr_0 = 8.7710e-04
Loss = 1.5236e-01, PNorm = 60.2317, GNorm = 0.5587, lr_0 = 8.5782e-04
Validation auc = 0.790611
Epoch 4
Loss = 1.8638e-01, PNorm = 60.2815, GNorm = 0.2426, lr_0 = 8.3710e-04
Loss = 1.7662e-01, PNorm = 60.3324, GNorm = 0.3060, lr_0 = 8.1870e-04
Loss = 1.6698e-01, PNorm = 60.3967, GNorm = 0.2350, lr_0 = 8.0071e-04
Loss = 1.6602e-01, PNorm = 60.4641, GNorm = 0.3472, lr_0 = 7.8311e-04
Validation auc = 0.808756
Epoch 5
Loss = 1.1413e-01, PNorm = 60.5591, GNorm = 0.1632, lr_0 = 7.6420e-04
Loss = 1.6492e-01, PNorm = 60.6224, GNorm = 0.3371, lr_0 = 7.4740e-04
Loss = 1.5369e-01, PNorm = 60.7170, GNorm = 0.2066, lr_0 = 7.3097e-04
Loss = 1.5947e-01, PNorm = 60.8046, GNorm = 0.8057, lr_0 = 7.1490e-04
Validation auc = 0.808756
Epoch 6
Loss = 1.5680e-01, PNorm = 60.8936, GNorm = 0.3435, lr_0 = 6.9919e-04
Loss = 1.1284e-01, PNorm = 60.9780, GNorm = 0.5446, lr_0 = 6.8382e-04
Loss = 1.4672e-01, PNorm = 61.0536, GNorm = 0.5990, lr_0 = 6.6879e-04
Loss = 1.5604e-01, PNorm = 61.1170, GNorm = 0.7010, lr_0 = 6.5409e-04
Validation auc = 0.844758
Epoch 7
Loss = 1.0978e-01, PNorm = 61.2217, GNorm = 0.4929, lr_0 = 6.3829e-04
Loss = 1.2796e-01, PNorm = 61.3176, GNorm = 0.2307, lr_0 = 6.2426e-04
Loss = 1.3414e-01, PNorm = 61.3869, GNorm = 0.2648, lr_0 = 6.1054e-04
Validation auc = 0.867512
Epoch 8
Loss = 1.1015e-01, PNorm = 61.4641, GNorm = 0.4898, lr_0 = 5.9579e-04
Loss = 1.1850e-01, PNorm = 61.5408, GNorm = 0.1996, lr_0 = 5.8270e-04
Loss = 1.3573e-01, PNorm = 61.6058, GNorm = 0.5120, lr_0 = 5.6989e-04
Loss = 1.4323e-01, PNorm = 61.6790, GNorm = 0.5117, lr_0 = 5.5736e-04
Validation auc = 0.877592
Epoch 9
Loss = 1.0901e-01, PNorm = 61.7386, GNorm = 0.4106, lr_0 = 5.4511e-04
Loss = 1.0533e-01, PNorm = 61.8076, GNorm = 0.4240, lr_0 = 5.3313e-04
Loss = 1.3451e-01, PNorm = 61.8728, GNorm = 0.2820, lr_0 = 5.2141e-04
Loss = 1.1575e-01, PNorm = 61.9373, GNorm = 0.3581, lr_0 = 5.0995e-04
Validation auc = 0.864343
Epoch 10
Loss = 1.3291e-01, PNorm = 62.0129, GNorm = 0.1951, lr_0 = 4.9764e-04
Loss = 1.1382e-01, PNorm = 62.0718, GNorm = 0.4892, lr_0 = 4.8670e-04
Loss = 1.0536e-01, PNorm = 62.1143, GNorm = 0.4455, lr_0 = 4.7600e-04
Loss = 1.1599e-01, PNorm = 62.1596, GNorm = 0.3274, lr_0 = 4.6554e-04
Loss = 4.1650e-02, PNorm = 62.1656, GNorm = 0.4833, lr_0 = 4.6450e-04
Validation auc = 0.860311
Epoch 11
Loss = 9.1906e-02, PNorm = 62.2241, GNorm = 0.5317, lr_0 = 4.5429e-04
Loss = 1.1762e-01, PNorm = 62.2823, GNorm = 0.7904, lr_0 = 4.4431e-04
Loss = 1.0360e-01, PNorm = 62.3285, GNorm = 0.4334, lr_0 = 4.3454e-04
Validation auc = 0.878456
Epoch 12
Loss = 8.9217e-02, PNorm = 62.3673, GNorm = 0.3466, lr_0 = 4.2499e-04
Loss = 9.3360e-02, PNorm = 62.4094, GNorm = 0.4187, lr_0 = 4.1565e-04
Loss = 1.2131e-01, PNorm = 62.4618, GNorm = 0.4653, lr_0 = 4.0651e-04
Loss = 6.8251e-02, PNorm = 62.5037, GNorm = 0.1820, lr_0 = 3.9758e-04
Validation auc = 0.878744
Epoch 13
Loss = 6.2399e-02, PNorm = 62.5546, GNorm = 0.2187, lr_0 = 3.8797e-04
Loss = 1.1556e-01, PNorm = 62.5968, GNorm = 0.4650, lr_0 = 3.7945e-04
Loss = 1.0121e-01, PNorm = 62.6434, GNorm = 0.3139, lr_0 = 3.7111e-04
Loss = 8.5747e-02, PNorm = 62.6904, GNorm = 0.4376, lr_0 = 3.6295e-04
Validation auc = 0.880472
Epoch 14
Loss = 1.1480e-01, PNorm = 62.7287, GNorm = 0.3580, lr_0 = 3.5497e-04
Loss = 7.1953e-02, PNorm = 62.7780, GNorm = 0.3526, lr_0 = 3.4717e-04
Loss = 6.9835e-02, PNorm = 62.8175, GNorm = 0.3382, lr_0 = 3.3954e-04
Loss = 1.2358e-01, PNorm = 62.8475, GNorm = 1.3674, lr_0 = 3.3207e-04
Loss = 2.3349e-02, PNorm = 62.8529, GNorm = 0.3060, lr_0 = 3.3134e-04
Validation auc = 0.872696
Epoch 15
Loss = 8.0036e-02, PNorm = 62.9042, GNorm = 0.4260, lr_0 = 3.2405e-04
Loss = 8.3800e-02, PNorm = 62.9439, GNorm = 0.2400, lr_0 = 3.1693e-04
Loss = 8.2440e-02, PNorm = 62.9967, GNorm = 0.5272, lr_0 = 3.0997e-04
Validation auc = 0.901786
Epoch 16
Loss = 1.2055e-01, PNorm = 63.0217, GNorm = 0.3102, lr_0 = 3.0248e-04
Loss = 5.4337e-02, PNorm = 63.0670, GNorm = 0.2199, lr_0 = 2.9583e-04
Loss = 8.3912e-02, PNorm = 63.1044, GNorm = 1.1853, lr_0 = 2.8933e-04
Loss = 9.3534e-02, PNorm = 63.1250, GNorm = 0.4029, lr_0 = 2.8297e-04
Validation auc = 0.879320
Epoch 17
Loss = 7.6077e-02, PNorm = 63.1602, GNorm = 0.4108, lr_0 = 2.7675e-04
Loss = 9.9831e-02, PNorm = 63.2019, GNorm = 0.4705, lr_0 = 2.7067e-04
Loss = 7.2944e-02, PNorm = 63.2380, GNorm = 0.4223, lr_0 = 2.6472e-04
Loss = 7.3363e-02, PNorm = 63.2670, GNorm = 0.4347, lr_0 = 2.5890e-04
Validation auc = 0.880472
Epoch 18
Loss = 9.3934e-02, PNorm = 63.2969, GNorm = 0.8971, lr_0 = 2.5264e-04
Loss = 7.3189e-02, PNorm = 63.3349, GNorm = 0.5647, lr_0 = 2.4709e-04
Loss = 9.4207e-02, PNorm = 63.3449, GNorm = 0.5802, lr_0 = 2.4166e-04
Validation auc = 0.887673
Epoch 19
Loss = 5.8146e-02, PNorm = 63.3855, GNorm = 0.6178, lr_0 = 2.3582e-04
Loss = 8.3977e-02, PNorm = 63.4136, GNorm = 0.2945, lr_0 = 2.3064e-04
Loss = 7.1151e-02, PNorm = 63.4429, GNorm = 0.4904, lr_0 = 2.2557e-04
Loss = 7.9611e-02, PNorm = 63.4699, GNorm = 0.4016, lr_0 = 2.2061e-04
Validation auc = 0.894297
Epoch 20
Loss = 9.4878e-02, PNorm = 63.4989, GNorm = 0.8565, lr_0 = 2.1576e-04
Loss = 8.1590e-02, PNorm = 63.5208, GNorm = 0.5628, lr_0 = 2.1102e-04
Loss = 8.7470e-02, PNorm = 63.5448, GNorm = 0.3328, lr_0 = 2.0638e-04
Loss = 4.5737e-02, PNorm = 63.5752, GNorm = 0.7704, lr_0 = 2.0185e-04
Validation auc = 0.889401
Epoch 21
Loss = 6.0249e-02, PNorm = 63.5989, GNorm = 0.2553, lr_0 = 1.9697e-04
Loss = 7.4338e-02, PNorm = 63.6236, GNorm = 0.4295, lr_0 = 1.9264e-04
Loss = 5.8064e-02, PNorm = 63.6446, GNorm = 0.7127, lr_0 = 1.8841e-04
Loss = 5.9154e-02, PNorm = 63.6738, GNorm = 0.1572, lr_0 = 1.8427e-04
Validation auc = 0.887673
Epoch 22
Loss = 5.5294e-02, PNorm = 63.6950, GNorm = 0.5517, lr_0 = 1.7982e-04
Loss = 6.9911e-02, PNorm = 63.7287, GNorm = 0.4829, lr_0 = 1.7586e-04
Loss = 6.3716e-02, PNorm = 63.7485, GNorm = 0.5545, lr_0 = 1.7200e-04
Validation auc = 0.889401
Epoch 23
Loss = 7.2727e-02, PNorm = 63.7743, GNorm = 0.4340, lr_0 = 1.6822e-04
Loss = 3.7777e-02, PNorm = 63.7988, GNorm = 0.2213, lr_0 = 1.6452e-04
Loss = 6.5516e-02, PNorm = 63.8137, GNorm = 0.4720, lr_0 = 1.6090e-04
Loss = 7.1763e-02, PNorm = 63.8365, GNorm = 0.6849, lr_0 = 1.5737e-04
Validation auc = 0.891705
Epoch 24
Loss = 7.4449e-02, PNorm = 63.8550, GNorm = 0.1902, lr_0 = 1.5357e-04
Loss = 5.4909e-02, PNorm = 63.8842, GNorm = 0.2174, lr_0 = 1.5019e-04
Loss = 5.3231e-02, PNorm = 63.9059, GNorm = 0.1529, lr_0 = 1.4689e-04
Loss = 5.5720e-02, PNorm = 63.9174, GNorm = 0.3691, lr_0 = 1.4366e-04
Validation auc = 0.889977
Epoch 25
Loss = 5.6014e-02, PNorm = 63.9312, GNorm = 0.1676, lr_0 = 1.4050e-04
Loss = 3.2233e-02, PNorm = 63.9511, GNorm = 0.2946, lr_0 = 1.3741e-04
Loss = 5.6818e-02, PNorm = 63.9672, GNorm = 0.1988, lr_0 = 1.3439e-04
Loss = 5.4851e-02, PNorm = 63.9859, GNorm = 1.2506, lr_0 = 1.3144e-04
Validation auc = 0.891993
Epoch 26
Loss = 6.3467e-02, PNorm = 64.0076, GNorm = 0.4450, lr_0 = 1.2826e-04
Loss = 5.1836e-02, PNorm = 64.0272, GNorm = 0.0773, lr_0 = 1.2545e-04
Loss = 3.8561e-02, PNorm = 64.0408, GNorm = 0.5920, lr_0 = 1.2269e-04
Validation auc = 0.889977
Epoch 27
Loss = 4.3194e-02, PNorm = 64.0526, GNorm = 0.8174, lr_0 = 1.1973e-04
Loss = 4.4309e-02, PNorm = 64.0734, GNorm = 0.6800, lr_0 = 1.1709e-04
Loss = 4.7430e-02, PNorm = 64.0805, GNorm = 0.8361, lr_0 = 1.1452e-04
Loss = 5.0590e-02, PNorm = 64.0921, GNorm = 0.6832, lr_0 = 1.1200e-04
Validation auc = 0.887961
Epoch 28
Loss = 2.7437e-02, PNorm = 64.1079, GNorm = 0.1779, lr_0 = 1.0954e-04
Loss = 4.1016e-02, PNorm = 64.1228, GNorm = 0.3647, lr_0 = 1.0713e-04
Loss = 6.1961e-02, PNorm = 64.1352, GNorm = 0.1772, lr_0 = 1.0478e-04
Loss = 4.1089e-02, PNorm = 64.1453, GNorm = 0.6532, lr_0 = 1.0247e-04
Validation auc = 0.886233
Epoch 29
Loss = 2.3931e-02, PNorm = 64.1587, GNorm = 0.1101, lr_0 = 1.0000e-04
Loss = 4.3672e-02, PNorm = 64.1677, GNorm = 0.7385, lr_0 = 1.0000e-04
Loss = 4.4256e-02, PNorm = 64.1834, GNorm = 0.9232, lr_0 = 1.0000e-04
Loss = 4.2799e-02, PNorm = 64.1933, GNorm = 0.8638, lr_0 = 1.0000e-04
Loss = 9.3175e-03, PNorm = 64.1939, GNorm = 0.1933, lr_0 = 1.0000e-04
Validation auc = 0.892857
Model 2 best validation auc = 0.901786 on epoch 15
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 2 test auc = 0.816551
Ensemble test auc = 0.843457
Fold 6
Splitting data with seed 6
Class sizes
hit 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 1,868 | val size = 233 | test size = 234
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 3.0774e-01, PNorm = 59.4443, GNorm = 0.4430, lr_0 = 2.3378e-04
Loss = 2.5210e-01, PNorm = 59.4717, GNorm = 0.2824, lr_0 = 3.5541e-04
Loss = 1.9419e-01, PNorm = 59.5009, GNorm = 0.4086, lr_0 = 4.7703e-04
Validation auc = 0.666014
Epoch 1
Loss = 2.5860e-01, PNorm = 59.5366, GNorm = 0.2726, lr_0 = 6.1081e-04
Loss = 1.8327e-01, PNorm = 59.5750, GNorm = 0.2948, lr_0 = 7.3243e-04
Loss = 1.8577e-01, PNorm = 59.6194, GNorm = 0.3860, lr_0 = 8.5405e-04
Loss = 1.9716e-01, PNorm = 59.6832, GNorm = 0.5936, lr_0 = 9.7568e-04
Validation auc = 0.637639
Epoch 2
Loss = 1.8443e-01, PNorm = 59.7724, GNorm = 0.3077, lr_0 = 9.8020e-04
Loss = 1.7986e-01, PNorm = 59.8549, GNorm = 0.3578, lr_0 = 9.5865e-04
Loss = 1.8543e-01, PNorm = 59.9450, GNorm = 0.3855, lr_0 = 9.3758e-04
Loss = 1.8052e-01, PNorm = 60.0322, GNorm = 0.5300, lr_0 = 9.1697e-04
Validation auc = 0.661122
Epoch 3
Loss = 1.8852e-01, PNorm = 60.0984, GNorm = 0.3069, lr_0 = 8.9681e-04
Loss = 1.7886e-01, PNorm = 60.1780, GNorm = 1.0905, lr_0 = 8.7710e-04
Loss = 1.3700e-01, PNorm = 60.2611, GNorm = 0.6143, lr_0 = 8.5782e-04
Validation auc = 0.650033
Epoch 4
Loss = 1.4182e-01, PNorm = 60.3376, GNorm = 0.2598, lr_0 = 8.3710e-04
Loss = 1.6071e-01, PNorm = 60.4161, GNorm = 0.6263, lr_0 = 8.1870e-04
Loss = 1.4837e-01, PNorm = 60.5049, GNorm = 2.0361, lr_0 = 8.0071e-04
Loss = 1.3001e-01, PNorm = 60.5887, GNorm = 0.3573, lr_0 = 7.8311e-04
Validation auc = 0.625571
Epoch 5
Loss = 1.5980e-01, PNorm = 60.7117, GNorm = 0.2222, lr_0 = 7.6420e-04
Loss = 1.4021e-01, PNorm = 60.7763, GNorm = 0.4671, lr_0 = 7.4740e-04
Loss = 1.5134e-01, PNorm = 60.8344, GNorm = 0.8803, lr_0 = 7.3097e-04
Loss = 1.4776e-01, PNorm = 60.9012, GNorm = 0.4416, lr_0 = 7.1490e-04
Validation auc = 0.648076
Epoch 6
Loss = 9.8043e-02, PNorm = 60.9408, GNorm = 0.9096, lr_0 = 6.9919e-04
Loss = 1.5543e-01, PNorm = 60.9859, GNorm = 0.2590, lr_0 = 6.8382e-04
Loss = 1.2401e-01, PNorm = 61.0446, GNorm = 0.2542, lr_0 = 6.6879e-04
Loss = 1.4733e-01, PNorm = 61.1032, GNorm = 0.4246, lr_0 = 6.5409e-04
Validation auc = 0.666993
Epoch 7
Loss = 1.5197e-01, PNorm = 61.1572, GNorm = 0.5497, lr_0 = 6.3829e-04
Loss = 1.3680e-01, PNorm = 61.2371, GNorm = 0.4894, lr_0 = 6.2426e-04
Loss = 1.1882e-01, PNorm = 61.3073, GNorm = 0.2998, lr_0 = 6.1054e-04
Validation auc = 0.621983
Epoch 8
Loss = 7.9054e-02, PNorm = 61.3694, GNorm = 0.3809, lr_0 = 5.9579e-04
Loss = 1.2117e-01, PNorm = 61.4189, GNorm = 0.4966, lr_0 = 5.8270e-04
Loss = 1.4260e-01, PNorm = 61.4841, GNorm = 0.8280, lr_0 = 5.6989e-04
Loss = 1.2990e-01, PNorm = 61.5381, GNorm = 0.3234, lr_0 = 5.5736e-04
Validation auc = 0.666993
Epoch 9
Loss = 9.2347e-02, PNorm = 61.6121, GNorm = 0.5817, lr_0 = 5.4511e-04
Loss = 1.4371e-01, PNorm = 61.6771, GNorm = 0.7746, lr_0 = 5.3313e-04
Loss = 9.3689e-02, PNorm = 61.7505, GNorm = 0.6534, lr_0 = 5.2141e-04
Loss = 8.5783e-02, PNorm = 61.8139, GNorm = 0.2542, lr_0 = 5.0995e-04
Validation auc = 0.698304
Epoch 10
Loss = 7.1568e-02, PNorm = 61.8897, GNorm = 0.1799, lr_0 = 4.9764e-04
Loss = 1.2700e-01, PNorm = 61.9288, GNorm = 0.2551, lr_0 = 4.8670e-04
Loss = 1.3250e-01, PNorm = 62.0023, GNorm = 0.6952, lr_0 = 4.7600e-04
Loss = 8.8457e-02, PNorm = 62.0560, GNorm = 0.4398, lr_0 = 4.6554e-04
Loss = 5.9706e-02, PNorm = 62.0627, GNorm = 0.4088, lr_0 = 4.6450e-04
Validation auc = 0.730594
Epoch 11
Loss = 8.3605e-02, PNorm = 62.1408, GNorm = 0.5599, lr_0 = 4.5429e-04
Loss = 1.5289e-01, PNorm = 62.1880, GNorm = 0.3707, lr_0 = 4.4431e-04
Loss = 1.0387e-01, PNorm = 62.2809, GNorm = 0.3394, lr_0 = 4.3454e-04
Validation auc = 0.731246
Epoch 12
Loss = 1.3149e-01, PNorm = 62.3315, GNorm = 0.3200, lr_0 = 4.2499e-04
Loss = 7.5698e-02, PNorm = 62.3889, GNorm = 0.1914, lr_0 = 4.1565e-04
Loss = 8.9640e-02, PNorm = 62.4350, GNorm = 0.3979, lr_0 = 4.0651e-04
Loss = 9.9186e-02, PNorm = 62.4794, GNorm = 0.2835, lr_0 = 3.9758e-04
Validation auc = 0.719830
Epoch 13
Loss = 1.1197e-01, PNorm = 62.5284, GNorm = 0.4939, lr_0 = 3.8797e-04
Loss = 5.7499e-02, PNorm = 62.6030, GNorm = 0.4753, lr_0 = 3.7945e-04
Loss = 9.3356e-02, PNorm = 62.6421, GNorm = 0.3235, lr_0 = 3.7111e-04
Loss = 1.1648e-01, PNorm = 62.6859, GNorm = 0.4976, lr_0 = 3.6295e-04
Validation auc = 0.727006
Epoch 14
Loss = 8.6647e-02, PNorm = 62.7328, GNorm = 0.3084, lr_0 = 3.5497e-04
Loss = 9.3729e-02, PNorm = 62.7811, GNorm = 0.6588, lr_0 = 3.4717e-04
Loss = 6.6064e-02, PNorm = 62.8193, GNorm = 0.4218, lr_0 = 3.3954e-04
Loss = 7.8251e-02, PNorm = 62.8582, GNorm = 0.6160, lr_0 = 3.3207e-04
Loss = 1.4738e-01, PNorm = 62.8630, GNorm = 1.2432, lr_0 = 3.3134e-04
Validation auc = 0.709393
Epoch 15
Loss = 9.1303e-02, PNorm = 62.9134, GNorm = 0.4130, lr_0 = 3.2405e-04
Loss = 8.2921e-02, PNorm = 62.9667, GNorm = 1.5174, lr_0 = 3.1693e-04
Loss = 7.2696e-02, PNorm = 63.0249, GNorm = 0.3364, lr_0 = 3.0997e-04
Validation auc = 0.742009
Epoch 16
Loss = 4.4229e-02, PNorm = 63.0763, GNorm = 0.4529, lr_0 = 3.0248e-04
Loss = 8.0628e-02, PNorm = 63.1259, GNorm = 0.6430, lr_0 = 2.9583e-04
Loss = 7.9531e-02, PNorm = 63.1803, GNorm = 0.6774, lr_0 = 2.8933e-04
Loss = 7.8117e-02, PNorm = 63.2035, GNorm = 0.9576, lr_0 = 2.8297e-04
Validation auc = 0.729615
Epoch 17
Loss = 4.3108e-02, PNorm = 63.2358, GNorm = 0.2842, lr_0 = 2.7675e-04
Loss = 7.2433e-02, PNorm = 63.2683, GNorm = 0.4891, lr_0 = 2.7067e-04
Loss = 6.9144e-02, PNorm = 63.3016, GNorm = 0.4614, lr_0 = 2.6472e-04
Loss = 5.0899e-02, PNorm = 63.3347, GNorm = 0.7544, lr_0 = 2.5890e-04
Validation auc = 0.744945
Epoch 18
Loss = 7.6333e-02, PNorm = 63.3648, GNorm = 0.3794, lr_0 = 2.5264e-04
Loss = 5.5329e-02, PNorm = 63.4025, GNorm = 0.2350, lr_0 = 2.4709e-04
Loss = 6.9854e-02, PNorm = 63.4373, GNorm = 0.5126, lr_0 = 2.4166e-04
Validation auc = 0.744945
Epoch 19
Loss = 3.7857e-02, PNorm = 63.4821, GNorm = 0.3674, lr_0 = 2.3582e-04
Loss = 5.1891e-02, PNorm = 63.5171, GNorm = 1.2240, lr_0 = 2.3064e-04
Loss = 4.2698e-02, PNorm = 63.5345, GNorm = 0.2886, lr_0 = 2.2557e-04
Loss = 4.8605e-02, PNorm = 63.5672, GNorm = 0.6770, lr_0 = 2.2061e-04
Validation auc = 0.706784
Epoch 20
Loss = 3.5460e-02, PNorm = 63.5944, GNorm = 0.4816, lr_0 = 2.1576e-04
Loss = 4.9456e-02, PNorm = 63.6315, GNorm = 0.2715, lr_0 = 2.1102e-04
Loss = 6.5301e-02, PNorm = 63.6608, GNorm = 0.3757, lr_0 = 2.0638e-04
Loss = 5.8870e-02, PNorm = 63.6901, GNorm = 0.4407, lr_0 = 2.0185e-04
Validation auc = 0.739726
Epoch 21
Loss = 5.0881e-02, PNorm = 63.7122, GNorm = 0.8792, lr_0 = 1.9697e-04
Loss = 3.6256e-02, PNorm = 63.7447, GNorm = 0.5929, lr_0 = 1.9264e-04
Loss = 5.8829e-02, PNorm = 63.7619, GNorm = 0.2740, lr_0 = 1.8841e-04
Loss = 5.3473e-02, PNorm = 63.7870, GNorm = 0.1500, lr_0 = 1.8427e-04
Validation auc = 0.726027
Epoch 22
Loss = 3.9683e-02, PNorm = 63.8031, GNorm = 0.5202, lr_0 = 1.7982e-04
Loss = 4.2155e-02, PNorm = 63.8227, GNorm = 0.2430, lr_0 = 1.7586e-04
Loss = 5.1738e-02, PNorm = 63.8424, GNorm = 0.8277, lr_0 = 1.7200e-04
Validation auc = 0.729941
Epoch 23
Loss = 1.5798e-02, PNorm = 63.8620, GNorm = 0.1757, lr_0 = 1.6822e-04
Loss = 4.2254e-02, PNorm = 63.8773, GNorm = 0.3456, lr_0 = 1.6452e-04
Loss = 5.0937e-02, PNorm = 63.8997, GNorm = 1.0168, lr_0 = 1.6090e-04
Loss = 3.6037e-02, PNorm = 63.9154, GNorm = 0.0988, lr_0 = 1.5737e-04
Validation auc = 0.730267
Epoch 24
Loss = 2.8531e-02, PNorm = 63.9390, GNorm = 0.2419, lr_0 = 1.5357e-04
Loss = 2.5678e-02, PNorm = 63.9591, GNorm = 0.0941, lr_0 = 1.5019e-04
Loss = 5.4419e-02, PNorm = 63.9706, GNorm = 0.4160, lr_0 = 1.4689e-04
Loss = 4.8362e-02, PNorm = 63.9862, GNorm = 0.2938, lr_0 = 1.4366e-04
Validation auc = 0.717873
Epoch 25
Loss = 4.1702e-02, PNorm = 64.0032, GNorm = 0.2115, lr_0 = 1.4050e-04
Loss = 3.9095e-02, PNorm = 64.0188, GNorm = 0.5343, lr_0 = 1.3741e-04
Loss = 4.1199e-02, PNorm = 64.0345, GNorm = 0.3727, lr_0 = 1.3439e-04
Loss = 2.2960e-02, PNorm = 64.0568, GNorm = 0.0173, lr_0 = 1.3144e-04
Validation auc = 0.719830
Epoch 26
Loss = 2.3685e-02, PNorm = 64.0673, GNorm = 0.4924, lr_0 = 1.2826e-04
Loss = 3.6359e-02, PNorm = 64.0746, GNorm = 0.7275, lr_0 = 1.2545e-04
Loss = 5.0043e-02, PNorm = 64.0861, GNorm = 0.6620, lr_0 = 1.2269e-04
Validation auc = 0.701892
Epoch 27
Loss = 1.8904e-02, PNorm = 64.1032, GNorm = 0.1064, lr_0 = 1.1973e-04
Loss = 2.3784e-02, PNorm = 64.1141, GNorm = 0.4545, lr_0 = 1.1709e-04
Loss = 1.5145e-02, PNorm = 64.1237, GNorm = 0.5629, lr_0 = 1.1452e-04
Loss = 4.9190e-02, PNorm = 64.1333, GNorm = 0.4130, lr_0 = 1.1200e-04
Validation auc = 0.717221
Epoch 28
Loss = 2.0374e-02, PNorm = 64.1455, GNorm = 0.0949, lr_0 = 1.0954e-04
Loss = 2.5262e-02, PNorm = 64.1543, GNorm = 0.8041, lr_0 = 1.0713e-04
Loss = 3.9171e-02, PNorm = 64.1672, GNorm = 0.7236, lr_0 = 1.0478e-04
Loss = 1.3801e-02, PNorm = 64.1783, GNorm = 0.1727, lr_0 = 1.0247e-04
Validation auc = 0.711024
Epoch 29
Loss = 2.0062e-02, PNorm = 64.1874, GNorm = 0.7708, lr_0 = 1.0000e-04
Loss = 2.4239e-02, PNorm = 64.1932, GNorm = 0.1672, lr_0 = 1.0000e-04
Loss = 2.3852e-02, PNorm = 64.2036, GNorm = 0.1819, lr_0 = 1.0000e-04
Loss = 3.8139e-02, PNorm = 64.2123, GNorm = 0.7453, lr_0 = 1.0000e-04
Loss = 4.7834e-03, PNorm = 64.2134, GNorm = 0.1445, lr_0 = 1.0000e-04
Validation auc = 0.698630
Model 0 best validation auc = 0.744945 on epoch 18
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = 0.815309
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 2.9920e-01, PNorm = 59.4694, GNorm = 0.7338, lr_0 = 2.3378e-04
Loss = 1.8636e-01, PNorm = 59.4919, GNorm = 0.3712, lr_0 = 3.5541e-04
Loss = 2.2594e-01, PNorm = 59.5172, GNorm = 1.0361, lr_0 = 4.7703e-04
Validation auc = 0.613177
Epoch 1
Loss = 1.6228e-01, PNorm = 59.5513, GNorm = 0.6847, lr_0 = 6.1081e-04
Loss = 1.8894e-01, PNorm = 59.5936, GNorm = 0.4046, lr_0 = 7.3243e-04
Loss = 1.8765e-01, PNorm = 59.6541, GNorm = 0.6377, lr_0 = 8.5405e-04
Loss = 2.1990e-01, PNorm = 59.7208, GNorm = 0.4261, lr_0 = 9.7568e-04
Validation auc = 0.622635
Epoch 2
Loss = 1.7121e-01, PNorm = 59.8173, GNorm = 0.9456, lr_0 = 9.8020e-04
Loss = 1.5668e-01, PNorm = 59.9008, GNorm = 0.4726, lr_0 = 9.5865e-04
Loss = 1.8762e-01, PNorm = 59.9771, GNorm = 0.5051, lr_0 = 9.3758e-04
Loss = 1.5882e-01, PNorm = 60.0667, GNorm = 0.2834, lr_0 = 9.1697e-04
Validation auc = 0.640900
Epoch 3
Loss = 1.3071e-01, PNorm = 60.1482, GNorm = 0.4513, lr_0 = 8.9681e-04
Loss = 1.8207e-01, PNorm = 60.2137, GNorm = 0.3171, lr_0 = 8.7710e-04
Loss = 1.6217e-01, PNorm = 60.2967, GNorm = 0.3585, lr_0 = 8.5782e-04
Validation auc = 0.591977
Epoch 4
Loss = 2.0811e-01, PNorm = 60.3782, GNorm = 0.3332, lr_0 = 8.3710e-04
Loss = 1.5269e-01, PNorm = 60.4657, GNorm = 0.3644, lr_0 = 8.1870e-04
Loss = 1.3598e-01, PNorm = 60.5421, GNorm = 0.3860, lr_0 = 8.0071e-04
Loss = 1.5098e-01, PNorm = 60.6095, GNorm = 1.4613, lr_0 = 7.8311e-04
Validation auc = 0.594586
Epoch 5
Loss = 9.6257e-02, PNorm = 60.6956, GNorm = 0.1792, lr_0 = 7.6420e-04
Loss = 1.7092e-01, PNorm = 60.7550, GNorm = 0.8750, lr_0 = 7.4740e-04
Loss = 1.5250e-01, PNorm = 60.8402, GNorm = 0.2541, lr_0 = 7.3097e-04
Loss = 1.2636e-01, PNorm = 60.9162, GNorm = 0.2477, lr_0 = 7.1490e-04
Validation auc = 0.648728
Epoch 6
Loss = 1.3408e-01, PNorm = 60.9891, GNorm = 0.4219, lr_0 = 6.9919e-04
Loss = 1.2684e-01, PNorm = 61.0650, GNorm = 0.4860, lr_0 = 6.8382e-04
Loss = 1.3369e-01, PNorm = 61.1262, GNorm = 0.3214, lr_0 = 6.6879e-04
Loss = 1.2485e-01, PNorm = 61.1748, GNorm = 0.3389, lr_0 = 6.5409e-04
Validation auc = 0.641226
Epoch 7
Loss = 1.4821e-01, PNorm = 61.2409, GNorm = 0.4716, lr_0 = 6.3829e-04
Loss = 1.1195e-01, PNorm = 61.3241, GNorm = 0.3234, lr_0 = 6.2426e-04
Loss = 1.0898e-01, PNorm = 61.3984, GNorm = 0.3074, lr_0 = 6.1054e-04
Validation auc = 0.669276
Epoch 8
Loss = 5.3820e-02, PNorm = 61.4715, GNorm = 0.1070, lr_0 = 5.9579e-04
Loss = 1.3518e-01, PNorm = 61.5226, GNorm = 0.2684, lr_0 = 5.8270e-04
Loss = 1.1329e-01, PNorm = 61.5741, GNorm = 0.6213, lr_0 = 5.6989e-04
Loss = 1.3405e-01, PNorm = 61.6376, GNorm = 1.4832, lr_0 = 5.5736e-04
Validation auc = 0.690150
Epoch 9
Loss = 1.2164e-01, PNorm = 61.7022, GNorm = 0.3987, lr_0 = 5.4511e-04
Loss = 1.3148e-01, PNorm = 61.7618, GNorm = 0.3616, lr_0 = 5.3313e-04
Loss = 8.0006e-02, PNorm = 61.8426, GNorm = 0.3287, lr_0 = 5.2141e-04
Loss = 1.4281e-01, PNorm = 61.8825, GNorm = 1.2907, lr_0 = 5.0995e-04
Validation auc = 0.594260
Epoch 10
Loss = 1.2328e-01, PNorm = 61.9361, GNorm = 0.3772, lr_0 = 4.9764e-04
Loss = 1.3318e-01, PNorm = 61.9949, GNorm = 0.5864, lr_0 = 4.8670e-04
Loss = 8.8416e-02, PNorm = 62.0561, GNorm = 0.2065, lr_0 = 4.7600e-04
Loss = 9.6894e-02, PNorm = 62.1096, GNorm = 0.4359, lr_0 = 4.6554e-04
Loss = 4.8972e-03, PNorm = 62.1160, GNorm = 0.0660, lr_0 = 4.6450e-04
Validation auc = 0.706458
Epoch 11
Loss = 1.2979e-01, PNorm = 62.1621, GNorm = 0.3164, lr_0 = 4.5429e-04
Loss = 6.9869e-02, PNorm = 62.2207, GNorm = 0.2342, lr_0 = 4.4431e-04
Loss = 1.1723e-01, PNorm = 62.2585, GNorm = 1.1546, lr_0 = 4.3454e-04
Validation auc = 0.725375
Epoch 12
Loss = 1.0135e-01, PNorm = 62.3183, GNorm = 0.4778, lr_0 = 4.2499e-04
Loss = 9.3066e-02, PNorm = 62.3781, GNorm = 0.5999, lr_0 = 4.1565e-04
Loss = 9.9504e-02, PNorm = 62.4162, GNorm = 0.1410, lr_0 = 4.0651e-04
Loss = 8.9858e-02, PNorm = 62.4557, GNorm = 0.4499, lr_0 = 3.9758e-04
Validation auc = 0.658187
Epoch 13
Loss = 8.3049e-02, PNorm = 62.4997, GNorm = 0.5434, lr_0 = 3.8797e-04
Loss = 9.1012e-02, PNorm = 62.5451, GNorm = 0.3173, lr_0 = 3.7945e-04
Loss = 9.2453e-02, PNorm = 62.5881, GNorm = 0.4133, lr_0 = 3.7111e-04
Loss = 1.0992e-01, PNorm = 62.6397, GNorm = 0.6590, lr_0 = 3.6295e-04
Validation auc = 0.706458
Epoch 14
Loss = 7.7628e-02, PNorm = 62.6785, GNorm = 0.2821, lr_0 = 3.5497e-04
Loss = 9.0513e-02, PNorm = 62.7327, GNorm = 0.7146, lr_0 = 3.4717e-04
Loss = 7.4320e-02, PNorm = 62.7792, GNorm = 0.5093, lr_0 = 3.3954e-04
Loss = 1.0585e-01, PNorm = 62.8091, GNorm = 0.9681, lr_0 = 3.3207e-04
Loss = 3.0826e-02, PNorm = 62.8110, GNorm = 0.3649, lr_0 = 3.3134e-04
Validation auc = 0.671233
Epoch 15
Loss = 8.2794e-02, PNorm = 62.8568, GNorm = 0.3833, lr_0 = 3.2405e-04
Loss = 8.3681e-02, PNorm = 62.8993, GNorm = 0.9728, lr_0 = 3.1693e-04
Loss = 8.4181e-02, PNorm = 62.9402, GNorm = 0.3385, lr_0 = 3.0997e-04
Validation auc = 0.715590
Epoch 16
Loss = 8.1973e-02, PNorm = 62.9806, GNorm = 0.2443, lr_0 = 3.0248e-04
Loss = 8.6993e-02, PNorm = 63.0270, GNorm = 0.3476, lr_0 = 2.9583e-04
Loss = 6.4283e-02, PNorm = 63.0629, GNorm = 0.7803, lr_0 = 2.8933e-04
Loss = 6.6678e-02, PNorm = 63.0972, GNorm = 0.3253, lr_0 = 2.8297e-04
Validation auc = 0.687867
Epoch 17
Loss = 5.1017e-02, PNorm = 63.1367, GNorm = 0.2543, lr_0 = 2.7675e-04
Loss = 7.6181e-02, PNorm = 63.1834, GNorm = 0.4330, lr_0 = 2.7067e-04
Loss = 7.3743e-02, PNorm = 63.2307, GNorm = 0.2501, lr_0 = 2.6472e-04
Loss = 9.2968e-02, PNorm = 63.2606, GNorm = 0.4410, lr_0 = 2.5890e-04
Validation auc = 0.669276
Epoch 18
Loss = 7.1309e-02, PNorm = 63.2900, GNorm = 0.4433, lr_0 = 2.5264e-04
Loss = 5.8269e-02, PNorm = 63.3292, GNorm = 0.4614, lr_0 = 2.4709e-04
Loss = 8.7899e-02, PNorm = 63.3628, GNorm = 0.6733, lr_0 = 2.4166e-04
Validation auc = 0.707763
Epoch 19
Loss = 1.3153e-01, PNorm = 63.3897, GNorm = 0.5383, lr_0 = 2.3582e-04
Loss = 5.1182e-02, PNorm = 63.4365, GNorm = 0.2788, lr_0 = 2.3064e-04
Loss = 8.0339e-02, PNorm = 63.4554, GNorm = 0.2611, lr_0 = 2.2557e-04
Loss = 5.8093e-02, PNorm = 63.4881, GNorm = 0.3028, lr_0 = 2.2061e-04
Validation auc = 0.685258
Epoch 20
Loss = 5.7182e-02, PNorm = 63.5101, GNorm = 0.4859, lr_0 = 2.1576e-04
Loss = 5.8000e-02, PNorm = 63.5393, GNorm = 0.4083, lr_0 = 2.1102e-04
Loss = 6.1686e-02, PNorm = 63.5674, GNorm = 0.3759, lr_0 = 2.0638e-04
Loss = 5.3767e-02, PNorm = 63.5944, GNorm = 0.6486, lr_0 = 2.0185e-04
Validation auc = 0.697978
Epoch 21
Loss = 6.7949e-02, PNorm = 63.6200, GNorm = 0.6130, lr_0 = 1.9697e-04
Loss = 5.7307e-02, PNorm = 63.6528, GNorm = 1.7254, lr_0 = 1.9264e-04
Loss = 9.5161e-02, PNorm = 63.6662, GNorm = 0.9883, lr_0 = 1.8841e-04
Loss = 6.6020e-02, PNorm = 63.7074, GNorm = 0.2729, lr_0 = 1.8427e-04
Validation auc = 0.730267
Epoch 22
Loss = 5.7625e-02, PNorm = 63.7271, GNorm = 0.4757, lr_0 = 1.7982e-04
Loss = 5.1482e-02, PNorm = 63.7487, GNorm = 0.8401, lr_0 = 1.7586e-04
Loss = 5.6820e-02, PNorm = 63.7713, GNorm = 0.4759, lr_0 = 1.7200e-04
Validation auc = 0.711350
Epoch 23
Loss = 3.7460e-02, PNorm = 63.7882, GNorm = 0.2721, lr_0 = 1.6822e-04
Loss = 4.4653e-02, PNorm = 63.8079, GNorm = 0.0997, lr_0 = 1.6452e-04
Loss = 6.3762e-02, PNorm = 63.8227, GNorm = 0.5313, lr_0 = 1.6090e-04
Loss = 4.2811e-02, PNorm = 63.8410, GNorm = 0.9376, lr_0 = 1.5737e-04
Validation auc = 0.692759
Epoch 24
Loss = 2.5603e-02, PNorm = 63.8595, GNorm = 0.3957, lr_0 = 1.5357e-04
Loss = 7.3275e-02, PNorm = 63.8672, GNorm = 0.4524, lr_0 = 1.5019e-04
Loss = 5.0442e-02, PNorm = 63.8938, GNorm = 0.3243, lr_0 = 1.4689e-04
Loss = 2.8398e-02, PNorm = 63.9047, GNorm = 0.2098, lr_0 = 1.4366e-04
Validation auc = 0.697326
Epoch 25
Loss = 5.9378e-02, PNorm = 63.9183, GNorm = 0.6883, lr_0 = 1.4050e-04
Loss = 4.1846e-02, PNorm = 63.9339, GNorm = 0.4453, lr_0 = 1.3741e-04
Loss = 3.5594e-02, PNorm = 63.9490, GNorm = 0.2610, lr_0 = 1.3439e-04
Loss = 2.7181e-02, PNorm = 63.9629, GNorm = 0.5550, lr_0 = 1.3144e-04
Validation auc = 0.680365
Epoch 26
Loss = 2.7685e-02, PNorm = 63.9785, GNorm = 0.0907, lr_0 = 1.2826e-04
Loss = 4.2411e-02, PNorm = 63.9893, GNorm = 0.3544, lr_0 = 1.2545e-04
Loss = 4.1725e-02, PNorm = 64.0048, GNorm = 0.6986, lr_0 = 1.2269e-04
Validation auc = 0.671885
Epoch 27
Loss = 1.9346e-02, PNorm = 64.0199, GNorm = 0.3186, lr_0 = 1.1973e-04
Loss = 2.6181e-02, PNorm = 64.0297, GNorm = 0.3107, lr_0 = 1.1709e-04
Loss = 5.5844e-02, PNorm = 64.0428, GNorm = 0.9530, lr_0 = 1.1452e-04
Loss = 3.5687e-02, PNorm = 64.0574, GNorm = 0.3246, lr_0 = 1.1200e-04
Validation auc = 0.677104
Epoch 28
Loss = 2.8021e-02, PNorm = 64.0708, GNorm = 1.2721, lr_0 = 1.0954e-04
Loss = 4.0435e-02, PNorm = 64.0762, GNorm = 0.2799, lr_0 = 1.0713e-04
Loss = 4.0013e-02, PNorm = 64.0845, GNorm = 0.3239, lr_0 = 1.0478e-04
Loss = 3.4783e-02, PNorm = 64.0955, GNorm = 0.4246, lr_0 = 1.0247e-04
Validation auc = 0.678082
Epoch 29
Loss = 3.0460e-02, PNorm = 64.1063, GNorm = 0.4774, lr_0 = 1.0000e-04
Loss = 3.3144e-02, PNorm = 64.1173, GNorm = 0.4961, lr_0 = 1.0000e-04
Loss = 3.8150e-02, PNorm = 64.1264, GNorm = 0.5267, lr_0 = 1.0000e-04
Loss = 2.1167e-02, PNorm = 64.1385, GNorm = 0.3630, lr_0 = 1.0000e-04
Loss = 3.1634e-01, PNorm = 64.1376, GNorm = 5.7701, lr_0 = 1.0000e-04
Validation auc = 0.661774
Model 1 best validation auc = 0.730267 on epoch 21
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 1 test auc = 0.790617
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 2.9379e-01, PNorm = 59.4769, GNorm = 1.0186, lr_0 = 2.3378e-04
Loss = 2.5384e-01, PNorm = 59.5014, GNorm = 0.9885, lr_0 = 3.5541e-04
Loss = 1.4578e-01, PNorm = 59.5301, GNorm = 0.5509, lr_0 = 4.7703e-04
Validation auc = 0.639269
Epoch 1
Loss = 1.4198e-01, PNorm = 59.5672, GNorm = 0.3105, lr_0 = 6.1081e-04
Loss = 2.2346e-01, PNorm = 59.6058, GNorm = 0.5932, lr_0 = 7.3243e-04
Loss = 1.7482e-01, PNorm = 59.6626, GNorm = 1.6407, lr_0 = 8.5405e-04
Loss = 2.0555e-01, PNorm = 59.7558, GNorm = 0.2927, lr_0 = 9.7568e-04
Validation auc = 0.588715
Epoch 2
Loss = 1.7579e-01, PNorm = 59.8717, GNorm = 0.3116, lr_0 = 9.8020e-04
Loss = 2.0734e-01, PNorm = 59.9567, GNorm = 0.3987, lr_0 = 9.5865e-04
Loss = 1.8384e-01, PNorm = 60.0360, GNorm = 0.6439, lr_0 = 9.3758e-04
Loss = 1.7643e-01, PNorm = 60.1041, GNorm = 0.3161, lr_0 = 9.1697e-04
Validation auc = 0.618395
Epoch 3
Loss = 2.1806e-01, PNorm = 60.1782, GNorm = 0.7100, lr_0 = 8.9681e-04
Loss = 1.8791e-01, PNorm = 60.2453, GNorm = 0.5894, lr_0 = 8.7710e-04
Loss = 1.4694e-01, PNorm = 60.3110, GNorm = 0.7241, lr_0 = 8.5782e-04
Validation auc = 0.593933
Epoch 4
Loss = 2.6248e-01, PNorm = 60.3940, GNorm = 0.8865, lr_0 = 8.3710e-04
Loss = 1.4817e-01, PNorm = 60.4920, GNorm = 0.3394, lr_0 = 8.1870e-04
Loss = 1.7030e-01, PNorm = 60.5758, GNorm = 0.3707, lr_0 = 8.0071e-04
Loss = 1.3523e-01, PNorm = 60.6560, GNorm = 0.9460, lr_0 = 7.8311e-04
Validation auc = 0.597195
Epoch 5
Loss = 1.4714e-01, PNorm = 60.7342, GNorm = 0.2844, lr_0 = 7.6420e-04
Loss = 1.7877e-01, PNorm = 60.8297, GNorm = 0.4390, lr_0 = 7.4740e-04
Loss = 1.5742e-01, PNorm = 60.8974, GNorm = 0.5047, lr_0 = 7.3097e-04
Loss = 1.1456e-01, PNorm = 60.9821, GNorm = 0.7844, lr_0 = 7.1490e-04
Validation auc = 0.636008
Epoch 6
Loss = 1.3206e-01, PNorm = 61.0394, GNorm = 0.1872, lr_0 = 6.9919e-04
Loss = 1.2979e-01, PNorm = 61.1140, GNorm = 0.9217, lr_0 = 6.8382e-04
Loss = 1.2889e-01, PNorm = 61.1709, GNorm = 0.3151, lr_0 = 6.6879e-04
Loss = 1.5840e-01, PNorm = 61.2487, GNorm = 0.2368, lr_0 = 6.5409e-04
Validation auc = 0.651990
Epoch 7
Loss = 1.0178e-01, PNorm = 61.3229, GNorm = 0.3923, lr_0 = 6.3829e-04
Loss = 1.2774e-01, PNorm = 61.3847, GNorm = 0.5425, lr_0 = 6.2426e-04
Loss = 1.0734e-01, PNorm = 61.4574, GNorm = 0.4140, lr_0 = 6.1054e-04
Validation auc = 0.660144
Epoch 8
Loss = 1.6066e-01, PNorm = 61.5281, GNorm = 0.4279, lr_0 = 5.9579e-04
Loss = 1.3710e-01, PNorm = 61.6118, GNorm = 0.2739, lr_0 = 5.8270e-04
Loss = 7.6344e-02, PNorm = 61.6994, GNorm = 0.1932, lr_0 = 5.6989e-04
Loss = 1.3559e-01, PNorm = 61.7663, GNorm = 0.4403, lr_0 = 5.5736e-04
Validation auc = 0.639922
Epoch 9
Loss = 8.4605e-02, PNorm = 61.8472, GNorm = 0.2576, lr_0 = 5.4511e-04
Loss = 1.2139e-01, PNorm = 61.9072, GNorm = 0.2646, lr_0 = 5.3313e-04
Loss = 9.0322e-02, PNorm = 61.9779, GNorm = 0.2108, lr_0 = 5.2141e-04
Loss = 1.2912e-01, PNorm = 62.0351, GNorm = 0.5288, lr_0 = 5.0995e-04
Validation auc = 0.684605
Epoch 10
Loss = 9.1852e-02, PNorm = 62.0981, GNorm = 0.6518, lr_0 = 4.9764e-04
Loss = 1.1349e-01, PNorm = 62.1695, GNorm = 0.5163, lr_0 = 4.8670e-04
Loss = 1.2220e-01, PNorm = 62.2266, GNorm = 0.3289, lr_0 = 4.7600e-04
Loss = 7.7698e-02, PNorm = 62.2984, GNorm = 0.2606, lr_0 = 4.6554e-04
Loss = 1.0880e-01, PNorm = 62.3031, GNorm = 0.6122, lr_0 = 4.6450e-04
Validation auc = 0.686562
Epoch 11
Loss = 1.2276e-01, PNorm = 62.3491, GNorm = 0.7281, lr_0 = 4.5429e-04
Loss = 1.0216e-01, PNorm = 62.4114, GNorm = 0.3847, lr_0 = 4.4431e-04
Loss = 1.1525e-01, PNorm = 62.4799, GNorm = 0.3863, lr_0 = 4.3454e-04
Validation auc = 0.671233
Epoch 12
Loss = 3.7818e-02, PNorm = 62.5381, GNorm = 0.1558, lr_0 = 4.2499e-04
Loss = 9.0274e-02, PNorm = 62.5857, GNorm = 0.5095, lr_0 = 4.1565e-04
Loss = 1.0550e-01, PNorm = 62.6238, GNorm = 0.2698, lr_0 = 4.0651e-04
Loss = 1.2009e-01, PNorm = 62.6821, GNorm = 0.4053, lr_0 = 3.9758e-04
Validation auc = 0.732877
Epoch 13
Loss = 1.3395e-01, PNorm = 62.7418, GNorm = 1.0004, lr_0 = 3.8797e-04
Loss = 6.0643e-02, PNorm = 62.8000, GNorm = 0.2887, lr_0 = 3.7945e-04
Loss = 1.0945e-01, PNorm = 62.8370, GNorm = 0.6166, lr_0 = 3.7111e-04
Loss = 1.0007e-01, PNorm = 62.8915, GNorm = 0.3967, lr_0 = 3.6295e-04
Validation auc = 0.696347
Epoch 14
Loss = 6.4451e-02, PNorm = 62.9370, GNorm = 0.2209, lr_0 = 3.5497e-04
Loss = 6.8113e-02, PNorm = 62.9870, GNorm = 0.4906, lr_0 = 3.4717e-04
Loss = 9.4671e-02, PNorm = 63.0152, GNorm = 0.4087, lr_0 = 3.3954e-04
Loss = 8.5319e-02, PNorm = 63.0728, GNorm = 0.3995, lr_0 = 3.3207e-04
Loss = 9.9317e-03, PNorm = 63.0794, GNorm = 0.1661, lr_0 = 3.3134e-04
Validation auc = 0.732551
Epoch 15
Loss = 8.4765e-02, PNorm = 63.1136, GNorm = 0.7584, lr_0 = 3.2405e-04
Loss = 7.8458e-02, PNorm = 63.1575, GNorm = 0.4165, lr_0 = 3.1693e-04
Loss = 8.8953e-02, PNorm = 63.2007, GNorm = 0.6270, lr_0 = 3.0997e-04
Validation auc = 0.704175
Epoch 16
Loss = 5.7612e-02, PNorm = 63.2593, GNorm = 0.6882, lr_0 = 3.0248e-04
Loss = 6.6830e-02, PNorm = 63.2981, GNorm = 0.5985, lr_0 = 2.9583e-04
Loss = 1.0971e-01, PNorm = 63.3324, GNorm = 0.3389, lr_0 = 2.8933e-04
Loss = 7.4937e-02, PNorm = 63.3800, GNorm = 0.2838, lr_0 = 2.8297e-04
Validation auc = 0.735812
Epoch 17
Loss = 4.3975e-02, PNorm = 63.4185, GNorm = 0.6396, lr_0 = 2.7675e-04
Loss = 8.3248e-02, PNorm = 63.4590, GNorm = 0.3167, lr_0 = 2.7067e-04
Loss = 6.7649e-02, PNorm = 63.5003, GNorm = 0.3948, lr_0 = 2.6472e-04
Loss = 6.3892e-02, PNorm = 63.5234, GNorm = 0.3956, lr_0 = 2.5890e-04
Validation auc = 0.691129
Epoch 18
Loss = 5.3943e-02, PNorm = 63.5741, GNorm = 0.4261, lr_0 = 2.5264e-04
Loss = 6.7787e-02, PNorm = 63.5976, GNorm = 0.3543, lr_0 = 2.4709e-04
Loss = 5.5945e-02, PNorm = 63.6473, GNorm = 0.6375, lr_0 = 2.4166e-04
Validation auc = 0.715917
Epoch 19
Loss = 1.0463e-01, PNorm = 63.6634, GNorm = 1.4106, lr_0 = 2.3582e-04
Loss = 6.8628e-02, PNorm = 63.7108, GNorm = 0.3306, lr_0 = 2.3064e-04
Loss = 4.9688e-02, PNorm = 63.7402, GNorm = 0.7653, lr_0 = 2.2557e-04
Loss = 6.9001e-02, PNorm = 63.7667, GNorm = 0.7855, lr_0 = 2.2061e-04
Validation auc = 0.692433
Epoch 20
Loss = 9.4884e-02, PNorm = 63.7811, GNorm = 0.6615, lr_0 = 2.1576e-04
Loss = 5.3785e-02, PNorm = 63.8107, GNorm = 0.5812, lr_0 = 2.1102e-04
Loss = 6.1462e-02, PNorm = 63.8394, GNorm = 0.4794, lr_0 = 2.0638e-04
Loss = 2.9212e-02, PNorm = 63.8646, GNorm = 0.3503, lr_0 = 2.0185e-04
Validation auc = 0.721461
Epoch 21
Loss = 3.6174e-02, PNorm = 63.8911, GNorm = 0.2266, lr_0 = 1.9697e-04
Loss = 3.4288e-02, PNorm = 63.9119, GNorm = 0.9046, lr_0 = 1.9264e-04
Loss = 6.9407e-02, PNorm = 63.9359, GNorm = 1.1391, lr_0 = 1.8841e-04
Loss = 5.0404e-02, PNorm = 63.9509, GNorm = 0.1344, lr_0 = 1.8427e-04
Validation auc = 0.697326
Epoch 22
Loss = 5.2400e-02, PNorm = 63.9780, GNorm = 0.6598, lr_0 = 1.7982e-04
Loss = 4.5105e-02, PNorm = 63.9941, GNorm = 0.7351, lr_0 = 1.7586e-04
Loss = 4.7946e-02, PNorm = 64.0205, GNorm = 0.4975, lr_0 = 1.7200e-04
Validation auc = 0.704501
Epoch 23
Loss = 4.6809e-02, PNorm = 64.0392, GNorm = 0.4526, lr_0 = 1.6822e-04
Loss = 3.6101e-02, PNorm = 64.0609, GNorm = 0.6769, lr_0 = 1.6452e-04
Loss = 5.3697e-02, PNorm = 64.0885, GNorm = 0.9538, lr_0 = 1.6090e-04
Loss = 3.8109e-02, PNorm = 64.1092, GNorm = 0.6062, lr_0 = 1.5737e-04
Validation auc = 0.693412
Epoch 24
Loss = 5.4671e-02, PNorm = 64.1278, GNorm = 0.3200, lr_0 = 1.5357e-04
Loss = 3.0399e-02, PNorm = 64.1446, GNorm = 0.5493, lr_0 = 1.5019e-04
Loss = 3.1276e-02, PNorm = 64.1635, GNorm = 0.7688, lr_0 = 1.4689e-04
Loss = 5.5431e-02, PNorm = 64.1812, GNorm = 0.7872, lr_0 = 1.4366e-04
Validation auc = 0.711350
Epoch 25
Loss = 4.2947e-02, PNorm = 64.2071, GNorm = 0.4662, lr_0 = 1.4050e-04
Loss = 3.5934e-02, PNorm = 64.2194, GNorm = 0.8260, lr_0 = 1.3741e-04
Loss = 4.4869e-02, PNorm = 64.2357, GNorm = 0.2137, lr_0 = 1.3439e-04
Loss = 3.6960e-02, PNorm = 64.2518, GNorm = 0.4178, lr_0 = 1.3144e-04
Validation auc = 0.712655
Epoch 26
Loss = 2.8471e-02, PNorm = 64.2714, GNorm = 1.3089, lr_0 = 1.2826e-04
Loss = 4.6618e-02, PNorm = 64.2737, GNorm = 0.2394, lr_0 = 1.2545e-04
Loss = 4.5240e-02, PNorm = 64.2944, GNorm = 0.0836, lr_0 = 1.2269e-04
Validation auc = 0.708415
Epoch 27
Loss = 1.3631e-02, PNorm = 64.3071, GNorm = 0.1933, lr_0 = 1.1973e-04
Loss = 3.9544e-02, PNorm = 64.3277, GNorm = 0.1994, lr_0 = 1.1709e-04
Loss = 3.5346e-02, PNorm = 64.3404, GNorm = 0.1524, lr_0 = 1.1452e-04
Loss = 2.3219e-02, PNorm = 64.3547, GNorm = 0.2271, lr_0 = 1.1200e-04
Validation auc = 0.700261
Epoch 28
Loss = 3.7429e-02, PNorm = 64.3610, GNorm = 0.3209, lr_0 = 1.0954e-04
Loss = 2.5906e-02, PNorm = 64.3800, GNorm = 0.4727, lr_0 = 1.0713e-04
Loss = 3.9967e-02, PNorm = 64.3874, GNorm = 1.5445, lr_0 = 1.0478e-04
Loss = 2.5184e-02, PNorm = 64.4025, GNorm = 0.2157, lr_0 = 1.0247e-04
Validation auc = 0.710372
Epoch 29
Loss = 2.6916e-02, PNorm = 64.4164, GNorm = 0.4738, lr_0 = 1.0000e-04
Loss = 2.0989e-02, PNorm = 64.4226, GNorm = 0.7148, lr_0 = 1.0000e-04
Loss = 3.3474e-02, PNorm = 64.4294, GNorm = 0.9863, lr_0 = 1.0000e-04
Loss = 2.9534e-02, PNorm = 64.4421, GNorm = 0.1555, lr_0 = 1.0000e-04
Loss = 7.6038e-03, PNorm = 64.4431, GNorm = 0.3366, lr_0 = 1.0000e-04
Validation auc = 0.692759
Model 2 best validation auc = 0.735812 on epoch 16
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 2 test auc = 0.832099
Ensemble test auc = 0.805432
Fold 7
Splitting data with seed 7
Class sizes
hit 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 1,868 | val size = 233 | test size = 234
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 2.7900e-01, PNorm = 59.4440, GNorm = 0.5986, lr_0 = 2.3378e-04
Loss = 2.4935e-01, PNorm = 59.4716, GNorm = 0.3444, lr_0 = 3.5541e-04
Loss = 1.8167e-01, PNorm = 59.5038, GNorm = 0.4543, lr_0 = 4.7703e-04
Validation auc = 0.691931
Epoch 1
Loss = 1.6887e-01, PNorm = 59.5430, GNorm = 0.3789, lr_0 = 6.1081e-04
Loss = 2.0246e-01, PNorm = 59.5815, GNorm = 0.3860, lr_0 = 7.3243e-04
Loss = 2.2675e-01, PNorm = 59.6187, GNorm = 0.9448, lr_0 = 8.5405e-04
Loss = 1.5670e-01, PNorm = 59.6942, GNorm = 0.1876, lr_0 = 9.7568e-04
Validation auc = 0.750377
Epoch 2
Loss = 1.9258e-01, PNorm = 59.7639, GNorm = 0.2958, lr_0 = 9.8020e-04
Loss = 1.7823e-01, PNorm = 59.8337, GNorm = 0.5349, lr_0 = 9.5865e-04
Loss = 1.4839e-01, PNorm = 59.9141, GNorm = 1.0228, lr_0 = 9.3758e-04
Loss = 2.1558e-01, PNorm = 60.0021, GNorm = 0.4909, lr_0 = 9.1697e-04
Validation auc = 0.749246
Epoch 3
Loss = 2.4564e-01, PNorm = 60.0895, GNorm = 0.4984, lr_0 = 8.9681e-04
Loss = 2.0432e-01, PNorm = 60.1697, GNorm = 0.4495, lr_0 = 8.7710e-04
Loss = 1.4002e-01, PNorm = 60.2609, GNorm = 0.1800, lr_0 = 8.5782e-04
Validation auc = 0.755656
Epoch 4
Loss = 1.2097e-01, PNorm = 60.3150, GNorm = 0.2570, lr_0 = 8.3710e-04
Loss = 1.7819e-01, PNorm = 60.3682, GNorm = 0.8948, lr_0 = 8.1870e-04
Loss = 1.7201e-01, PNorm = 60.4359, GNorm = 0.3126, lr_0 = 8.0071e-04
Loss = 1.4496e-01, PNorm = 60.4890, GNorm = 0.5728, lr_0 = 7.8311e-04
Validation auc = 0.743590
Epoch 5
Loss = 1.7368e-01, PNorm = 60.5543, GNorm = 0.3393, lr_0 = 7.6420e-04
Loss = 1.5895e-01, PNorm = 60.6207, GNorm = 0.4287, lr_0 = 7.4740e-04
Loss = 1.7192e-01, PNorm = 60.6905, GNorm = 0.2747, lr_0 = 7.3097e-04
Loss = 1.5882e-01, PNorm = 60.7496, GNorm = 0.3873, lr_0 = 7.1490e-04
Validation auc = 0.778281
Epoch 6
Loss = 1.4111e-01, PNorm = 60.8208, GNorm = 0.4651, lr_0 = 6.9919e-04
Loss = 1.7505e-01, PNorm = 60.8822, GNorm = 0.5808, lr_0 = 6.8382e-04
Loss = 1.3059e-01, PNorm = 60.9693, GNorm = 0.7671, lr_0 = 6.6879e-04
Loss = 1.4040e-01, PNorm = 61.0416, GNorm = 0.3161, lr_0 = 6.5409e-04
Validation auc = 0.791855
Epoch 7
Loss = 1.4142e-01, PNorm = 61.1204, GNorm = 0.4514, lr_0 = 6.3829e-04
Loss = 9.8496e-02, PNorm = 61.1976, GNorm = 0.2412, lr_0 = 6.2426e-04
Loss = 1.9749e-01, PNorm = 61.2375, GNorm = 0.5613, lr_0 = 6.1054e-04
Validation auc = 0.829186
Epoch 8
Loss = 1.8086e-01, PNorm = 61.3321, GNorm = 0.2891, lr_0 = 5.9579e-04
Loss = 1.3485e-01, PNorm = 61.4134, GNorm = 0.3131, lr_0 = 5.8270e-04
Loss = 1.3089e-01, PNorm = 61.4763, GNorm = 0.3046, lr_0 = 5.6989e-04
Loss = 1.5942e-01, PNorm = 61.5259, GNorm = 0.3542, lr_0 = 5.5736e-04
Validation auc = 0.793741
Epoch 9
Loss = 9.7371e-02, PNorm = 61.5824, GNorm = 0.2510, lr_0 = 5.4511e-04
Loss = 1.5352e-01, PNorm = 61.6365, GNorm = 0.4094, lr_0 = 5.3313e-04
Loss = 1.4102e-01, PNorm = 61.6843, GNorm = 0.8763, lr_0 = 5.2141e-04
Loss = 1.5671e-01, PNorm = 61.7256, GNorm = 0.2560, lr_0 = 5.0995e-04
Validation auc = 0.761312
Epoch 10
Loss = 1.0410e-01, PNorm = 61.8002, GNorm = 0.7651, lr_0 = 4.9764e-04
Loss = 1.5733e-01, PNorm = 61.8534, GNorm = 0.2604, lr_0 = 4.8670e-04
Loss = 1.2702e-01, PNorm = 61.9001, GNorm = 0.2955, lr_0 = 4.7600e-04
Loss = 1.6516e-01, PNorm = 61.9468, GNorm = 0.8037, lr_0 = 4.6554e-04
Loss = 5.7899e-02, PNorm = 61.9529, GNorm = 0.5223, lr_0 = 4.6450e-04
Validation auc = 0.794118
Epoch 11
Loss = 1.0457e-01, PNorm = 62.0167, GNorm = 0.2683, lr_0 = 4.5429e-04
Loss = 1.2248e-01, PNorm = 62.0677, GNorm = 0.7831, lr_0 = 4.4431e-04
Loss = 1.1399e-01, PNorm = 62.1176, GNorm = 0.1499, lr_0 = 4.3454e-04
Validation auc = 0.807692
Epoch 12
Loss = 1.3639e-01, PNorm = 62.1515, GNorm = 0.4302, lr_0 = 4.2499e-04
Loss = 1.6604e-01, PNorm = 62.2020, GNorm = 1.1554, lr_0 = 4.1565e-04
Loss = 9.0181e-02, PNorm = 62.2511, GNorm = 0.2063, lr_0 = 4.0651e-04
Loss = 1.2194e-01, PNorm = 62.2979, GNorm = 0.5826, lr_0 = 3.9758e-04
Validation auc = 0.800528
Epoch 13
Loss = 1.3814e-01, PNorm = 62.3383, GNorm = 0.3288, lr_0 = 3.8797e-04
Loss = 1.0076e-01, PNorm = 62.4037, GNorm = 0.2333, lr_0 = 3.7945e-04
Loss = 1.1117e-01, PNorm = 62.4410, GNorm = 0.4254, lr_0 = 3.7111e-04
Loss = 1.1514e-01, PNorm = 62.4926, GNorm = 0.4914, lr_0 = 3.6295e-04
Validation auc = 0.848793
Epoch 14
Loss = 1.2946e-01, PNorm = 62.5252, GNorm = 0.3019, lr_0 = 3.5497e-04
Loss = 9.6643e-02, PNorm = 62.5683, GNorm = 0.2697, lr_0 = 3.4717e-04
Loss = 1.1654e-01, PNorm = 62.6106, GNorm = 0.9006, lr_0 = 3.3954e-04
Loss = 9.9718e-02, PNorm = 62.6666, GNorm = 0.2419, lr_0 = 3.3207e-04
Loss = 3.6011e-01, PNorm = 62.6706, GNorm = 1.4378, lr_0 = 3.3134e-04
Validation auc = 0.883861
Epoch 15
Loss = 9.4047e-02, PNorm = 62.7131, GNorm = 0.6378, lr_0 = 3.2405e-04
Loss = 9.3271e-02, PNorm = 62.7606, GNorm = 0.4390, lr_0 = 3.1693e-04
Loss = 1.2481e-01, PNorm = 62.7948, GNorm = 0.9592, lr_0 = 3.0997e-04
Validation auc = 0.884615
Epoch 16
Loss = 1.1379e-01, PNorm = 62.8327, GNorm = 0.2929, lr_0 = 3.0248e-04
Loss = 9.2314e-02, PNorm = 62.8760, GNorm = 0.5114, lr_0 = 2.9583e-04
Loss = 7.1607e-02, PNorm = 62.9141, GNorm = 0.3365, lr_0 = 2.8933e-04
Loss = 1.1980e-01, PNorm = 62.9561, GNorm = 0.5866, lr_0 = 2.8297e-04
Validation auc = 0.890271
Epoch 17
Loss = 1.1923e-01, PNorm = 62.9937, GNorm = 1.3375, lr_0 = 2.7675e-04
Loss = 1.1450e-01, PNorm = 63.0290, GNorm = 0.7515, lr_0 = 2.7067e-04
Loss = 8.1816e-02, PNorm = 63.0688, GNorm = 0.5052, lr_0 = 2.6472e-04
Loss = 8.0478e-02, PNorm = 63.1072, GNorm = 0.5896, lr_0 = 2.5890e-04
Validation auc = 0.886124
Epoch 18
Loss = 7.0500e-02, PNorm = 63.1405, GNorm = 0.5391, lr_0 = 2.5264e-04
Loss = 7.3837e-02, PNorm = 63.1715, GNorm = 0.2958, lr_0 = 2.4709e-04
Loss = 1.0371e-01, PNorm = 63.2021, GNorm = 0.5263, lr_0 = 2.4166e-04
Validation auc = 0.901961
Epoch 19
Loss = 2.3897e-02, PNorm = 63.2317, GNorm = 0.1979, lr_0 = 2.3582e-04
Loss = 9.1020e-02, PNorm = 63.2698, GNorm = 0.4876, lr_0 = 2.3064e-04
Loss = 6.7310e-02, PNorm = 63.3083, GNorm = 0.1462, lr_0 = 2.2557e-04
Loss = 9.0647e-02, PNorm = 63.3327, GNorm = 0.7863, lr_0 = 2.2061e-04
Validation auc = 0.889140
Epoch 20
Loss = 6.4872e-02, PNorm = 63.3604, GNorm = 0.1918, lr_0 = 2.1576e-04
Loss = 6.2958e-02, PNorm = 63.3883, GNorm = 0.3226, lr_0 = 2.1102e-04
Loss = 8.7551e-02, PNorm = 63.4183, GNorm = 0.4054, lr_0 = 2.0638e-04
Loss = 9.5836e-02, PNorm = 63.4413, GNorm = 0.7181, lr_0 = 2.0185e-04
Validation auc = 0.886501
Epoch 21
Loss = 6.1528e-02, PNorm = 63.4717, GNorm = 0.4334, lr_0 = 1.9697e-04
Loss = 4.6021e-02, PNorm = 63.4918, GNorm = 0.4727, lr_0 = 1.9264e-04
Loss = 4.9846e-02, PNorm = 63.5176, GNorm = 0.2134, lr_0 = 1.8841e-04
Loss = 1.1288e-01, PNorm = 63.5372, GNorm = 0.5140, lr_0 = 1.8427e-04
Validation auc = 0.888009
Epoch 22
Loss = 7.4596e-02, PNorm = 63.5671, GNorm = 0.8352, lr_0 = 1.7982e-04
Loss = 7.7253e-02, PNorm = 63.5955, GNorm = 0.2381, lr_0 = 1.7586e-04
Loss = 7.8319e-02, PNorm = 63.6179, GNorm = 0.2069, lr_0 = 1.7200e-04
Validation auc = 0.890271
Epoch 23
Loss = 2.2682e-02, PNorm = 63.6388, GNorm = 0.1842, lr_0 = 1.6822e-04
Loss = 4.8930e-02, PNorm = 63.6568, GNorm = 0.3842, lr_0 = 1.6452e-04
Loss = 6.9522e-02, PNorm = 63.6749, GNorm = 0.7803, lr_0 = 1.6090e-04
Loss = 6.6192e-02, PNorm = 63.6942, GNorm = 0.4851, lr_0 = 1.5737e-04
Validation auc = 0.889517
Epoch 24
Loss = 3.0796e-02, PNorm = 63.7155, GNorm = 0.6770, lr_0 = 1.5357e-04
Loss = 7.4374e-02, PNorm = 63.7346, GNorm = 0.2430, lr_0 = 1.5019e-04
Loss = 5.4578e-02, PNorm = 63.7581, GNorm = 0.3762, lr_0 = 1.4689e-04
Loss = 5.5531e-02, PNorm = 63.7727, GNorm = 0.5104, lr_0 = 1.4366e-04
Validation auc = 0.892534
Epoch 25
Loss = 2.1916e-02, PNorm = 63.7898, GNorm = 0.4665, lr_0 = 1.4050e-04
Loss = 5.5933e-02, PNorm = 63.8006, GNorm = 0.4170, lr_0 = 1.3741e-04
Loss = 5.6230e-02, PNorm = 63.8175, GNorm = 0.5765, lr_0 = 1.3439e-04
Loss = 6.6560e-02, PNorm = 63.8312, GNorm = 0.9005, lr_0 = 1.3144e-04
Validation auc = 0.896682
Epoch 26
Loss = 4.8726e-02, PNorm = 63.8535, GNorm = 0.5923, lr_0 = 1.2826e-04
Loss = 3.3647e-02, PNorm = 63.8715, GNorm = 0.7839, lr_0 = 1.2545e-04
Loss = 5.7771e-02, PNorm = 63.8852, GNorm = 0.4470, lr_0 = 1.2269e-04
Validation auc = 0.889140
Epoch 27
Loss = 7.4262e-02, PNorm = 63.9009, GNorm = 0.8943, lr_0 = 1.1973e-04
Loss = 4.6206e-02, PNorm = 63.9173, GNorm = 0.5263, lr_0 = 1.1709e-04
Loss = 4.3884e-02, PNorm = 63.9294, GNorm = 0.6481, lr_0 = 1.1452e-04
Loss = 3.2560e-02, PNorm = 63.9426, GNorm = 0.4111, lr_0 = 1.1200e-04
Validation auc = 0.878959
Epoch 28
Loss = 5.2747e-02, PNorm = 63.9545, GNorm = 0.8842, lr_0 = 1.0954e-04
Loss = 3.7971e-02, PNorm = 63.9703, GNorm = 0.3267, lr_0 = 1.0713e-04
Loss = 6.3398e-02, PNorm = 63.9763, GNorm = 0.8631, lr_0 = 1.0478e-04
Loss = 5.3403e-02, PNorm = 63.9927, GNorm = 1.4278, lr_0 = 1.0247e-04
Validation auc = 0.892157
Epoch 29
Loss = 2.8204e-02, PNorm = 64.0035, GNorm = 0.7380, lr_0 = 1.0000e-04
Loss = 2.9240e-02, PNorm = 64.0120, GNorm = 0.9145, lr_0 = 1.0000e-04
Loss = 4.2804e-02, PNorm = 64.0167, GNorm = 0.2679, lr_0 = 1.0000e-04
Loss = 5.9779e-02, PNorm = 64.0286, GNorm = 0.5026, lr_0 = 1.0000e-04
Loss = 1.4450e-02, PNorm = 64.0304, GNorm = 0.2732, lr_0 = 1.0000e-04
Validation auc = 0.895551
Model 0 best validation auc = 0.901961 on epoch 18
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = 0.919643
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 2.8108e-01, PNorm = 59.4716, GNorm = 0.3371, lr_0 = 2.3378e-04
Loss = 2.5114e-01, PNorm = 59.4945, GNorm = 0.7282, lr_0 = 3.5541e-04
Loss = 2.0328e-01, PNorm = 59.5234, GNorm = 0.5441, lr_0 = 4.7703e-04
Validation auc = 0.774887
Epoch 1
Loss = 2.3614e-01, PNorm = 59.5587, GNorm = 0.3522, lr_0 = 6.1081e-04
Loss = 1.8880e-01, PNorm = 59.5995, GNorm = 0.3873, lr_0 = 7.3243e-04
Loss = 1.9964e-01, PNorm = 59.6571, GNorm = 0.8781, lr_0 = 8.5405e-04
Loss = 1.8105e-01, PNorm = 59.7305, GNorm = 0.2543, lr_0 = 9.7568e-04
Validation auc = 0.710784
Epoch 2
Loss = 1.5407e-01, PNorm = 59.8138, GNorm = 0.4772, lr_0 = 9.8020e-04
Loss = 2.1583e-01, PNorm = 59.8972, GNorm = 1.1306, lr_0 = 9.5865e-04
Loss = 1.3595e-01, PNorm = 59.9611, GNorm = 0.6796, lr_0 = 9.3758e-04
Loss = 2.1464e-01, PNorm = 60.0103, GNorm = 0.4152, lr_0 = 9.1697e-04
Validation auc = 0.750754
Epoch 3
Loss = 1.8812e-01, PNorm = 60.0793, GNorm = 0.5728, lr_0 = 8.9681e-04
Loss = 1.4601e-01, PNorm = 60.1499, GNorm = 0.3180, lr_0 = 8.7710e-04
Loss = 1.4666e-01, PNorm = 60.2190, GNorm = 0.5687, lr_0 = 8.5782e-04
Validation auc = 0.800528
Epoch 4
Loss = 1.8550e-01, PNorm = 60.2991, GNorm = 0.6741, lr_0 = 8.3710e-04
Loss = 1.6331e-01, PNorm = 60.3710, GNorm = 0.5793, lr_0 = 8.1870e-04
Loss = 1.6350e-01, PNorm = 60.4482, GNorm = 1.1110, lr_0 = 8.0071e-04
Loss = 1.9261e-01, PNorm = 60.5227, GNorm = 0.4284, lr_0 = 7.8311e-04
Validation auc = 0.742459
Epoch 5
Loss = 1.9629e-01, PNorm = 60.5905, GNorm = 0.5656, lr_0 = 7.6420e-04
Loss = 1.4203e-01, PNorm = 60.6618, GNorm = 0.2222, lr_0 = 7.4740e-04
Loss = 1.6227e-01, PNorm = 60.7083, GNorm = 0.2934, lr_0 = 7.3097e-04
Loss = 1.3168e-01, PNorm = 60.7703, GNorm = 0.4217, lr_0 = 7.1490e-04
Validation auc = 0.758296
Epoch 6
Loss = 1.6297e-01, PNorm = 60.8269, GNorm = 0.5287, lr_0 = 6.9919e-04
Loss = 1.8274e-01, PNorm = 60.8914, GNorm = 0.2497, lr_0 = 6.8382e-04
Loss = 1.4127e-01, PNorm = 60.9606, GNorm = 0.5267, lr_0 = 6.6879e-04
Loss = 1.2591e-01, PNorm = 61.0276, GNorm = 0.5233, lr_0 = 6.5409e-04
Validation auc = 0.739819
Epoch 7
Loss = 1.3665e-01, PNorm = 61.0867, GNorm = 0.2053, lr_0 = 6.3829e-04
Loss = 1.5192e-01, PNorm = 61.1258, GNorm = 0.2346, lr_0 = 6.2426e-04
Loss = 1.6544e-01, PNorm = 61.1874, GNorm = 0.4751, lr_0 = 6.1054e-04
Validation auc = 0.784314
Epoch 8
Loss = 2.5121e-01, PNorm = 61.2602, GNorm = 0.3640, lr_0 = 5.9579e-04
Loss = 1.1050e-01, PNorm = 61.3363, GNorm = 0.1900, lr_0 = 5.8270e-04
Loss = 1.5589e-01, PNorm = 61.3912, GNorm = 0.5177, lr_0 = 5.6989e-04
Loss = 1.1680e-01, PNorm = 61.4576, GNorm = 0.4332, lr_0 = 5.5736e-04
Validation auc = 0.793741
Epoch 9
Loss = 1.3149e-01, PNorm = 61.5256, GNorm = 0.5304, lr_0 = 5.4511e-04
Loss = 1.4471e-01, PNorm = 61.5783, GNorm = 0.3884, lr_0 = 5.3313e-04
Loss = 9.4121e-02, PNorm = 61.6419, GNorm = 0.5224, lr_0 = 5.2141e-04
Loss = 1.3460e-01, PNorm = 61.6988, GNorm = 0.4137, lr_0 = 5.0995e-04
Validation auc = 0.835973
Epoch 10
Loss = 9.5870e-02, PNorm = 61.7669, GNorm = 0.6299, lr_0 = 4.9764e-04
Loss = 9.5539e-02, PNorm = 61.8264, GNorm = 0.4957, lr_0 = 4.8670e-04
Loss = 2.0340e-01, PNorm = 61.8742, GNorm = 0.7826, lr_0 = 4.7600e-04
Loss = 1.1877e-01, PNorm = 61.9581, GNorm = 0.1487, lr_0 = 4.6554e-04
Loss = 6.6019e-01, PNorm = 61.9600, GNorm = 2.3610, lr_0 = 4.6450e-04
Validation auc = 0.825792
Epoch 11
Loss = 1.5430e-01, PNorm = 62.0279, GNorm = 0.5135, lr_0 = 4.5429e-04
Loss = 1.2892e-01, PNorm = 62.1186, GNorm = 0.3242, lr_0 = 4.4431e-04
Loss = 1.2210e-01, PNorm = 62.1894, GNorm = 0.6810, lr_0 = 4.3454e-04
Validation auc = 0.817873
Epoch 12
Loss = 3.7848e-02, PNorm = 62.2220, GNorm = 0.2330, lr_0 = 4.2499e-04
Loss = 1.2714e-01, PNorm = 62.2664, GNorm = 0.2635, lr_0 = 4.1565e-04
Loss = 1.0971e-01, PNorm = 62.3184, GNorm = 0.2552, lr_0 = 4.0651e-04
Loss = 1.3573e-01, PNorm = 62.3554, GNorm = 0.4772, lr_0 = 3.9758e-04
Validation auc = 0.881976
Epoch 13
Loss = 1.4430e-01, PNorm = 62.4173, GNorm = 0.2114, lr_0 = 3.8797e-04
Loss = 1.3757e-01, PNorm = 62.4724, GNorm = 0.4883, lr_0 = 3.7945e-04
Loss = 8.2326e-02, PNorm = 62.5419, GNorm = 0.2174, lr_0 = 3.7111e-04
Loss = 9.5656e-02, PNorm = 62.5903, GNorm = 0.3341, lr_0 = 3.6295e-04
Validation auc = 0.829563
Epoch 14
Loss = 1.2536e-01, PNorm = 62.6362, GNorm = 0.2935, lr_0 = 3.5497e-04
Loss = 1.2405e-01, PNorm = 62.6837, GNorm = 0.3185, lr_0 = 3.4717e-04
Loss = 9.1365e-02, PNorm = 62.7384, GNorm = 0.3613, lr_0 = 3.3954e-04
Loss = 9.3259e-02, PNorm = 62.7931, GNorm = 0.1374, lr_0 = 3.3207e-04
Loss = 1.9224e-02, PNorm = 62.7996, GNorm = 0.1679, lr_0 = 3.3134e-04
Validation auc = 0.862745
Epoch 15
Loss = 1.0298e-01, PNorm = 62.8480, GNorm = 1.0114, lr_0 = 3.2405e-04
Loss = 9.7434e-02, PNorm = 62.9060, GNorm = 0.6797, lr_0 = 3.1693e-04
Loss = 8.3757e-02, PNorm = 62.9379, GNorm = 0.3418, lr_0 = 3.0997e-04
Validation auc = 0.884992
Epoch 16
Loss = 5.2780e-02, PNorm = 62.9916, GNorm = 0.2598, lr_0 = 3.0248e-04
Loss = 1.0662e-01, PNorm = 63.0390, GNorm = 0.3824, lr_0 = 2.9583e-04
Loss = 8.3631e-02, PNorm = 63.0900, GNorm = 0.6689, lr_0 = 2.8933e-04
Loss = 1.0554e-01, PNorm = 63.1381, GNorm = 0.3041, lr_0 = 2.8297e-04
Validation auc = 0.889517
Epoch 17
Loss = 7.8541e-02, PNorm = 63.1833, GNorm = 0.4312, lr_0 = 2.7675e-04
Loss = 1.1372e-01, PNorm = 63.2310, GNorm = 0.8485, lr_0 = 2.7067e-04
Loss = 6.9700e-02, PNorm = 63.2805, GNorm = 0.2986, lr_0 = 2.6472e-04
Loss = 8.1757e-02, PNorm = 63.3196, GNorm = 0.8592, lr_0 = 2.5890e-04
Validation auc = 0.899321
Epoch 18
Loss = 5.9439e-02, PNorm = 63.3774, GNorm = 0.3878, lr_0 = 2.5264e-04
Loss = 9.8169e-02, PNorm = 63.4149, GNorm = 0.2549, lr_0 = 2.4709e-04
Loss = 8.4468e-02, PNorm = 63.4639, GNorm = 0.3372, lr_0 = 2.4166e-04
Validation auc = 0.888386
Epoch 19
Loss = 6.8527e-02, PNorm = 63.4923, GNorm = 0.5458, lr_0 = 2.3582e-04
Loss = 7.5062e-02, PNorm = 63.5339, GNorm = 0.3186, lr_0 = 2.3064e-04
Loss = 9.4466e-02, PNorm = 63.5597, GNorm = 0.2449, lr_0 = 2.2557e-04
Loss = 5.5118e-02, PNorm = 63.5926, GNorm = 0.6249, lr_0 = 2.2061e-04
Validation auc = 0.899698
Epoch 20
Loss = 7.4745e-02, PNorm = 63.6216, GNorm = 0.2931, lr_0 = 2.1576e-04
Loss = 7.4529e-02, PNorm = 63.6471, GNorm = 0.5743, lr_0 = 2.1102e-04
Loss = 6.6836e-02, PNorm = 63.6758, GNorm = 0.2136, lr_0 = 2.0638e-04
Loss = 7.5375e-02, PNorm = 63.7043, GNorm = 0.3629, lr_0 = 2.0185e-04
Validation auc = 0.894796
Epoch 21
Loss = 4.9684e-02, PNorm = 63.7347, GNorm = 0.5669, lr_0 = 1.9697e-04
Loss = 5.1591e-02, PNorm = 63.7617, GNorm = 0.4908, lr_0 = 1.9264e-04
Loss = 8.4213e-02, PNorm = 63.7857, GNorm = 0.1656, lr_0 = 1.8841e-04
Loss = 8.0423e-02, PNorm = 63.8050, GNorm = 0.5661, lr_0 = 1.8427e-04
Validation auc = 0.883107
Epoch 22
Loss = 7.3642e-02, PNorm = 63.8287, GNorm = 0.2706, lr_0 = 1.7982e-04
Loss = 4.7560e-02, PNorm = 63.8485, GNorm = 0.2253, lr_0 = 1.7586e-04
Loss = 7.1401e-02, PNorm = 63.8710, GNorm = 0.5965, lr_0 = 1.7200e-04
Validation auc = 0.894796
Epoch 23
Loss = 2.5624e-02, PNorm = 63.8936, GNorm = 0.2992, lr_0 = 1.6822e-04
Loss = 5.7196e-02, PNorm = 63.9162, GNorm = 0.7479, lr_0 = 1.6452e-04
Loss = 4.8124e-02, PNorm = 63.9435, GNorm = 0.4665, lr_0 = 1.6090e-04
Loss = 7.4670e-02, PNorm = 63.9574, GNorm = 0.5331, lr_0 = 1.5737e-04
Validation auc = 0.889140
Epoch 24
Loss = 6.2135e-02, PNorm = 63.9828, GNorm = 0.2405, lr_0 = 1.5357e-04
Loss = 4.1006e-02, PNorm = 64.0049, GNorm = 0.3506, lr_0 = 1.5019e-04
Loss = 6.4609e-02, PNorm = 64.0286, GNorm = 0.9112, lr_0 = 1.4689e-04
Loss = 4.0454e-02, PNorm = 64.0501, GNorm = 0.4768, lr_0 = 1.4366e-04
Validation auc = 0.855204
Epoch 25
Loss = 8.0255e-02, PNorm = 64.0685, GNorm = 0.6986, lr_0 = 1.4050e-04
Loss = 5.2988e-02, PNorm = 64.0891, GNorm = 0.8309, lr_0 = 1.3741e-04
Loss = 4.1924e-02, PNorm = 64.1123, GNorm = 0.5211, lr_0 = 1.3439e-04
Loss = 6.8475e-02, PNorm = 64.1276, GNorm = 0.8748, lr_0 = 1.3144e-04
Validation auc = 0.897436
Epoch 26
Loss = 7.1654e-02, PNorm = 64.1450, GNorm = 0.5117, lr_0 = 1.2826e-04
Loss = 4.5161e-02, PNorm = 64.1609, GNorm = 0.7561, lr_0 = 1.2545e-04
Loss = 3.9980e-02, PNorm = 64.1797, GNorm = 0.3285, lr_0 = 1.2269e-04
Validation auc = 0.886878
Epoch 27
Loss = 2.9453e-02, PNorm = 64.1900, GNorm = 0.3990, lr_0 = 1.1973e-04
Loss = 5.5831e-02, PNorm = 64.2030, GNorm = 0.6157, lr_0 = 1.1709e-04
Loss = 3.2984e-02, PNorm = 64.2184, GNorm = 0.4909, lr_0 = 1.1452e-04
Loss = 4.0588e-02, PNorm = 64.2302, GNorm = 0.5239, lr_0 = 1.1200e-04
Validation auc = 0.894042
Epoch 28
Loss = 3.5763e-02, PNorm = 64.2404, GNorm = 0.5850, lr_0 = 1.0954e-04
Loss = 2.6795e-02, PNorm = 64.2538, GNorm = 0.2879, lr_0 = 1.0713e-04
Loss = 4.5074e-02, PNorm = 64.2635, GNorm = 0.8281, lr_0 = 1.0478e-04
Loss = 3.6082e-02, PNorm = 64.2726, GNorm = 0.3687, lr_0 = 1.0247e-04
Validation auc = 0.900452
Epoch 29
Loss = 3.7955e-02, PNorm = 64.2841, GNorm = 0.5075, lr_0 = 1.0000e-04
Loss = 3.8079e-02, PNorm = 64.2982, GNorm = 0.8054, lr_0 = 1.0000e-04
Loss = 3.8294e-02, PNorm = 64.3061, GNorm = 0.6773, lr_0 = 1.0000e-04
Loss = 4.2335e-02, PNorm = 64.3152, GNorm = 0.2499, lr_0 = 1.0000e-04
Loss = 6.8615e-03, PNorm = 64.3167, GNorm = 0.2070, lr_0 = 1.0000e-04
Validation auc = 0.898567
Model 1 best validation auc = 0.900452 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 1 test auc = 0.954464
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 2.9925e-01, PNorm = 59.4794, GNorm = 0.6031, lr_0 = 2.3378e-04
Loss = 2.2825e-01, PNorm = 59.5059, GNorm = 0.4718, lr_0 = 3.5541e-04
Loss = 2.3883e-01, PNorm = 59.5370, GNorm = 0.3065, lr_0 = 4.7703e-04
Validation auc = 0.731146
Epoch 1
Loss = 1.5972e-01, PNorm = 59.5757, GNorm = 0.2575, lr_0 = 6.1081e-04
Loss = 2.2197e-01, PNorm = 59.6168, GNorm = 0.3367, lr_0 = 7.3243e-04
Loss = 2.0185e-01, PNorm = 59.6634, GNorm = 0.5269, lr_0 = 8.5405e-04
Loss = 1.8140e-01, PNorm = 59.7314, GNorm = 1.0676, lr_0 = 9.7568e-04
Validation auc = 0.764329
Epoch 2
Loss = 2.5308e-01, PNorm = 59.8148, GNorm = 0.6017, lr_0 = 9.8020e-04
Loss = 1.7299e-01, PNorm = 59.8988, GNorm = 0.2698, lr_0 = 9.5865e-04
Loss = 2.0434e-01, PNorm = 59.9657, GNorm = 0.7035, lr_0 = 9.3758e-04
Loss = 1.6826e-01, PNorm = 60.0468, GNorm = 0.3741, lr_0 = 9.1697e-04
Validation auc = 0.752262
Epoch 3
Loss = 1.3323e-01, PNorm = 60.1448, GNorm = 0.2528, lr_0 = 8.9681e-04
Loss = 1.6998e-01, PNorm = 60.2251, GNorm = 0.8972, lr_0 = 8.7710e-04
Loss = 1.5683e-01, PNorm = 60.2959, GNorm = 0.2442, lr_0 = 8.5782e-04
Validation auc = 0.761689
Epoch 4
Loss = 1.2875e-01, PNorm = 60.3624, GNorm = 0.8669, lr_0 = 8.3710e-04
Loss = 1.4777e-01, PNorm = 60.4440, GNorm = 1.0945, lr_0 = 8.1870e-04
Loss = 1.8325e-01, PNorm = 60.5138, GNorm = 0.3142, lr_0 = 8.0071e-04
Loss = 1.7328e-01, PNorm = 60.6097, GNorm = 0.8716, lr_0 = 7.8311e-04
Validation auc = 0.757541
Epoch 5
Loss = 1.6018e-01, PNorm = 60.6754, GNorm = 0.3356, lr_0 = 7.6420e-04
Loss = 1.7178e-01, PNorm = 60.7589, GNorm = 0.4400, lr_0 = 7.4740e-04
Loss = 1.4679e-01, PNorm = 60.8353, GNorm = 0.5283, lr_0 = 7.3097e-04
Loss = 1.5970e-01, PNorm = 60.9098, GNorm = 0.2604, lr_0 = 7.1490e-04
Validation auc = 0.751131
Epoch 6
Loss = 1.5589e-01, PNorm = 60.9737, GNorm = 0.7302, lr_0 = 6.9919e-04
Loss = 1.6612e-01, PNorm = 61.0611, GNorm = 0.7937, lr_0 = 6.8382e-04
Loss = 1.3222e-01, PNorm = 61.1269, GNorm = 0.2503, lr_0 = 6.6879e-04
Loss = 1.5085e-01, PNorm = 61.1814, GNorm = 0.2903, lr_0 = 6.5409e-04
Validation auc = 0.753394
Epoch 7
Loss = 1.8681e-01, PNorm = 61.2889, GNorm = 0.9677, lr_0 = 6.3829e-04
Loss = 1.2922e-01, PNorm = 61.3827, GNorm = 0.3367, lr_0 = 6.2426e-04
Loss = 1.3359e-01, PNorm = 61.4707, GNorm = 0.2453, lr_0 = 6.1054e-04
Validation auc = 0.776772
Epoch 8
Loss = 6.2782e-02, PNorm = 61.5426, GNorm = 0.2418, lr_0 = 5.9579e-04
Loss = 1.2381e-01, PNorm = 61.6070, GNorm = 0.2762, lr_0 = 5.8270e-04
Loss = 1.2800e-01, PNorm = 61.6879, GNorm = 0.7634, lr_0 = 5.6989e-04
Loss = 1.4515e-01, PNorm = 61.7518, GNorm = 0.3284, lr_0 = 5.5736e-04
Validation auc = 0.775641
Epoch 9
Loss = 1.4004e-01, PNorm = 61.8501, GNorm = 0.2778, lr_0 = 5.4511e-04
Loss = 1.1228e-01, PNorm = 61.9293, GNorm = 0.3025, lr_0 = 5.3313e-04
Loss = 1.5147e-01, PNorm = 62.0123, GNorm = 0.4119, lr_0 = 5.2141e-04
Loss = 1.5329e-01, PNorm = 62.0591, GNorm = 0.2970, lr_0 = 5.0995e-04
Validation auc = 0.760935
Epoch 10
Loss = 1.2676e-01, PNorm = 62.1294, GNorm = 0.5103, lr_0 = 4.9764e-04
Loss = 1.1966e-01, PNorm = 62.1794, GNorm = 0.3501, lr_0 = 4.8670e-04
Loss = 1.3739e-01, PNorm = 62.2425, GNorm = 0.3295, lr_0 = 4.7600e-04
Loss = 1.0978e-01, PNorm = 62.3018, GNorm = 0.7269, lr_0 = 4.6554e-04
Loss = 6.4149e-02, PNorm = 62.3071, GNorm = 0.6839, lr_0 = 4.6450e-04
Validation auc = 0.850302
Epoch 11
Loss = 1.0804e-01, PNorm = 62.3588, GNorm = 0.2630, lr_0 = 4.5429e-04
Loss = 1.2170e-01, PNorm = 62.4230, GNorm = 0.6408, lr_0 = 4.4431e-04
Loss = 1.2744e-01, PNorm = 62.4783, GNorm = 0.2591, lr_0 = 4.3454e-04
Validation auc = 0.876320
Epoch 12
Loss = 1.2673e-01, PNorm = 62.5431, GNorm = 0.2469, lr_0 = 4.2499e-04
Loss = 1.1791e-01, PNorm = 62.6035, GNorm = 0.6230, lr_0 = 4.1565e-04
Loss = 1.1020e-01, PNorm = 62.6676, GNorm = 0.3097, lr_0 = 4.0651e-04
Loss = 1.2159e-01, PNorm = 62.7234, GNorm = 0.2635, lr_0 = 3.9758e-04
Validation auc = 0.885370
Epoch 13
Loss = 7.6210e-02, PNorm = 62.7901, GNorm = 0.7331, lr_0 = 3.8797e-04
Loss = 8.4898e-02, PNorm = 62.8533, GNorm = 0.1450, lr_0 = 3.7945e-04
Loss = 1.4348e-01, PNorm = 62.9015, GNorm = 0.6040, lr_0 = 3.7111e-04
Loss = 8.6812e-02, PNorm = 62.9512, GNorm = 0.3154, lr_0 = 3.6295e-04
Validation auc = 0.884615
Epoch 14
Loss = 1.1605e-01, PNorm = 62.9990, GNorm = 0.3344, lr_0 = 3.5497e-04
Loss = 9.2715e-02, PNorm = 63.0495, GNorm = 0.5599, lr_0 = 3.4717e-04
Loss = 1.0936e-01, PNorm = 63.0998, GNorm = 0.4881, lr_0 = 3.3954e-04
Loss = 1.2631e-01, PNorm = 63.1474, GNorm = 0.4778, lr_0 = 3.3207e-04
Loss = 7.6495e-02, PNorm = 63.1535, GNorm = 0.6718, lr_0 = 3.3134e-04
Validation auc = 0.890649
Epoch 15
Loss = 1.0504e-01, PNorm = 63.2014, GNorm = 0.7149, lr_0 = 3.2405e-04
Loss = 1.0991e-01, PNorm = 63.2547, GNorm = 0.4182, lr_0 = 3.1693e-04
Loss = 9.2199e-02, PNorm = 63.2961, GNorm = 0.7481, lr_0 = 3.0997e-04
Validation auc = 0.897813
Epoch 16
Loss = 5.4362e-02, PNorm = 63.3415, GNorm = 0.3439, lr_0 = 3.0248e-04
Loss = 9.8950e-02, PNorm = 63.3828, GNorm = 0.6982, lr_0 = 2.9583e-04
Loss = 9.7785e-02, PNorm = 63.4388, GNorm = 0.1184, lr_0 = 2.8933e-04
Loss = 1.0940e-01, PNorm = 63.4723, GNorm = 0.4851, lr_0 = 2.8297e-04
Validation auc = 0.897813
Epoch 17
Loss = 1.1086e-01, PNorm = 63.5121, GNorm = 0.5002, lr_0 = 2.7675e-04
Loss = 1.0281e-01, PNorm = 63.5455, GNorm = 0.3205, lr_0 = 2.7067e-04
Loss = 9.4674e-02, PNorm = 63.5917, GNorm = 0.2915, lr_0 = 2.6472e-04
Loss = 5.3769e-02, PNorm = 63.6326, GNorm = 0.1620, lr_0 = 2.5890e-04
Validation auc = 0.892534
Epoch 18
Loss = 9.6725e-02, PNorm = 63.6716, GNorm = 0.7010, lr_0 = 2.5264e-04
Loss = 6.4253e-02, PNorm = 63.7162, GNorm = 0.3141, lr_0 = 2.4709e-04
Loss = 7.9840e-02, PNorm = 63.7496, GNorm = 0.9368, lr_0 = 2.4166e-04
Validation auc = 0.898190
Epoch 19
Loss = 1.3155e-01, PNorm = 63.7858, GNorm = 0.6023, lr_0 = 2.3582e-04
Loss = 9.4606e-02, PNorm = 63.8255, GNorm = 0.5752, lr_0 = 2.3064e-04
Loss = 4.7240e-02, PNorm = 63.8657, GNorm = 0.1773, lr_0 = 2.2557e-04
Loss = 9.6484e-02, PNorm = 63.8927, GNorm = 0.7093, lr_0 = 2.2061e-04
Validation auc = 0.896682
Epoch 20
Loss = 1.0084e-01, PNorm = 63.9277, GNorm = 1.0039, lr_0 = 2.1576e-04
Loss = 6.9470e-02, PNorm = 63.9657, GNorm = 0.4450, lr_0 = 2.1102e-04
Loss = 6.9868e-02, PNorm = 63.9949, GNorm = 0.3464, lr_0 = 2.0638e-04
Loss = 5.0975e-02, PNorm = 64.0205, GNorm = 0.5681, lr_0 = 2.0185e-04
Validation auc = 0.899698
Epoch 21
Loss = 5.0608e-02, PNorm = 64.0489, GNorm = 0.3548, lr_0 = 1.9697e-04
Loss = 4.9000e-02, PNorm = 64.0845, GNorm = 0.3763, lr_0 = 1.9264e-04
Loss = 7.7220e-02, PNorm = 64.1052, GNorm = 0.4176, lr_0 = 1.8841e-04
Loss = 9.1451e-02, PNorm = 64.1429, GNorm = 0.7168, lr_0 = 1.8427e-04
Validation auc = 0.855958
Epoch 22
Loss = 5.5341e-02, PNorm = 64.1699, GNorm = 0.6241, lr_0 = 1.7982e-04
Loss = 7.2723e-02, PNorm = 64.1934, GNorm = 0.3712, lr_0 = 1.7586e-04
Loss = 5.8776e-02, PNorm = 64.2294, GNorm = 0.2005, lr_0 = 1.7200e-04
Validation auc = 0.898190
Epoch 23
Loss = 5.8255e-02, PNorm = 64.2430, GNorm = 0.4147, lr_0 = 1.6822e-04
Loss = 6.6955e-02, PNorm = 64.2758, GNorm = 0.3082, lr_0 = 1.6452e-04
Loss = 4.8639e-02, PNorm = 64.3001, GNorm = 0.3648, lr_0 = 1.6090e-04
Loss = 7.9457e-02, PNorm = 64.3182, GNorm = 0.6728, lr_0 = 1.5737e-04
Validation auc = 0.889140
Epoch 24
Loss = 6.6015e-02, PNorm = 64.3479, GNorm = 0.6949, lr_0 = 1.5357e-04
Loss = 6.5537e-02, PNorm = 64.3676, GNorm = 0.6445, lr_0 = 1.5019e-04
Loss = 3.8002e-02, PNorm = 64.3929, GNorm = 0.2021, lr_0 = 1.4689e-04
Loss = 5.4838e-02, PNorm = 64.4134, GNorm = 0.4545, lr_0 = 1.4366e-04
Validation auc = 0.894419
Epoch 25
Loss = 6.2697e-02, PNorm = 64.4335, GNorm = 0.2269, lr_0 = 1.4050e-04
Loss = 3.2442e-02, PNorm = 64.4634, GNorm = 0.0687, lr_0 = 1.3741e-04
Loss = 7.7795e-02, PNorm = 64.4755, GNorm = 0.7909, lr_0 = 1.3439e-04
Loss = 6.5063e-02, PNorm = 64.5017, GNorm = 0.2985, lr_0 = 1.3144e-04
Validation auc = 0.887255
Epoch 26
Loss = 5.0326e-02, PNorm = 64.5225, GNorm = 0.3622, lr_0 = 1.2826e-04
Loss = 3.7718e-02, PNorm = 64.5395, GNorm = 0.2049, lr_0 = 1.2545e-04
Loss = 5.2264e-02, PNorm = 64.5572, GNorm = 0.5154, lr_0 = 1.2269e-04
Validation auc = 0.893665
Epoch 27
Loss = 3.7797e-02, PNorm = 64.5786, GNorm = 0.4273, lr_0 = 1.1973e-04
Loss = 3.1760e-02, PNorm = 64.5901, GNorm = 0.5690, lr_0 = 1.1709e-04
Loss = 6.5371e-02, PNorm = 64.6103, GNorm = 1.1031, lr_0 = 1.1452e-04
Loss = 4.2933e-02, PNorm = 64.6197, GNorm = 0.5979, lr_0 = 1.1200e-04
Validation auc = 0.892157
Epoch 28
Loss = 4.1091e-02, PNorm = 64.6374, GNorm = 0.2108, lr_0 = 1.0954e-04
Loss = 4.2609e-02, PNorm = 64.6516, GNorm = 0.4652, lr_0 = 1.0713e-04
Loss = 2.8815e-02, PNorm = 64.6681, GNorm = 0.1995, lr_0 = 1.0478e-04
Loss = 4.5283e-02, PNorm = 64.6813, GNorm = 0.5685, lr_0 = 1.0247e-04
Validation auc = 0.894796
Epoch 29
Loss = 4.0330e-02, PNorm = 64.6935, GNorm = 0.6275, lr_0 = 1.0000e-04
Loss = 4.2862e-02, PNorm = 64.7117, GNorm = 0.5040, lr_0 = 1.0000e-04
Loss = 4.2167e-02, PNorm = 64.7234, GNorm = 1.3901, lr_0 = 1.0000e-04
Loss = 4.1658e-02, PNorm = 64.7395, GNorm = 0.1346, lr_0 = 1.0000e-04
Loss = 7.5758e-03, PNorm = 64.7409, GNorm = 0.1913, lr_0 = 1.0000e-04
Validation auc = 0.879336
Model 2 best validation auc = 0.899698 on epoch 20
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 2 test auc = 0.950893
Ensemble test auc = 0.947768
Fold 8
Splitting data with seed 8
Class sizes
hit 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 1,868 | val size = 233 | test size = 234
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 2.7658e-01, PNorm = 59.4432, GNorm = 0.5906, lr_0 = 2.3378e-04
Loss = 2.3190e-01, PNorm = 59.4637, GNorm = 0.5152, lr_0 = 3.5541e-04
Loss = 2.1671e-01, PNorm = 59.4905, GNorm = 0.3552, lr_0 = 4.7703e-04
Validation auc = 0.695000
Epoch 1
Loss = 2.5070e-01, PNorm = 59.5310, GNorm = 0.8813, lr_0 = 6.1081e-04
Loss = 1.9847e-01, PNorm = 59.5815, GNorm = 0.6117, lr_0 = 7.3243e-04
Loss = 2.4922e-01, PNorm = 59.6379, GNorm = 0.7262, lr_0 = 8.5405e-04
Loss = 1.7438e-01, PNorm = 59.7127, GNorm = 0.2962, lr_0 = 9.7568e-04
Validation auc = 0.838889
Epoch 2
Loss = 2.2634e-01, PNorm = 59.8081, GNorm = 0.2811, lr_0 = 9.8020e-04
Loss = 1.9146e-01, PNorm = 59.8941, GNorm = 0.4337, lr_0 = 9.5865e-04
Loss = 2.2445e-01, PNorm = 59.9511, GNorm = 0.4293, lr_0 = 9.3758e-04
Loss = 1.4460e-01, PNorm = 60.0308, GNorm = 0.3616, lr_0 = 9.1697e-04
Validation auc = 0.847222
Epoch 3
Loss = 1.6696e-01, PNorm = 60.0930, GNorm = 0.3042, lr_0 = 8.9681e-04
Loss = 1.5768e-01, PNorm = 60.1497, GNorm = 0.3886, lr_0 = 8.7710e-04
Loss = 2.0733e-01, PNorm = 60.2160, GNorm = 0.2296, lr_0 = 8.5782e-04
Validation auc = 0.886667
Epoch 4
Loss = 9.4794e-02, PNorm = 60.3022, GNorm = 0.4553, lr_0 = 8.3710e-04
Loss = 1.6270e-01, PNorm = 60.3884, GNorm = 0.7433, lr_0 = 8.1870e-04
Loss = 1.5610e-01, PNorm = 60.4670, GNorm = 0.3415, lr_0 = 8.0071e-04
Loss = 1.9830e-01, PNorm = 60.5402, GNorm = 0.4290, lr_0 = 7.8311e-04
Validation auc = 0.842778
Epoch 5
Loss = 1.2951e-01, PNorm = 60.6412, GNorm = 0.5261, lr_0 = 7.6420e-04
Loss = 1.5495e-01, PNorm = 60.7216, GNorm = 0.3322, lr_0 = 7.4740e-04
Loss = 1.5545e-01, PNorm = 60.8106, GNorm = 0.8042, lr_0 = 7.3097e-04
Loss = 1.3892e-01, PNorm = 60.8921, GNorm = 0.6171, lr_0 = 7.1490e-04
Validation auc = 0.881111
Epoch 6
Loss = 1.5665e-01, PNorm = 60.9865, GNorm = 0.3831, lr_0 = 6.9919e-04
Loss = 1.6416e-01, PNorm = 61.0586, GNorm = 0.5816, lr_0 = 6.8382e-04
Loss = 1.6515e-01, PNorm = 61.1498, GNorm = 0.2492, lr_0 = 6.6879e-04
Loss = 1.7963e-01, PNorm = 61.2188, GNorm = 0.2714, lr_0 = 6.5409e-04
Validation auc = 0.896667
Epoch 7
Loss = 1.5334e-01, PNorm = 61.2972, GNorm = 0.3263, lr_0 = 6.3829e-04
Loss = 1.3676e-01, PNorm = 61.3711, GNorm = 0.3606, lr_0 = 6.2426e-04
Loss = 1.5357e-01, PNorm = 61.4248, GNorm = 0.3587, lr_0 = 6.1054e-04
Validation auc = 0.951111
Epoch 8
Loss = 2.1114e-01, PNorm = 61.4804, GNorm = 0.4024, lr_0 = 5.9579e-04
Loss = 1.2335e-01, PNorm = 61.5411, GNorm = 0.2587, lr_0 = 5.8270e-04
Loss = 1.5969e-01, PNorm = 61.6092, GNorm = 0.6140, lr_0 = 5.6989e-04
Loss = 1.3162e-01, PNorm = 61.6687, GNorm = 0.3116, lr_0 = 5.5736e-04
Validation auc = 0.933889
Epoch 9
Loss = 1.8497e-01, PNorm = 61.7284, GNorm = 0.7014, lr_0 = 5.4511e-04
Loss = 1.1310e-01, PNorm = 61.7901, GNorm = 0.3323, lr_0 = 5.3313e-04
Loss = 9.9715e-02, PNorm = 61.8579, GNorm = 0.3750, lr_0 = 5.2141e-04
Loss = 1.3952e-01, PNorm = 61.9113, GNorm = 0.7627, lr_0 = 5.0995e-04
Validation auc = 0.941667
Epoch 10
Loss = 1.2212e-01, PNorm = 61.9736, GNorm = 0.2674, lr_0 = 4.9764e-04
Loss = 1.1986e-01, PNorm = 62.0584, GNorm = 0.2629, lr_0 = 4.8670e-04
Loss = 1.5835e-01, PNorm = 62.1444, GNorm = 0.3666, lr_0 = 4.7600e-04
Loss = 1.6170e-01, PNorm = 62.2018, GNorm = 0.4455, lr_0 = 4.6554e-04
Loss = 6.4587e-02, PNorm = 62.2071, GNorm = 0.6529, lr_0 = 4.6450e-04
Validation auc = 0.916111
Epoch 11
Loss = 1.3745e-01, PNorm = 62.2785, GNorm = 0.2675, lr_0 = 4.5429e-04
Loss = 1.1505e-01, PNorm = 62.3347, GNorm = 0.2222, lr_0 = 4.4431e-04
Loss = 1.3968e-01, PNorm = 62.3837, GNorm = 0.4966, lr_0 = 4.3454e-04
Validation auc = 0.953889
Epoch 12
Loss = 6.2681e-02, PNorm = 62.4335, GNorm = 0.1619, lr_0 = 4.2499e-04
Loss = 9.6585e-02, PNorm = 62.4727, GNorm = 0.7209, lr_0 = 4.1565e-04
Loss = 1.2896e-01, PNorm = 62.4987, GNorm = 0.4028, lr_0 = 4.0651e-04
Loss = 1.3847e-01, PNorm = 62.5393, GNorm = 0.3832, lr_0 = 3.9758e-04
Validation auc = 0.951111
Epoch 13
Loss = 1.3527e-01, PNorm = 62.6019, GNorm = 0.7481, lr_0 = 3.8797e-04
Loss = 1.5673e-01, PNorm = 62.6551, GNorm = 0.3590, lr_0 = 3.7945e-04
Loss = 1.2159e-01, PNorm = 62.6987, GNorm = 0.2203, lr_0 = 3.7111e-04
Loss = 6.4324e-02, PNorm = 62.7403, GNorm = 0.8921, lr_0 = 3.6295e-04
Validation auc = 0.947778
Epoch 14
Loss = 1.1413e-01, PNorm = 62.7583, GNorm = 0.3114, lr_0 = 3.5497e-04
Loss = 1.3064e-01, PNorm = 62.7931, GNorm = 0.5683, lr_0 = 3.4717e-04
Loss = 9.6262e-02, PNorm = 62.8385, GNorm = 0.2839, lr_0 = 3.3954e-04
Loss = 1.0891e-01, PNorm = 62.8770, GNorm = 0.4696, lr_0 = 3.3207e-04
Loss = 1.9146e-01, PNorm = 62.8811, GNorm = 1.2209, lr_0 = 3.3134e-04
Validation auc = 0.945556
Epoch 15
Loss = 9.5487e-02, PNorm = 62.9340, GNorm = 0.3389, lr_0 = 3.2405e-04
Loss = 9.9355e-02, PNorm = 62.9662, GNorm = 0.3411, lr_0 = 3.1693e-04
Loss = 1.1255e-01, PNorm = 63.0089, GNorm = 0.5750, lr_0 = 3.0997e-04
Validation auc = 0.940000
Epoch 16
Loss = 1.0055e-01, PNorm = 63.0505, GNorm = 0.7754, lr_0 = 3.0248e-04
Loss = 1.0405e-01, PNorm = 63.0846, GNorm = 0.8474, lr_0 = 2.9583e-04
Loss = 7.0884e-02, PNorm = 63.1310, GNorm = 0.1740, lr_0 = 2.8933e-04
Loss = 1.3211e-01, PNorm = 63.1616, GNorm = 0.7825, lr_0 = 2.8297e-04
Validation auc = 0.952778
Epoch 17
Loss = 6.0868e-02, PNorm = 63.2021, GNorm = 0.1954, lr_0 = 2.7675e-04
Loss = 1.0631e-01, PNorm = 63.2288, GNorm = 0.6559, lr_0 = 2.7067e-04
Loss = 1.0032e-01, PNorm = 63.2624, GNorm = 0.6431, lr_0 = 2.6472e-04
Loss = 8.9728e-02, PNorm = 63.2952, GNorm = 0.6758, lr_0 = 2.5890e-04
Validation auc = 0.958889
Epoch 18
Loss = 8.0744e-02, PNorm = 63.3248, GNorm = 0.4197, lr_0 = 2.5264e-04
Loss = 7.9309e-02, PNorm = 63.3573, GNorm = 0.1566, lr_0 = 2.4709e-04
Loss = 7.4807e-02, PNorm = 63.3889, GNorm = 0.3577, lr_0 = 2.4166e-04
Validation auc = 0.941111
Epoch 19
Loss = 6.1315e-02, PNorm = 63.4223, GNorm = 0.3426, lr_0 = 2.3582e-04
Loss = 7.4990e-02, PNorm = 63.4521, GNorm = 0.4234, lr_0 = 2.3064e-04
Loss = 5.4198e-02, PNorm = 63.4811, GNorm = 0.1374, lr_0 = 2.2557e-04
Loss = 1.0177e-01, PNorm = 63.5127, GNorm = 0.2276, lr_0 = 2.2061e-04
Validation auc = 0.952778
Epoch 20
Loss = 5.7561e-02, PNorm = 63.5411, GNorm = 0.4389, lr_0 = 2.1576e-04
Loss = 9.3993e-02, PNorm = 63.5739, GNorm = 0.4410, lr_0 = 2.1102e-04
Loss = 1.0269e-01, PNorm = 63.5995, GNorm = 0.5633, lr_0 = 2.0638e-04
Loss = 8.8295e-02, PNorm = 63.6242, GNorm = 0.6764, lr_0 = 2.0185e-04
Validation auc = 0.960556
Epoch 21
Loss = 5.8820e-02, PNorm = 63.6474, GNorm = 0.4081, lr_0 = 1.9697e-04
Loss = 9.2187e-02, PNorm = 63.6716, GNorm = 0.2945, lr_0 = 1.9264e-04
Loss = 7.8375e-02, PNorm = 63.6991, GNorm = 0.4552, lr_0 = 1.8841e-04
Loss = 7.6174e-02, PNorm = 63.7131, GNorm = 0.3608, lr_0 = 1.8427e-04
Validation auc = 0.961667
Epoch 22
Loss = 7.1235e-02, PNorm = 63.7325, GNorm = 0.3234, lr_0 = 1.7982e-04
Loss = 6.1777e-02, PNorm = 63.7544, GNorm = 0.4454, lr_0 = 1.7586e-04
Loss = 8.9090e-02, PNorm = 63.7734, GNorm = 1.4193, lr_0 = 1.7200e-04
Validation auc = 0.966667
Epoch 23
Loss = 7.5347e-02, PNorm = 63.7956, GNorm = 0.4378, lr_0 = 1.6822e-04
Loss = 7.0271e-02, PNorm = 63.8153, GNorm = 0.6022, lr_0 = 1.6452e-04
Loss = 6.0992e-02, PNorm = 63.8372, GNorm = 0.6856, lr_0 = 1.6090e-04
Loss = 6.6371e-02, PNorm = 63.8487, GNorm = 0.2261, lr_0 = 1.5737e-04
Validation auc = 0.960000
Epoch 24
Loss = 7.1854e-02, PNorm = 63.8729, GNorm = 0.6907, lr_0 = 1.5357e-04
Loss = 6.5680e-02, PNorm = 63.8922, GNorm = 0.7723, lr_0 = 1.5019e-04
Loss = 5.3105e-02, PNorm = 63.9147, GNorm = 0.7354, lr_0 = 1.4689e-04
Loss = 7.0024e-02, PNorm = 63.9301, GNorm = 0.4465, lr_0 = 1.4366e-04
Validation auc = 0.950556
Epoch 25
Loss = 3.6378e-02, PNorm = 63.9468, GNorm = 0.3345, lr_0 = 1.4050e-04
Loss = 4.1437e-02, PNorm = 63.9639, GNorm = 0.4205, lr_0 = 1.3741e-04
Loss = 6.8002e-02, PNorm = 63.9809, GNorm = 1.0282, lr_0 = 1.3439e-04
Loss = 7.2684e-02, PNorm = 63.9940, GNorm = 0.5669, lr_0 = 1.3144e-04
Validation auc = 0.956111
Epoch 26
Loss = 6.5560e-02, PNorm = 64.0095, GNorm = 0.6948, lr_0 = 1.2826e-04
Loss = 3.8665e-02, PNorm = 64.0305, GNorm = 0.4195, lr_0 = 1.2545e-04
Loss = 6.1303e-02, PNorm = 64.0433, GNorm = 0.9543, lr_0 = 1.2269e-04
Validation auc = 0.956111
Epoch 27
Loss = 6.2513e-02, PNorm = 64.0621, GNorm = 0.9627, lr_0 = 1.1973e-04
Loss = 6.6311e-02, PNorm = 64.0743, GNorm = 0.6241, lr_0 = 1.1709e-04
Loss = 4.5187e-02, PNorm = 64.0893, GNorm = 0.3575, lr_0 = 1.1452e-04
Loss = 4.2811e-02, PNorm = 64.1019, GNorm = 0.4653, lr_0 = 1.1200e-04
Validation auc = 0.955556
Epoch 28
Loss = 6.6247e-02, PNorm = 64.1149, GNorm = 0.7866, lr_0 = 1.0954e-04
Loss = 3.6805e-02, PNorm = 64.1249, GNorm = 0.5960, lr_0 = 1.0713e-04
Loss = 6.3023e-02, PNorm = 64.1387, GNorm = 0.4319, lr_0 = 1.0478e-04
Loss = 4.7004e-02, PNorm = 64.1496, GNorm = 0.5239, lr_0 = 1.0247e-04
Validation auc = 0.949444
Epoch 29
Loss = 2.9425e-02, PNorm = 64.1578, GNorm = 0.5658, lr_0 = 1.0000e-04
Loss = 4.5002e-02, PNorm = 64.1696, GNorm = 0.3079, lr_0 = 1.0000e-04
Loss = 4.5157e-02, PNorm = 64.1837, GNorm = 0.3319, lr_0 = 1.0000e-04
Loss = 6.8193e-02, PNorm = 64.1921, GNorm = 2.1016, lr_0 = 1.0000e-04
Loss = 4.0115e-03, PNorm = 64.1921, GNorm = 0.1529, lr_0 = 1.0000e-04
Validation auc = 0.951111
Model 0 best validation auc = 0.966667 on epoch 22
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = 0.945679
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 3.0788e-01, PNorm = 59.4707, GNorm = 0.4287, lr_0 = 2.3378e-04
Loss = 2.2623e-01, PNorm = 59.4976, GNorm = 0.8237, lr_0 = 3.5541e-04
Loss = 2.1809e-01, PNorm = 59.5273, GNorm = 0.6245, lr_0 = 4.7703e-04
Validation auc = 0.814444
Epoch 1
Loss = 2.0590e-01, PNorm = 59.5600, GNorm = 0.4318, lr_0 = 6.1081e-04
Loss = 1.5762e-01, PNorm = 59.5951, GNorm = 0.3127, lr_0 = 7.3243e-04
Loss = 1.9998e-01, PNorm = 59.6381, GNorm = 0.2236, lr_0 = 8.5405e-04
Loss = 2.7579e-01, PNorm = 59.6821, GNorm = 0.9697, lr_0 = 9.7568e-04
Validation auc = 0.825556
Epoch 2
Loss = 2.7390e-01, PNorm = 59.7579, GNorm = 0.5069, lr_0 = 9.8020e-04
Loss = 1.7238e-01, PNorm = 59.8300, GNorm = 0.2604, lr_0 = 9.5865e-04
Loss = 1.7791e-01, PNorm = 59.8785, GNorm = 0.3573, lr_0 = 9.3758e-04
Loss = 1.7498e-01, PNorm = 59.9406, GNorm = 0.3849, lr_0 = 9.1697e-04
Validation auc = 0.832778
Epoch 3
Loss = 1.9317e-01, PNorm = 60.0019, GNorm = 0.3906, lr_0 = 8.9681e-04
Loss = 1.9822e-01, PNorm = 60.0679, GNorm = 0.5336, lr_0 = 8.7710e-04
Loss = 1.7416e-01, PNorm = 60.1570, GNorm = 0.2671, lr_0 = 8.5782e-04
Validation auc = 0.878333
Epoch 4
Loss = 1.6268e-01, PNorm = 60.2232, GNorm = 0.3949, lr_0 = 8.3710e-04
Loss = 1.5302e-01, PNorm = 60.2802, GNorm = 0.1847, lr_0 = 8.1870e-04
Loss = 1.7278e-01, PNorm = 60.3180, GNorm = 0.4519, lr_0 = 8.0071e-04
Loss = 1.9368e-01, PNorm = 60.3795, GNorm = 0.6755, lr_0 = 7.8311e-04
Validation auc = 0.850000
Epoch 5
Loss = 1.5558e-01, PNorm = 60.4364, GNorm = 0.3290, lr_0 = 7.6420e-04
Loss = 1.7264e-01, PNorm = 60.4908, GNorm = 0.7843, lr_0 = 7.4740e-04
Loss = 1.4052e-01, PNorm = 60.5661, GNorm = 0.1717, lr_0 = 7.3097e-04
Loss = 2.0805e-01, PNorm = 60.6053, GNorm = 0.2813, lr_0 = 7.1490e-04
Validation auc = 0.881667
Epoch 6
Loss = 1.6832e-01, PNorm = 60.6810, GNorm = 0.3572, lr_0 = 6.9919e-04
Loss = 1.3053e-01, PNorm = 60.7664, GNorm = 0.2629, lr_0 = 6.8382e-04
Loss = 1.4221e-01, PNorm = 60.8404, GNorm = 0.4146, lr_0 = 6.6879e-04
Loss = 2.0858e-01, PNorm = 60.8871, GNorm = 0.3196, lr_0 = 6.5409e-04
Validation auc = 0.885556
Epoch 7
Loss = 1.8408e-01, PNorm = 60.9370, GNorm = 0.3958, lr_0 = 6.3829e-04
Loss = 1.6133e-01, PNorm = 61.0171, GNorm = 0.3564, lr_0 = 6.2426e-04
Loss = 1.1678e-01, PNorm = 61.1031, GNorm = 0.5570, lr_0 = 6.1054e-04
Validation auc = 0.863889
Epoch 8
Loss = 1.2723e-01, PNorm = 61.1655, GNorm = 0.4060, lr_0 = 5.9579e-04
Loss = 1.2092e-01, PNorm = 61.2290, GNorm = 0.1844, lr_0 = 5.8270e-04
Loss = 1.6266e-01, PNorm = 61.2752, GNorm = 0.6541, lr_0 = 5.6989e-04
Loss = 1.9257e-01, PNorm = 61.3457, GNorm = 0.3663, lr_0 = 5.5736e-04
Validation auc = 0.925556
Epoch 9
Loss = 1.3580e-01, PNorm = 61.4180, GNorm = 0.3702, lr_0 = 5.4511e-04
Loss = 1.3555e-01, PNorm = 61.4777, GNorm = 0.3760, lr_0 = 5.3313e-04
Loss = 1.7949e-01, PNorm = 61.5200, GNorm = 0.3128, lr_0 = 5.2141e-04
Loss = 1.4610e-01, PNorm = 61.6043, GNorm = 0.3529, lr_0 = 5.0995e-04
Validation auc = 0.917778
Epoch 10
Loss = 1.6092e-01, PNorm = 61.6746, GNorm = 0.5944, lr_0 = 4.9764e-04
Loss = 1.2309e-01, PNorm = 61.7296, GNorm = 0.8122, lr_0 = 4.8670e-04
Loss = 1.1656e-01, PNorm = 61.7635, GNorm = 0.5226, lr_0 = 4.7600e-04
Loss = 1.6827e-01, PNorm = 61.8146, GNorm = 0.2604, lr_0 = 4.6554e-04
Loss = 2.4135e-01, PNorm = 61.8203, GNorm = 0.7455, lr_0 = 4.6450e-04
Validation auc = 0.924444
Epoch 11
Loss = 1.6420e-01, PNorm = 61.8718, GNorm = 0.3083, lr_0 = 4.5429e-04
Loss = 9.9761e-02, PNorm = 61.9308, GNorm = 0.3925, lr_0 = 4.4431e-04
Loss = 1.2834e-01, PNorm = 61.9701, GNorm = 0.3543, lr_0 = 4.3454e-04
Validation auc = 0.945556
Epoch 12
Loss = 1.7497e-01, PNorm = 62.0111, GNorm = 0.5673, lr_0 = 4.2499e-04
Loss = 9.2152e-02, PNorm = 62.0560, GNorm = 0.3047, lr_0 = 4.1565e-04
Loss = 1.3218e-01, PNorm = 62.0981, GNorm = 0.4166, lr_0 = 4.0651e-04
Loss = 1.5495e-01, PNorm = 62.1404, GNorm = 0.6690, lr_0 = 3.9758e-04
Validation auc = 0.959444
Epoch 13
Loss = 1.3740e-01, PNorm = 62.1895, GNorm = 0.6125, lr_0 = 3.8797e-04
Loss = 1.3375e-01, PNorm = 62.2340, GNorm = 0.4146, lr_0 = 3.7945e-04
Loss = 1.2768e-01, PNorm = 62.2774, GNorm = 0.6012, lr_0 = 3.7111e-04
Loss = 1.1755e-01, PNorm = 62.3347, GNorm = 0.5967, lr_0 = 3.6295e-04
Validation auc = 0.940556
Epoch 14
Loss = 1.0712e-01, PNorm = 62.3753, GNorm = 0.8024, lr_0 = 3.5497e-04
Loss = 8.4521e-02, PNorm = 62.4194, GNorm = 0.1250, lr_0 = 3.4717e-04
Loss = 1.6874e-01, PNorm = 62.4477, GNorm = 0.3857, lr_0 = 3.3954e-04
Loss = 1.0993e-01, PNorm = 62.4994, GNorm = 0.3059, lr_0 = 3.3207e-04
Loss = 1.2238e-01, PNorm = 62.5026, GNorm = 0.8134, lr_0 = 3.3134e-04
Validation auc = 0.949444
Epoch 15
Loss = 1.2693e-01, PNorm = 62.5266, GNorm = 0.6464, lr_0 = 3.2405e-04
Loss = 1.1893e-01, PNorm = 62.5627, GNorm = 0.5589, lr_0 = 3.1693e-04
Loss = 8.8680e-02, PNorm = 62.5996, GNorm = 0.1981, lr_0 = 3.0997e-04
Validation auc = 0.941667
Epoch 16
Loss = 1.5486e-01, PNorm = 62.6370, GNorm = 0.3884, lr_0 = 3.0248e-04
Loss = 9.0198e-02, PNorm = 62.6796, GNorm = 0.4401, lr_0 = 2.9583e-04
Loss = 1.0025e-01, PNorm = 62.7159, GNorm = 0.2869, lr_0 = 2.8933e-04
Loss = 9.7151e-02, PNorm = 62.7469, GNorm = 0.2268, lr_0 = 2.8297e-04
Validation auc = 0.960000
Epoch 17
Loss = 8.7057e-02, PNorm = 62.7787, GNorm = 0.2749, lr_0 = 2.7675e-04
Loss = 9.4627e-02, PNorm = 62.8136, GNorm = 0.2145, lr_0 = 2.7067e-04
Loss = 9.9349e-02, PNorm = 62.8429, GNorm = 0.7690, lr_0 = 2.6472e-04
Loss = 1.2181e-01, PNorm = 62.8773, GNorm = 0.5754, lr_0 = 2.5890e-04
Validation auc = 0.940556
Epoch 18
Loss = 9.4935e-02, PNorm = 62.9084, GNorm = 0.5081, lr_0 = 2.5264e-04
Loss = 1.1585e-01, PNorm = 62.9408, GNorm = 0.3891, lr_0 = 2.4709e-04
Loss = 8.3055e-02, PNorm = 62.9678, GNorm = 0.2938, lr_0 = 2.4166e-04
Validation auc = 0.933333
Epoch 19
Loss = 9.3399e-02, PNorm = 62.9913, GNorm = 0.6986, lr_0 = 2.3582e-04
Loss = 6.5015e-02, PNorm = 63.0149, GNorm = 0.5225, lr_0 = 2.3064e-04
Loss = 9.9458e-02, PNorm = 63.0406, GNorm = 0.8674, lr_0 = 2.2557e-04
Loss = 1.2150e-01, PNorm = 63.0727, GNorm = 0.3534, lr_0 = 2.2061e-04
Validation auc = 0.945000
Epoch 20
Loss = 8.3096e-02, PNorm = 63.0988, GNorm = 0.6928, lr_0 = 2.1576e-04
Loss = 5.5637e-02, PNorm = 63.1251, GNorm = 0.6192, lr_0 = 2.1102e-04
Loss = 9.9823e-02, PNorm = 63.1524, GNorm = 0.3656, lr_0 = 2.0638e-04
Loss = 8.4686e-02, PNorm = 63.1793, GNorm = 0.3965, lr_0 = 2.0185e-04
Validation auc = 0.934444
Epoch 21
Loss = 1.1475e-01, PNorm = 63.2039, GNorm = 0.9847, lr_0 = 1.9697e-04
Loss = 1.0860e-01, PNorm = 63.2370, GNorm = 0.6744, lr_0 = 1.9264e-04
Loss = 8.2755e-02, PNorm = 63.2633, GNorm = 0.4581, lr_0 = 1.8841e-04
Loss = 6.2298e-02, PNorm = 63.2911, GNorm = 0.4604, lr_0 = 1.8427e-04
Validation auc = 0.943333
Epoch 22
Loss = 7.5285e-02, PNorm = 63.3112, GNorm = 0.4319, lr_0 = 1.7982e-04
Loss = 6.7996e-02, PNorm = 63.3371, GNorm = 0.4718, lr_0 = 1.7586e-04
Loss = 9.7136e-02, PNorm = 63.3507, GNorm = 0.4035, lr_0 = 1.7200e-04
Validation auc = 0.932778
Epoch 23
Loss = 5.8046e-02, PNorm = 63.3781, GNorm = 0.4399, lr_0 = 1.6822e-04
Loss = 9.5711e-02, PNorm = 63.3901, GNorm = 0.6712, lr_0 = 1.6452e-04
Loss = 7.8410e-02, PNorm = 63.4155, GNorm = 0.3575, lr_0 = 1.6090e-04
Loss = 5.7664e-02, PNorm = 63.4421, GNorm = 0.6493, lr_0 = 1.5737e-04
Validation auc = 0.935000
Epoch 24
Loss = 3.6694e-02, PNorm = 63.4574, GNorm = 0.1950, lr_0 = 1.5357e-04
Loss = 5.6342e-02, PNorm = 63.4765, GNorm = 0.7553, lr_0 = 1.5019e-04
Loss = 8.5646e-02, PNorm = 63.4866, GNorm = 1.1822, lr_0 = 1.4689e-04
Loss = 7.4690e-02, PNorm = 63.5147, GNorm = 0.6948, lr_0 = 1.4366e-04
Validation auc = 0.923333
Epoch 25
Loss = 6.6428e-02, PNorm = 63.5280, GNorm = 0.7252, lr_0 = 1.4050e-04
Loss = 7.4205e-02, PNorm = 63.5428, GNorm = 0.4537, lr_0 = 1.3741e-04
Loss = 6.8920e-02, PNorm = 63.5589, GNorm = 0.4015, lr_0 = 1.3439e-04
Loss = 5.1275e-02, PNorm = 63.5723, GNorm = 0.2788, lr_0 = 1.3144e-04
Validation auc = 0.922778
Epoch 26
Loss = 5.5833e-02, PNorm = 63.5893, GNorm = 0.1233, lr_0 = 1.2826e-04
Loss = 5.2853e-02, PNorm = 63.6037, GNorm = 0.1333, lr_0 = 1.2545e-04
Loss = 8.4445e-02, PNorm = 63.6132, GNorm = 0.6785, lr_0 = 1.2269e-04
Validation auc = 0.890000
Epoch 27
Loss = 1.2579e-02, PNorm = 63.6391, GNorm = 0.1670, lr_0 = 1.1973e-04
Loss = 6.5558e-02, PNorm = 63.6459, GNorm = 0.3895, lr_0 = 1.1709e-04
Loss = 7.9473e-02, PNorm = 63.6620, GNorm = 0.6152, lr_0 = 1.1452e-04
Loss = 6.9624e-02, PNorm = 63.6731, GNorm = 0.9316, lr_0 = 1.1200e-04
Validation auc = 0.926667
Epoch 28
Loss = 4.9588e-02, PNorm = 63.6868, GNorm = 0.3796, lr_0 = 1.0954e-04
Loss = 5.6950e-02, PNorm = 63.7006, GNorm = 0.2356, lr_0 = 1.0713e-04
Loss = 8.5935e-02, PNorm = 63.7121, GNorm = 0.8125, lr_0 = 1.0478e-04
Loss = 5.2878e-02, PNorm = 63.7276, GNorm = 0.7163, lr_0 = 1.0247e-04
Validation auc = 0.930556
Epoch 29
Loss = 3.5622e-02, PNorm = 63.7386, GNorm = 0.7545, lr_0 = 1.0000e-04
Loss = 3.9908e-02, PNorm = 63.7473, GNorm = 0.2628, lr_0 = 1.0000e-04
Loss = 8.5468e-02, PNorm = 63.7539, GNorm = 0.6319, lr_0 = 1.0000e-04
Loss = 6.0448e-02, PNorm = 63.7677, GNorm = 0.5485, lr_0 = 1.0000e-04
Loss = 2.4392e-01, PNorm = 63.7686, GNorm = 1.7438, lr_0 = 1.0000e-04
Validation auc = 0.894444
Model 1 best validation auc = 0.960000 on epoch 16
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 1 test auc = 0.957037
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 3.1205e-01, PNorm = 59.4782, GNorm = 0.5172, lr_0 = 2.3378e-04
Loss = 2.0322e-01, PNorm = 59.5074, GNorm = 1.0489, lr_0 = 3.5541e-04
Loss = 2.5780e-01, PNorm = 59.5351, GNorm = 0.4240, lr_0 = 4.7703e-04
Validation auc = 0.726111
Epoch 1
Loss = 2.3979e-01, PNorm = 59.5764, GNorm = 0.6095, lr_0 = 6.1081e-04
Loss = 1.8195e-01, PNorm = 59.6241, GNorm = 0.6057, lr_0 = 7.3243e-04
Loss = 2.2252e-01, PNorm = 59.6662, GNorm = 0.4429, lr_0 = 8.5405e-04
Loss = 2.2072e-01, PNorm = 59.7306, GNorm = 0.4100, lr_0 = 9.7568e-04
Validation auc = 0.750556
Epoch 2
Loss = 1.5742e-01, PNorm = 59.8218, GNorm = 0.3422, lr_0 = 9.8020e-04
Loss = 1.8557e-01, PNorm = 59.9028, GNorm = 0.2255, lr_0 = 9.5865e-04
Loss = 1.8480e-01, PNorm = 59.9890, GNorm = 0.6004, lr_0 = 9.3758e-04
Loss = 2.2547e-01, PNorm = 60.0560, GNorm = 0.4264, lr_0 = 9.1697e-04
Validation auc = 0.808889
Epoch 3
Loss = 1.3014e-01, PNorm = 60.1556, GNorm = 0.5396, lr_0 = 8.9681e-04
Loss = 2.4867e-01, PNorm = 60.2357, GNorm = 0.3443, lr_0 = 8.7710e-04
Loss = 1.3679e-01, PNorm = 60.3770, GNorm = 0.1856, lr_0 = 8.5782e-04
Validation auc = 0.821667
Epoch 4
Loss = 2.0977e-01, PNorm = 60.4834, GNorm = 0.4012, lr_0 = 8.3710e-04
Loss = 1.8842e-01, PNorm = 60.5936, GNorm = 0.8907, lr_0 = 8.1870e-04
Loss = 2.0955e-01, PNorm = 60.6551, GNorm = 0.4725, lr_0 = 8.0071e-04
Loss = 1.7471e-01, PNorm = 60.7222, GNorm = 0.2820, lr_0 = 7.8311e-04
Validation auc = 0.816111
Epoch 5
Loss = 2.2221e-01, PNorm = 60.7733, GNorm = 0.4422, lr_0 = 7.6420e-04
Loss = 1.4452e-01, PNorm = 60.8154, GNorm = 0.3418, lr_0 = 7.4740e-04
Loss = 1.5764e-01, PNorm = 60.8519, GNorm = 0.3471, lr_0 = 7.3097e-04
Loss = 1.8059e-01, PNorm = 60.8977, GNorm = 0.7356, lr_0 = 7.1490e-04
Validation auc = 0.882222
Epoch 6
Loss = 1.2539e-01, PNorm = 60.9426, GNorm = 0.2135, lr_0 = 6.9919e-04
Loss = 1.9542e-01, PNorm = 60.9902, GNorm = 0.5163, lr_0 = 6.8382e-04
Loss = 1.2211e-01, PNorm = 61.0599, GNorm = 0.2196, lr_0 = 6.6879e-04
Loss = 1.9166e-01, PNorm = 61.0986, GNorm = 0.8742, lr_0 = 6.5409e-04
Validation auc = 0.905556
Epoch 7
Loss = 1.6946e-01, PNorm = 61.1612, GNorm = 0.5546, lr_0 = 6.3829e-04
Loss = 1.7845e-01, PNorm = 61.2072, GNorm = 0.3201, lr_0 = 6.2426e-04
Loss = 1.1543e-01, PNorm = 61.2815, GNorm = 0.4200, lr_0 = 6.1054e-04
Validation auc = 0.896111
Epoch 8
Loss = 1.8765e-01, PNorm = 61.3349, GNorm = 0.4100, lr_0 = 5.9579e-04
Loss = 1.5649e-01, PNorm = 61.3794, GNorm = 0.4488, lr_0 = 5.8270e-04
Loss = 1.4360e-01, PNorm = 61.4343, GNorm = 0.5035, lr_0 = 5.6989e-04
Loss = 1.1480e-01, PNorm = 61.5005, GNorm = 0.1630, lr_0 = 5.5736e-04
Validation auc = 0.917778
Epoch 9
Loss = 9.6139e-02, PNorm = 61.5673, GNorm = 0.2620, lr_0 = 5.4511e-04
Loss = 1.4048e-01, PNorm = 61.6232, GNorm = 0.3632, lr_0 = 5.3313e-04
Loss = 1.6912e-01, PNorm = 61.6735, GNorm = 0.3718, lr_0 = 5.2141e-04
Loss = 1.1153e-01, PNorm = 61.7369, GNorm = 0.2494, lr_0 = 5.0995e-04
Validation auc = 0.948333
Epoch 10
Loss = 1.6009e-01, PNorm = 61.7989, GNorm = 0.4456, lr_0 = 4.9764e-04
Loss = 1.0013e-01, PNorm = 61.8690, GNorm = 0.3674, lr_0 = 4.8670e-04
Loss = 1.6071e-01, PNorm = 61.9306, GNorm = 0.6665, lr_0 = 4.7600e-04
Loss = 1.2309e-01, PNorm = 61.9981, GNorm = 0.5930, lr_0 = 4.6554e-04
Loss = 2.3970e-01, PNorm = 62.0016, GNorm = 0.7882, lr_0 = 4.6450e-04
Validation auc = 0.933889
Epoch 11
Loss = 1.2500e-01, PNorm = 62.0472, GNorm = 0.3695, lr_0 = 4.5429e-04
Loss = 1.2800e-01, PNorm = 62.1117, GNorm = 0.1831, lr_0 = 4.4431e-04
Loss = 1.1351e-01, PNorm = 62.1718, GNorm = 0.2844, lr_0 = 4.3454e-04
Validation auc = 0.942778
Epoch 12
Loss = 1.1032e-01, PNorm = 62.2043, GNorm = 0.2922, lr_0 = 4.2499e-04
Loss = 1.1546e-01, PNorm = 62.2740, GNorm = 0.2099, lr_0 = 4.1565e-04
Loss = 1.2626e-01, PNorm = 62.3272, GNorm = 0.8742, lr_0 = 4.0651e-04
Loss = 1.0127e-01, PNorm = 62.3972, GNorm = 0.2354, lr_0 = 3.9758e-04
Validation auc = 0.952778
Epoch 13
Loss = 1.0696e-01, PNorm = 62.4473, GNorm = 0.8194, lr_0 = 3.8797e-04
Loss = 1.0497e-01, PNorm = 62.5058, GNorm = 0.3369, lr_0 = 3.7945e-04
Loss = 1.3052e-01, PNorm = 62.5395, GNorm = 0.4055, lr_0 = 3.7111e-04
Loss = 1.4209e-01, PNorm = 62.5846, GNorm = 0.6163, lr_0 = 3.6295e-04
Validation auc = 0.956111
Epoch 14
Loss = 1.2911e-01, PNorm = 62.6211, GNorm = 0.6769, lr_0 = 3.5497e-04
Loss = 1.0530e-01, PNorm = 62.6675, GNorm = 0.4684, lr_0 = 3.4717e-04
Loss = 1.2532e-01, PNorm = 62.7091, GNorm = 0.4985, lr_0 = 3.3954e-04
Loss = 8.6123e-02, PNorm = 62.7653, GNorm = 0.7051, lr_0 = 3.3207e-04
Loss = 1.3091e-02, PNorm = 62.7702, GNorm = 0.2087, lr_0 = 3.3134e-04
Validation auc = 0.913889
Epoch 15
Loss = 1.1963e-01, PNorm = 62.8002, GNorm = 0.3049, lr_0 = 3.2405e-04
Loss = 6.9636e-02, PNorm = 62.8619, GNorm = 1.1454, lr_0 = 3.1693e-04
Loss = 1.0434e-01, PNorm = 62.8964, GNorm = 0.6482, lr_0 = 3.0997e-04
Validation auc = 0.941667
Epoch 16
Loss = 9.6813e-02, PNorm = 62.9487, GNorm = 0.3823, lr_0 = 3.0248e-04
Loss = 1.1676e-01, PNorm = 62.9952, GNorm = 0.4628, lr_0 = 2.9583e-04
Loss = 1.1407e-01, PNorm = 63.0447, GNorm = 0.4751, lr_0 = 2.8933e-04
Loss = 9.9599e-02, PNorm = 63.0930, GNorm = 0.3769, lr_0 = 2.8297e-04
Validation auc = 0.957778
Epoch 17
Loss = 6.4281e-02, PNorm = 63.1180, GNorm = 0.4066, lr_0 = 2.7675e-04
Loss = 9.2593e-02, PNorm = 63.1538, GNorm = 0.5410, lr_0 = 2.7067e-04
Loss = 9.8158e-02, PNorm = 63.1899, GNorm = 0.3178, lr_0 = 2.6472e-04
Loss = 9.7376e-02, PNorm = 63.2264, GNorm = 0.5350, lr_0 = 2.5890e-04
Validation auc = 0.922222
Epoch 18
Loss = 7.0011e-02, PNorm = 63.2615, GNorm = 0.3982, lr_0 = 2.5264e-04
Loss = 7.6239e-02, PNorm = 63.2967, GNorm = 0.2310, lr_0 = 2.4709e-04
Loss = 1.1159e-01, PNorm = 63.3239, GNorm = 0.4334, lr_0 = 2.4166e-04
Validation auc = 0.936111
Epoch 19
Loss = 1.0373e-01, PNorm = 63.3713, GNorm = 0.6853, lr_0 = 2.3582e-04
Loss = 9.7369e-02, PNorm = 63.4010, GNorm = 1.8877, lr_0 = 2.3064e-04
Loss = 7.7984e-02, PNorm = 63.4359, GNorm = 0.3976, lr_0 = 2.2557e-04
Loss = 8.6338e-02, PNorm = 63.4560, GNorm = 0.7943, lr_0 = 2.2061e-04
Validation auc = 0.947778
Epoch 20
Loss = 4.2939e-02, PNorm = 63.4984, GNorm = 0.2184, lr_0 = 2.1576e-04
Loss = 9.9470e-02, PNorm = 63.5180, GNorm = 0.6743, lr_0 = 2.1102e-04
Loss = 7.4888e-02, PNorm = 63.5541, GNorm = 0.5711, lr_0 = 2.0638e-04
Loss = 1.0101e-01, PNorm = 63.5749, GNorm = 0.5745, lr_0 = 2.0185e-04
Validation auc = 0.952778
Epoch 21
Loss = 8.1008e-02, PNorm = 63.6091, GNorm = 0.5066, lr_0 = 1.9697e-04
Loss = 8.2654e-02, PNorm = 63.6352, GNorm = 0.8571, lr_0 = 1.9264e-04
Loss = 9.3354e-02, PNorm = 63.6610, GNorm = 0.4432, lr_0 = 1.8841e-04
Loss = 6.4377e-02, PNorm = 63.6892, GNorm = 0.2029, lr_0 = 1.8427e-04
Validation auc = 0.947778
Epoch 22
Loss = 5.8035e-02, PNorm = 63.7098, GNorm = 0.3797, lr_0 = 1.7982e-04
Loss = 8.2655e-02, PNorm = 63.7333, GNorm = 0.8636, lr_0 = 1.7586e-04
Loss = 6.0953e-02, PNorm = 63.7564, GNorm = 0.3804, lr_0 = 1.7200e-04
Validation auc = 0.950000
Epoch 23
Loss = 4.8242e-02, PNorm = 63.7746, GNorm = 0.3998, lr_0 = 1.6822e-04
Loss = 6.6822e-02, PNorm = 63.7967, GNorm = 0.9190, lr_0 = 1.6452e-04
Loss = 7.2732e-02, PNorm = 63.8212, GNorm = 0.6010, lr_0 = 1.6090e-04
Loss = 7.8845e-02, PNorm = 63.8390, GNorm = 0.4379, lr_0 = 1.5737e-04
Validation auc = 0.942222
Epoch 24
Loss = 7.8583e-02, PNorm = 63.8618, GNorm = 0.3684, lr_0 = 1.5357e-04
Loss = 5.9890e-02, PNorm = 63.8802, GNorm = 0.5314, lr_0 = 1.5019e-04
Loss = 8.5299e-02, PNorm = 63.8969, GNorm = 1.2315, lr_0 = 1.4689e-04
Loss = 4.4315e-02, PNorm = 63.9267, GNorm = 0.1941, lr_0 = 1.4366e-04
Validation auc = 0.958889
Epoch 25
Loss = 5.6797e-02, PNorm = 63.9408, GNorm = 0.5824, lr_0 = 1.4050e-04
Loss = 6.0982e-02, PNorm = 63.9554, GNorm = 0.5769, lr_0 = 1.3741e-04
Loss = 5.9941e-02, PNorm = 63.9750, GNorm = 0.2095, lr_0 = 1.3439e-04
Loss = 6.9365e-02, PNorm = 63.9875, GNorm = 0.7456, lr_0 = 1.3144e-04
Validation auc = 0.960556
Epoch 26
Loss = 4.7943e-02, PNorm = 64.0107, GNorm = 1.0277, lr_0 = 1.2826e-04
Loss = 7.9145e-02, PNorm = 64.0214, GNorm = 0.6692, lr_0 = 1.2545e-04
Loss = 5.5382e-02, PNorm = 64.0382, GNorm = 0.6424, lr_0 = 1.2269e-04
Validation auc = 0.955556
Epoch 27
Loss = 9.4404e-02, PNorm = 64.0513, GNorm = 0.8055, lr_0 = 1.1973e-04
Loss = 5.1863e-02, PNorm = 64.0656, GNorm = 1.0300, lr_0 = 1.1709e-04
Loss = 4.2575e-02, PNorm = 64.0802, GNorm = 0.2253, lr_0 = 1.1452e-04
Loss = 6.9636e-02, PNorm = 64.0883, GNorm = 0.4277, lr_0 = 1.1200e-04
Validation auc = 0.943333
Epoch 28
Loss = 5.9608e-02, PNorm = 64.1017, GNorm = 0.9485, lr_0 = 1.0954e-04
Loss = 7.3904e-02, PNorm = 64.1161, GNorm = 1.6682, lr_0 = 1.0713e-04
Loss = 4.0377e-02, PNorm = 64.1290, GNorm = 0.6275, lr_0 = 1.0478e-04
Loss = 6.1800e-02, PNorm = 64.1436, GNorm = 0.7661, lr_0 = 1.0247e-04
Validation auc = 0.938333
Epoch 29
Loss = 4.5308e-02, PNorm = 64.1543, GNorm = 0.3894, lr_0 = 1.0000e-04
Loss = 4.2337e-02, PNorm = 64.1684, GNorm = 0.2110, lr_0 = 1.0000e-04
Loss = 5.8854e-02, PNorm = 64.1772, GNorm = 1.1145, lr_0 = 1.0000e-04
Loss = 5.1652e-02, PNorm = 64.1875, GNorm = 0.3523, lr_0 = 1.0000e-04
Loss = 1.1403e-02, PNorm = 64.1886, GNorm = 0.2998, lr_0 = 1.0000e-04
Validation auc = 0.945556
Model 2 best validation auc = 0.960556 on epoch 25
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 2 test auc = 0.912099
Ensemble test auc = 0.949136
Fold 9
Splitting data with seed 9
Class sizes
hit 0: 94.86%, 1: 5.14%
Total size = 2,335 | train size = 1,868 | val size = 233 | test size = 234
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 2.9820e-01, PNorm = 59.4434, GNorm = 0.5744, lr_0 = 2.3378e-04
Loss = 2.0101e-01, PNorm = 59.4634, GNorm = 0.4637, lr_0 = 3.5541e-04
Loss = 1.8814e-01, PNorm = 59.4894, GNorm = 0.7566, lr_0 = 4.7703e-04
Validation auc = 0.871826
Epoch 1
Loss = 1.3472e-01, PNorm = 59.5261, GNorm = 0.3822, lr_0 = 6.1081e-04
Loss = 1.7200e-01, PNorm = 59.5721, GNorm = 1.2585, lr_0 = 7.3243e-04
Loss = 2.5089e-01, PNorm = 59.6354, GNorm = 0.4150, lr_0 = 8.5405e-04
Loss = 2.1291e-01, PNorm = 59.7208, GNorm = 0.3749, lr_0 = 9.7568e-04
Validation auc = 0.925880
Epoch 2
Loss = 1.8573e-01, PNorm = 59.8067, GNorm = 0.8128, lr_0 = 9.8020e-04
Loss = 1.7950e-01, PNorm = 59.8844, GNorm = 0.2816, lr_0 = 9.5865e-04
Loss = 2.1134e-01, PNorm = 59.9627, GNorm = 0.3114, lr_0 = 9.3758e-04
Loss = 1.6536e-01, PNorm = 60.0223, GNorm = 0.5025, lr_0 = 9.1697e-04
Validation auc = 0.905405
Epoch 3
Loss = 1.5993e-01, PNorm = 60.0926, GNorm = 0.3038, lr_0 = 8.9681e-04
Loss = 1.3039e-01, PNorm = 60.1615, GNorm = 0.2386, lr_0 = 8.7710e-04
Loss = 2.0874e-01, PNorm = 60.2202, GNorm = 0.4176, lr_0 = 8.5782e-04
Validation auc = 0.925471
Epoch 4
Loss = 1.4122e-01, PNorm = 60.2885, GNorm = 0.3195, lr_0 = 8.3710e-04
Loss = 1.9753e-01, PNorm = 60.3574, GNorm = 0.3206, lr_0 = 8.1870e-04
Loss = 1.4477e-01, PNorm = 60.4166, GNorm = 0.4700, lr_0 = 8.0071e-04
Loss = 1.8113e-01, PNorm = 60.4833, GNorm = 0.2021, lr_0 = 7.8311e-04
Validation auc = 0.934889
Epoch 5
Loss = 1.5941e-01, PNorm = 60.5346, GNorm = 0.7223, lr_0 = 7.6420e-04
Loss = 1.6677e-01, PNorm = 60.5871, GNorm = 0.4933, lr_0 = 7.4740e-04
Loss = 2.0163e-01, PNorm = 60.6456, GNorm = 0.3933, lr_0 = 7.3097e-04
Loss = 1.4808e-01, PNorm = 60.7252, GNorm = 0.4620, lr_0 = 7.1490e-04
Validation auc = 0.881245
Epoch 6
Loss = 1.7403e-01, PNorm = 60.7848, GNorm = 0.2362, lr_0 = 6.9919e-04
Loss = 1.6329e-01, PNorm = 60.8341, GNorm = 0.2320, lr_0 = 6.8382e-04
Loss = 1.3346e-01, PNorm = 60.8949, GNorm = 0.4130, lr_0 = 6.6879e-04
Loss = 1.4836e-01, PNorm = 60.9545, GNorm = 0.2687, lr_0 = 6.5409e-04
Validation auc = 0.920147
Epoch 7
Loss = 1.0980e-01, PNorm = 61.0326, GNorm = 0.2418, lr_0 = 6.3829e-04
Loss = 1.7725e-01, PNorm = 61.0770, GNorm = 0.5238, lr_0 = 6.2426e-04
Loss = 1.5703e-01, PNorm = 61.1651, GNorm = 1.5532, lr_0 = 6.1054e-04
Validation auc = 0.907453
Epoch 8
Loss = 6.9194e-02, PNorm = 61.2191, GNorm = 0.3886, lr_0 = 5.9579e-04
Loss = 1.6068e-01, PNorm = 61.2869, GNorm = 0.3257, lr_0 = 5.8270e-04
Loss = 1.4167e-01, PNorm = 61.3426, GNorm = 0.6147, lr_0 = 5.6989e-04
Loss = 1.4388e-01, PNorm = 61.3820, GNorm = 0.5638, lr_0 = 5.5736e-04
Validation auc = 0.929566
Epoch 9
Loss = 8.9645e-02, PNorm = 61.4267, GNorm = 0.1995, lr_0 = 5.4511e-04
Loss = 1.8539e-01, PNorm = 61.4686, GNorm = 0.3897, lr_0 = 5.3313e-04
Loss = 1.4922e-01, PNorm = 61.5272, GNorm = 0.2765, lr_0 = 5.2141e-04
Loss = 1.0720e-01, PNorm = 61.5756, GNorm = 0.3457, lr_0 = 5.0995e-04
Validation auc = 0.927518
Epoch 10
Loss = 9.7007e-02, PNorm = 61.6153, GNorm = 0.2360, lr_0 = 4.9764e-04
Loss = 1.4455e-01, PNorm = 61.6547, GNorm = 0.6116, lr_0 = 4.8670e-04
Loss = 1.2464e-01, PNorm = 61.7056, GNorm = 0.2235, lr_0 = 4.7600e-04
Loss = 1.2731e-01, PNorm = 61.7572, GNorm = 0.5654, lr_0 = 4.6554e-04
Loss = 1.6974e-01, PNorm = 61.7624, GNorm = 0.6645, lr_0 = 4.6450e-04
Validation auc = 0.931204
Epoch 11
Loss = 1.0420e-01, PNorm = 61.8195, GNorm = 0.3228, lr_0 = 4.5429e-04
Loss = 9.3707e-02, PNorm = 61.8695, GNorm = 0.6758, lr_0 = 4.4431e-04
Loss = 1.6172e-01, PNorm = 61.9262, GNorm = 0.2690, lr_0 = 4.3454e-04
Validation auc = 0.925061
Epoch 12
Loss = 1.3188e-01, PNorm = 61.9746, GNorm = 0.4042, lr_0 = 4.2499e-04
Loss = 1.1527e-01, PNorm = 62.0320, GNorm = 0.4951, lr_0 = 4.1565e-04
Loss = 1.0407e-01, PNorm = 62.0906, GNorm = 0.3162, lr_0 = 4.0651e-04
Loss = 1.1852e-01, PNorm = 62.1317, GNorm = 0.2997, lr_0 = 3.9758e-04
Validation auc = 0.890254
Epoch 13
Loss = 1.2412e-01, PNorm = 62.1761, GNorm = 0.7160, lr_0 = 3.8797e-04
Loss = 1.0131e-01, PNorm = 62.2384, GNorm = 0.5813, lr_0 = 3.7945e-04
Loss = 8.3767e-02, PNorm = 62.2940, GNorm = 0.2702, lr_0 = 3.7111e-04
Loss = 9.9852e-02, PNorm = 62.3367, GNorm = 0.5976, lr_0 = 3.6295e-04
Validation auc = 0.897215
Epoch 14
Loss = 1.2168e-01, PNorm = 62.3650, GNorm = 0.8153, lr_0 = 3.5497e-04
Loss = 1.3884e-01, PNorm = 62.4152, GNorm = 0.5391, lr_0 = 3.4717e-04
Loss = 1.0330e-01, PNorm = 62.4631, GNorm = 0.2491, lr_0 = 3.3954e-04
Loss = 7.9174e-02, PNorm = 62.5080, GNorm = 0.3438, lr_0 = 3.3207e-04
Loss = 3.2528e-02, PNorm = 62.5119, GNorm = 0.5381, lr_0 = 3.3134e-04
Validation auc = 0.911957
Epoch 15
Loss = 7.0089e-02, PNorm = 62.5491, GNorm = 0.4533, lr_0 = 3.2405e-04
Loss = 1.4587e-01, PNorm = 62.5734, GNorm = 0.9377, lr_0 = 3.1693e-04
Loss = 9.7213e-02, PNorm = 62.6213, GNorm = 0.3843, lr_0 = 3.0997e-04
Validation auc = 0.891073
Epoch 16
Loss = 1.0096e-01, PNorm = 62.6567, GNorm = 0.3108, lr_0 = 3.0248e-04
Loss = 8.6888e-02, PNorm = 62.6887, GNorm = 0.3983, lr_0 = 2.9583e-04
Loss = 9.9927e-02, PNorm = 62.7229, GNorm = 1.3206, lr_0 = 2.8933e-04
Loss = 7.5236e-02, PNorm = 62.7577, GNorm = 0.3103, lr_0 = 2.8297e-04
Validation auc = 0.890254
Epoch 17
Loss = 9.6894e-02, PNorm = 62.7863, GNorm = 0.4129, lr_0 = 2.7675e-04
Loss = 1.0776e-01, PNorm = 62.8132, GNorm = 0.5006, lr_0 = 2.7067e-04
Loss = 1.0069e-01, PNorm = 62.8537, GNorm = 0.6260, lr_0 = 2.6472e-04
Loss = 7.1179e-02, PNorm = 62.8866, GNorm = 0.2014, lr_0 = 2.5890e-04
Validation auc = 0.906634
Epoch 18
Loss = 5.8249e-02, PNorm = 62.9219, GNorm = 0.3976, lr_0 = 2.5264e-04
Loss = 7.1513e-02, PNorm = 62.9398, GNorm = 0.4093, lr_0 = 2.4709e-04
Loss = 1.2798e-01, PNorm = 62.9601, GNorm = 0.6632, lr_0 = 2.4166e-04
Validation auc = 0.893939
Epoch 19
Loss = 1.4302e-01, PNorm = 62.9953, GNorm = 0.4814, lr_0 = 2.3582e-04
Loss = 8.4948e-02, PNorm = 63.0282, GNorm = 0.2441, lr_0 = 2.3064e-04
Loss = 7.8185e-02, PNorm = 63.0514, GNorm = 0.3746, lr_0 = 2.2557e-04
Loss = 7.1762e-02, PNorm = 63.0747, GNorm = 0.1785, lr_0 = 2.2061e-04
Validation auc = 0.901720
Epoch 20
Loss = 9.6211e-02, PNorm = 63.1011, GNorm = 0.7029, lr_0 = 2.1576e-04
Loss = 8.2164e-02, PNorm = 63.1251, GNorm = 0.4073, lr_0 = 2.1102e-04
Loss = 8.8093e-02, PNorm = 63.1498, GNorm = 0.3245, lr_0 = 2.0638e-04
Loss = 5.7954e-02, PNorm = 63.1733, GNorm = 0.3473, lr_0 = 2.0185e-04
Validation auc = 0.909910
Epoch 21
Loss = 6.4617e-02, PNorm = 63.1951, GNorm = 0.4497, lr_0 = 1.9697e-04
Loss = 8.7887e-02, PNorm = 63.2226, GNorm = 0.2927, lr_0 = 1.9264e-04
Loss = 7.8872e-02, PNorm = 63.2399, GNorm = 0.5180, lr_0 = 1.8841e-04
Loss = 7.3118e-02, PNorm = 63.2654, GNorm = 1.1899, lr_0 = 1.8427e-04
Validation auc = 0.909091
Epoch 22
Loss = 5.6035e-02, PNorm = 63.2866, GNorm = 0.4018, lr_0 = 1.7982e-04
Loss = 7.5013e-02, PNorm = 63.3077, GNorm = 0.5281, lr_0 = 1.7586e-04
Loss = 7.2000e-02, PNorm = 63.3354, GNorm = 0.6049, lr_0 = 1.7200e-04
Validation auc = 0.908272
Epoch 23
Loss = 2.9181e-02, PNorm = 63.3568, GNorm = 0.4209, lr_0 = 1.6822e-04
Loss = 6.5919e-02, PNorm = 63.3726, GNorm = 0.4964, lr_0 = 1.6452e-04
Loss = 6.7074e-02, PNorm = 63.3936, GNorm = 0.6661, lr_0 = 1.6090e-04
Loss = 6.7577e-02, PNorm = 63.4123, GNorm = 1.2878, lr_0 = 1.5737e-04
Validation auc = 0.880835
Epoch 24
Loss = 8.1371e-02, PNorm = 63.4277, GNorm = 0.7996, lr_0 = 1.5357e-04
Loss = 7.7908e-02, PNorm = 63.4444, GNorm = 0.3634, lr_0 = 1.5019e-04
Loss = 5.0010e-02, PNorm = 63.4628, GNorm = 0.3132, lr_0 = 1.4689e-04
Loss = 7.0741e-02, PNorm = 63.4735, GNorm = 0.6135, lr_0 = 1.4366e-04
Validation auc = 0.919738
Epoch 25
Loss = 5.3111e-02, PNorm = 63.4882, GNorm = 0.2329, lr_0 = 1.4050e-04
Loss = 4.2452e-02, PNorm = 63.5042, GNorm = 0.4269, lr_0 = 1.3741e-04
Loss = 6.6339e-02, PNorm = 63.5141, GNorm = 0.6395, lr_0 = 1.3439e-04
Loss = 7.6180e-02, PNorm = 63.5297, GNorm = 0.6844, lr_0 = 1.3144e-04
Validation auc = 0.902539
Epoch 26
Loss = 6.0117e-02, PNorm = 63.5541, GNorm = 0.5730, lr_0 = 1.2826e-04
Loss = 3.4876e-02, PNorm = 63.5701, GNorm = 0.4090, lr_0 = 1.2545e-04
Loss = 5.3273e-02, PNorm = 63.5784, GNorm = 0.6734, lr_0 = 1.2269e-04
Validation auc = 0.921376
Epoch 27
Loss = 2.9691e-02, PNorm = 63.5964, GNorm = 0.2970, lr_0 = 1.1973e-04
Loss = 5.9932e-02, PNorm = 63.6108, GNorm = 0.4640, lr_0 = 1.1709e-04
Loss = 5.5108e-02, PNorm = 63.6208, GNorm = 0.5973, lr_0 = 1.1452e-04
Loss = 6.9612e-02, PNorm = 63.6325, GNorm = 0.9211, lr_0 = 1.1200e-04
Validation auc = 0.913595
Epoch 28
Loss = 1.9653e-02, PNorm = 63.6442, GNorm = 0.5427, lr_0 = 1.0954e-04
Loss = 6.0381e-02, PNorm = 63.6539, GNorm = 0.6929, lr_0 = 1.0713e-04
Loss = 5.7002e-02, PNorm = 63.6681, GNorm = 0.9070, lr_0 = 1.0478e-04
Loss = 5.4634e-02, PNorm = 63.6780, GNorm = 0.5284, lr_0 = 1.0247e-04
Validation auc = 0.903767
Epoch 29
Loss = 5.7021e-02, PNorm = 63.6902, GNorm = 0.9171, lr_0 = 1.0000e-04
Loss = 4.6923e-02, PNorm = 63.7014, GNorm = 0.5306, lr_0 = 1.0000e-04
Loss = 4.6171e-02, PNorm = 63.7113, GNorm = 1.4724, lr_0 = 1.0000e-04
Loss = 6.3175e-02, PNorm = 63.7187, GNorm = 0.9243, lr_0 = 1.0000e-04
Loss = 2.6429e-02, PNorm = 63.7206, GNorm = 0.4309, lr_0 = 1.0000e-04
Validation auc = 0.914005
Model 0 best validation auc = 0.934889 on epoch 4
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 0 test auc = 0.816514
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 2.7142e-01, PNorm = 59.4713, GNorm = 0.3327, lr_0 = 2.3378e-04
Loss = 2.1890e-01, PNorm = 59.4943, GNorm = 0.4111, lr_0 = 3.5541e-04
Loss = 2.1998e-01, PNorm = 59.5210, GNorm = 0.3514, lr_0 = 4.7703e-04
Validation auc = 0.909910
Epoch 1
Loss = 1.2146e-01, PNorm = 59.5568, GNorm = 0.4984, lr_0 = 6.1081e-04
Loss = 1.6751e-01, PNorm = 59.5918, GNorm = 0.3293, lr_0 = 7.3243e-04
Loss = 2.2251e-01, PNorm = 59.6404, GNorm = 0.9097, lr_0 = 8.5405e-04
Loss = 2.2689e-01, PNorm = 59.7152, GNorm = 0.5071, lr_0 = 9.7568e-04
Validation auc = 0.932023
Epoch 2
Loss = 1.5853e-01, PNorm = 59.8120, GNorm = 0.3300, lr_0 = 9.8020e-04
Loss = 1.9167e-01, PNorm = 59.8984, GNorm = 0.4396, lr_0 = 9.5865e-04
Loss = 2.0137e-01, PNorm = 59.9699, GNorm = 0.3942, lr_0 = 9.3758e-04
Loss = 1.8812e-01, PNorm = 60.0253, GNorm = 0.2372, lr_0 = 9.1697e-04
Validation auc = 0.915233
Epoch 3
Loss = 1.2594e-01, PNorm = 60.0765, GNorm = 0.3281, lr_0 = 8.9681e-04
Loss = 1.6780e-01, PNorm = 60.1053, GNorm = 0.2920, lr_0 = 8.7710e-04
Loss = 2.0376e-01, PNorm = 60.1505, GNorm = 0.4379, lr_0 = 8.5782e-04
Validation auc = 0.932432
Epoch 4
Loss = 1.5053e-01, PNorm = 60.1926, GNorm = 0.3265, lr_0 = 8.3710e-04
Loss = 1.6936e-01, PNorm = 60.2578, GNorm = 0.2681, lr_0 = 8.1870e-04
Loss = 2.1778e-01, PNorm = 60.2978, GNorm = 0.7407, lr_0 = 8.0071e-04
Loss = 1.5751e-01, PNorm = 60.3625, GNorm = 0.2518, lr_0 = 7.8311e-04
Validation auc = 0.935299
Epoch 5
Loss = 1.2482e-01, PNorm = 60.4194, GNorm = 0.2864, lr_0 = 7.6420e-04
Loss = 1.9507e-01, PNorm = 60.4623, GNorm = 0.7380, lr_0 = 7.4740e-04
Loss = 1.3841e-01, PNorm = 60.5433, GNorm = 0.3996, lr_0 = 7.3097e-04
Loss = 1.5551e-01, PNorm = 60.6025, GNorm = 0.4723, lr_0 = 7.1490e-04
Validation auc = 0.937756
Epoch 6
Loss = 1.8004e-01, PNorm = 60.6690, GNorm = 0.3683, lr_0 = 6.9919e-04
Loss = 1.0984e-01, PNorm = 60.7430, GNorm = 0.1961, lr_0 = 6.8382e-04
Loss = 1.2389e-01, PNorm = 60.8117, GNorm = 0.2320, lr_0 = 6.6879e-04
Loss = 1.7899e-01, PNorm = 60.8739, GNorm = 0.3302, lr_0 = 6.5409e-04
Validation auc = 0.900491
Epoch 7
Loss = 1.5765e-01, PNorm = 60.9429, GNorm = 0.6215, lr_0 = 6.3829e-04
Loss = 1.1505e-01, PNorm = 61.0232, GNorm = 0.5433, lr_0 = 6.2426e-04
Loss = 1.3352e-01, PNorm = 61.0875, GNorm = 0.2916, lr_0 = 6.1054e-04
Validation auc = 0.895577
Epoch 8
Loss = 1.0043e-01, PNorm = 61.1627, GNorm = 0.2157, lr_0 = 5.9579e-04
Loss = 1.0671e-01, PNorm = 61.2508, GNorm = 0.3522, lr_0 = 5.8270e-04
Loss = 1.6140e-01, PNorm = 61.3212, GNorm = 0.3156, lr_0 = 5.6989e-04
Loss = 1.0655e-01, PNorm = 61.3793, GNorm = 0.2681, lr_0 = 5.5736e-04
Validation auc = 0.895577
Epoch 9
Loss = 1.3360e-01, PNorm = 61.4351, GNorm = 0.3788, lr_0 = 5.4511e-04
Loss = 1.1097e-01, PNorm = 61.5033, GNorm = 0.7599, lr_0 = 5.3313e-04
Loss = 1.5918e-01, PNorm = 61.5546, GNorm = 0.3966, lr_0 = 5.2141e-04
Loss = 1.3333e-01, PNorm = 61.6304, GNorm = 1.0507, lr_0 = 5.0995e-04
Validation auc = 0.889025
Epoch 10
Loss = 1.3201e-01, PNorm = 61.6907, GNorm = 0.3638, lr_0 = 4.9764e-04
Loss = 1.0642e-01, PNorm = 61.7610, GNorm = 0.3732, lr_0 = 4.8670e-04
Loss = 1.3590e-01, PNorm = 61.8006, GNorm = 0.4897, lr_0 = 4.7600e-04
Loss = 1.2982e-01, PNorm = 61.8453, GNorm = 0.2193, lr_0 = 4.6554e-04
Loss = 3.0913e-01, PNorm = 61.8509, GNorm = 0.9324, lr_0 = 4.6450e-04
Validation auc = 0.873464
Epoch 11
Loss = 1.2957e-01, PNorm = 61.9160, GNorm = 0.2785, lr_0 = 4.5429e-04
Loss = 1.0421e-01, PNorm = 61.9710, GNorm = 0.8250, lr_0 = 4.4431e-04
Loss = 1.4454e-01, PNorm = 62.0188, GNorm = 0.6019, lr_0 = 4.3454e-04
Validation auc = 0.877150
Epoch 12
Loss = 9.2182e-02, PNorm = 62.0649, GNorm = 0.2115, lr_0 = 4.2499e-04
Loss = 1.0439e-01, PNorm = 62.1005, GNorm = 0.2300, lr_0 = 4.1565e-04
Loss = 1.0755e-01, PNorm = 62.1387, GNorm = 0.3224, lr_0 = 4.0651e-04
Loss = 1.3133e-01, PNorm = 62.1855, GNorm = 1.0632, lr_0 = 3.9758e-04
Validation auc = 0.744062
Epoch 13
Loss = 7.4818e-02, PNorm = 62.2185, GNorm = 0.3278, lr_0 = 3.8797e-04
Loss = 1.2990e-01, PNorm = 62.2540, GNorm = 0.6296, lr_0 = 3.7945e-04
Loss = 1.1885e-01, PNorm = 62.2883, GNorm = 0.2729, lr_0 = 3.7111e-04
Loss = 9.3979e-02, PNorm = 62.3439, GNorm = 0.4350, lr_0 = 3.6295e-04
Validation auc = 0.866503
Epoch 14
Loss = 1.0053e-01, PNorm = 62.3810, GNorm = 0.3187, lr_0 = 3.5497e-04
Loss = 8.7870e-02, PNorm = 62.4303, GNorm = 0.4312, lr_0 = 3.4717e-04
Loss = 1.0619e-01, PNorm = 62.4623, GNorm = 0.1563, lr_0 = 3.3954e-04
Loss = 9.9116e-02, PNorm = 62.4982, GNorm = 0.3733, lr_0 = 3.3207e-04
Loss = 5.5309e-02, PNorm = 62.5031, GNorm = 0.5840, lr_0 = 3.3134e-04
Validation auc = 0.839066
Epoch 15
Loss = 1.2039e-01, PNorm = 62.5406, GNorm = 0.5431, lr_0 = 3.2405e-04
Loss = 9.5691e-02, PNorm = 62.5902, GNorm = 0.3519, lr_0 = 3.1693e-04
Loss = 8.1750e-02, PNorm = 62.6276, GNorm = 0.3425, lr_0 = 3.0997e-04
Validation auc = 0.843571
Epoch 16
Loss = 7.9205e-02, PNorm = 62.6442, GNorm = 0.3402, lr_0 = 3.0248e-04
Loss = 1.0134e-01, PNorm = 62.6895, GNorm = 0.3598, lr_0 = 2.9583e-04
Loss = 1.0742e-01, PNorm = 62.7193, GNorm = 0.1733, lr_0 = 2.8933e-04
Loss = 8.7254e-02, PNorm = 62.7471, GNorm = 0.5577, lr_0 = 2.8297e-04
Validation auc = 0.854218
Epoch 17
Loss = 6.0920e-02, PNorm = 62.7842, GNorm = 0.2524, lr_0 = 2.7675e-04
Loss = 9.8887e-02, PNorm = 62.8106, GNorm = 0.7046, lr_0 = 2.7067e-04
Loss = 9.4267e-02, PNorm = 62.8384, GNorm = 0.3859, lr_0 = 2.6472e-04
Loss = 1.0109e-01, PNorm = 62.8633, GNorm = 0.4049, lr_0 = 2.5890e-04
Validation auc = 0.826781
Epoch 18
Loss = 7.5241e-02, PNorm = 62.8908, GNorm = 0.4340, lr_0 = 2.5264e-04
Loss = 7.7431e-02, PNorm = 62.9201, GNorm = 0.8322, lr_0 = 2.4709e-04
Loss = 9.1669e-02, PNorm = 62.9480, GNorm = 0.6383, lr_0 = 2.4166e-04
Validation auc = 0.842342
Epoch 19
Loss = 1.1741e-01, PNorm = 62.9829, GNorm = 0.3864, lr_0 = 2.3582e-04
Loss = 8.5426e-02, PNorm = 63.0164, GNorm = 1.5825, lr_0 = 2.3064e-04
Loss = 5.8710e-02, PNorm = 63.0354, GNorm = 0.4147, lr_0 = 2.2557e-04
Loss = 1.0983e-01, PNorm = 63.0704, GNorm = 0.3975, lr_0 = 2.2061e-04
Validation auc = 0.812858
Epoch 20
Loss = 9.5973e-02, PNorm = 63.0987, GNorm = 0.3008, lr_0 = 2.1576e-04
Loss = 9.0031e-02, PNorm = 63.1244, GNorm = 0.6528, lr_0 = 2.1102e-04
Loss = 7.5944e-02, PNorm = 63.1575, GNorm = 0.3231, lr_0 = 2.0638e-04
Loss = 6.2011e-02, PNorm = 63.1725, GNorm = 0.3047, lr_0 = 2.0185e-04
Validation auc = 0.829238
Epoch 21
Loss = 8.3230e-02, PNorm = 63.1965, GNorm = 0.7696, lr_0 = 1.9697e-04
Loss = 1.0863e-01, PNorm = 63.2140, GNorm = 0.4770, lr_0 = 1.9264e-04
Loss = 5.6554e-02, PNorm = 63.2457, GNorm = 0.5755, lr_0 = 1.8841e-04
Loss = 7.8353e-02, PNorm = 63.2545, GNorm = 0.9256, lr_0 = 1.8427e-04
Validation auc = 0.846847
Epoch 22
Loss = 7.0577e-02, PNorm = 63.2871, GNorm = 0.4156, lr_0 = 1.7982e-04
Loss = 7.7522e-02, PNorm = 63.3106, GNorm = 0.4491, lr_0 = 1.7586e-04
Loss = 7.4887e-02, PNorm = 63.3246, GNorm = 0.3097, lr_0 = 1.7200e-04
Validation auc = 0.791974
Epoch 23
Loss = 1.0008e-01, PNorm = 63.3482, GNorm = 0.6257, lr_0 = 1.6822e-04
Loss = 9.4146e-02, PNorm = 63.3633, GNorm = 0.1866, lr_0 = 1.6452e-04
Loss = 8.1891e-02, PNorm = 63.3815, GNorm = 1.0572, lr_0 = 1.6090e-04
Loss = 6.9774e-02, PNorm = 63.4010, GNorm = 0.5971, lr_0 = 1.5737e-04
Validation auc = 0.801802
Epoch 24
Loss = 7.9677e-02, PNorm = 63.4193, GNorm = 0.6009, lr_0 = 1.5357e-04
Loss = 8.2061e-02, PNorm = 63.4423, GNorm = 0.6831, lr_0 = 1.5019e-04
Loss = 5.7922e-02, PNorm = 63.4725, GNorm = 0.8856, lr_0 = 1.4689e-04
Loss = 1.0610e-01, PNorm = 63.4761, GNorm = 0.3813, lr_0 = 1.4366e-04
Validation auc = 0.847256
Epoch 25
Loss = 5.4852e-02, PNorm = 63.4957, GNorm = 0.2639, lr_0 = 1.4050e-04
Loss = 5.9798e-02, PNorm = 63.5133, GNorm = 0.5912, lr_0 = 1.3741e-04
Loss = 7.9563e-02, PNorm = 63.5179, GNorm = 0.5235, lr_0 = 1.3439e-04
Loss = 7.5493e-02, PNorm = 63.5368, GNorm = 0.3655, lr_0 = 1.3144e-04
Validation auc = 0.808763
Epoch 26
Loss = 5.2578e-02, PNorm = 63.5548, GNorm = 0.3783, lr_0 = 1.2826e-04
Loss = 7.1310e-02, PNorm = 63.5710, GNorm = 0.3102, lr_0 = 1.2545e-04
Loss = 5.2141e-02, PNorm = 63.5836, GNorm = 0.8235, lr_0 = 1.2269e-04
Validation auc = 0.791564
Epoch 27
Loss = 2.8284e-02, PNorm = 63.6008, GNorm = 0.3719, lr_0 = 1.1973e-04
Loss = 5.7213e-02, PNorm = 63.6120, GNorm = 0.6869, lr_0 = 1.1709e-04
Loss = 5.7873e-02, PNorm = 63.6262, GNorm = 0.2217, lr_0 = 1.1452e-04
Loss = 6.8085e-02, PNorm = 63.6334, GNorm = 0.3464, lr_0 = 1.1200e-04
Validation auc = 0.811220
Epoch 28
Loss = 7.6925e-02, PNorm = 63.6485, GNorm = 0.3353, lr_0 = 1.0954e-04
Loss = 6.4173e-02, PNorm = 63.6666, GNorm = 0.9071, lr_0 = 1.0713e-04
Loss = 5.7154e-02, PNorm = 63.6754, GNorm = 0.6267, lr_0 = 1.0478e-04
Loss = 4.9439e-02, PNorm = 63.6861, GNorm = 0.5186, lr_0 = 1.0247e-04
Validation auc = 0.823096
Epoch 29
Loss = 4.5950e-02, PNorm = 63.7013, GNorm = 0.4193, lr_0 = 1.0000e-04
Loss = 5.4212e-02, PNorm = 63.7132, GNorm = 0.9681, lr_0 = 1.0000e-04
Loss = 5.1881e-02, PNorm = 63.7228, GNorm = 0.9133, lr_0 = 1.0000e-04
Loss = 6.8606e-02, PNorm = 63.7340, GNorm = 1.0708, lr_0 = 1.0000e-04
Loss = 1.0492e-02, PNorm = 63.7341, GNorm = 0.2388, lr_0 = 1.0000e-04
Validation auc = 0.789926
Model 1 best validation auc = 0.937756 on epoch 5
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 1 test auc = 0.815940
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.35, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1600, bias=False)
        (W_h): Linear(in_features=1600, out_features=1600, bias=False)
        (W_o): Linear(in_features=1733, out_features=1600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.35, inplace=False)
    (1): Linear(in_features=1800, out_features=1, bias=True)
  )
)
Number of parameters = 5,573,001
Moving model to cuda
Epoch 0
Loss = 2.5130e-01, PNorm = 59.4806, GNorm = 0.8733, lr_0 = 2.3378e-04
Loss = 2.5306e-01, PNorm = 59.5045, GNorm = 1.1833, lr_0 = 3.5541e-04
Loss = 2.0848e-01, PNorm = 59.5351, GNorm = 0.5384, lr_0 = 4.7703e-04
Validation auc = 0.933251
Epoch 1
Loss = 2.1260e-01, PNorm = 59.5713, GNorm = 0.3907, lr_0 = 6.1081e-04
Loss = 2.0381e-01, PNorm = 59.6130, GNorm = 0.8221, lr_0 = 7.3243e-04
Loss = 1.9646e-01, PNorm = 59.6659, GNorm = 0.5675, lr_0 = 8.5405e-04
Loss = 1.8385e-01, PNorm = 59.7375, GNorm = 0.2919, lr_0 = 9.7568e-04
Validation auc = 0.857903
Epoch 2
Loss = 2.2444e-01, PNorm = 59.8184, GNorm = 0.3540, lr_0 = 9.8020e-04
Loss = 2.0672e-01, PNorm = 59.9105, GNorm = 0.4473, lr_0 = 9.5865e-04
Loss = 1.7387e-01, PNorm = 59.9908, GNorm = 1.1577, lr_0 = 9.3758e-04
Loss = 1.6505e-01, PNorm = 60.0554, GNorm = 0.3131, lr_0 = 9.1697e-04
Validation auc = 0.938984
Epoch 3
Loss = 1.6874e-01, PNorm = 60.1308, GNorm = 0.3119, lr_0 = 8.9681e-04
Loss = 1.8205e-01, PNorm = 60.2017, GNorm = 0.5067, lr_0 = 8.7710e-04
Loss = 1.6495e-01, PNorm = 60.2873, GNorm = 0.5626, lr_0 = 8.5782e-04
Validation auc = 0.929566
Epoch 4
Loss = 4.0772e-02, PNorm = 60.3579, GNorm = 0.3870, lr_0 = 8.3710e-04
Loss = 1.7509e-01, PNorm = 60.4256, GNorm = 0.4336, lr_0 = 8.1870e-04
Loss = 1.1611e-01, PNorm = 60.5002, GNorm = 0.3504, lr_0 = 8.0071e-04
Loss = 1.7363e-01, PNorm = 60.5682, GNorm = 0.5094, lr_0 = 7.8311e-04
Validation auc = 0.929975
Epoch 5
Loss = 1.6135e-01, PNorm = 60.6414, GNorm = 0.2342, lr_0 = 7.6420e-04
Loss = 1.6301e-01, PNorm = 60.7301, GNorm = 0.2748, lr_0 = 7.4740e-04
Loss = 1.2644e-01, PNorm = 60.8191, GNorm = 0.7715, lr_0 = 7.3097e-04
Loss = 1.8598e-01, PNorm = 60.8877, GNorm = 1.2108, lr_0 = 7.1490e-04
Validation auc = 0.895987
Epoch 6
Loss = 1.1532e-01, PNorm = 61.0119, GNorm = 0.4677, lr_0 = 6.9919e-04
Loss = 1.1921e-01, PNorm = 61.1197, GNorm = 0.4270, lr_0 = 6.8382e-04
Loss = 1.6639e-01, PNorm = 61.1818, GNorm = 0.7591, lr_0 = 6.6879e-04
Loss = 1.7524e-01, PNorm = 61.2484, GNorm = 0.3376, lr_0 = 6.5409e-04
Validation auc = 0.923423
Epoch 7
Loss = 1.2616e-01, PNorm = 61.3186, GNorm = 0.7642, lr_0 = 6.3829e-04
Loss = 1.7419e-01, PNorm = 61.3742, GNorm = 0.3527, lr_0 = 6.2426e-04
Loss = 1.1373e-01, PNorm = 61.4211, GNorm = 0.2610, lr_0 = 6.1054e-04
Validation auc = 0.938984
Epoch 8
Loss = 1.3763e-01, PNorm = 61.4983, GNorm = 0.2741, lr_0 = 5.9579e-04
Loss = 8.4760e-02, PNorm = 61.5640, GNorm = 0.2386, lr_0 = 5.8270e-04
Loss = 1.6213e-01, PNorm = 61.6097, GNorm = 0.3514, lr_0 = 5.6989e-04
Loss = 1.3639e-01, PNorm = 61.6553, GNorm = 0.3636, lr_0 = 5.5736e-04
Validation auc = 0.914414
Epoch 9
Loss = 1.1339e-01, PNorm = 61.7137, GNorm = 0.2366, lr_0 = 5.4511e-04
Loss = 1.2574e-01, PNorm = 61.7678, GNorm = 0.6066, lr_0 = 5.3313e-04
Loss = 1.2475e-01, PNorm = 61.8037, GNorm = 0.2983, lr_0 = 5.2141e-04
Loss = 1.4973e-01, PNorm = 61.8553, GNorm = 1.2829, lr_0 = 5.0995e-04
Validation auc = 0.883292
Epoch 10
Loss = 1.2998e-01, PNorm = 61.9222, GNorm = 0.1723, lr_0 = 4.9764e-04
Loss = 1.0405e-01, PNorm = 61.9724, GNorm = 0.4030, lr_0 = 4.8670e-04
Loss = 1.4769e-01, PNorm = 62.0308, GNorm = 0.4041, lr_0 = 4.7600e-04
Loss = 1.2912e-01, PNorm = 62.0794, GNorm = 0.4866, lr_0 = 4.6554e-04
Loss = 5.6697e-02, PNorm = 62.0839, GNorm = 0.5611, lr_0 = 4.6450e-04
Validation auc = 0.930385
Epoch 11
Loss = 9.8801e-02, PNorm = 62.1173, GNorm = 0.2930, lr_0 = 4.5429e-04
Loss = 1.0761e-01, PNorm = 62.1743, GNorm = 0.3660, lr_0 = 4.4431e-04
Loss = 1.5222e-01, PNorm = 62.2176, GNorm = 0.3842, lr_0 = 4.3454e-04
Validation auc = 0.917281
Epoch 12
Loss = 1.0525e-01, PNorm = 62.2603, GNorm = 0.2782, lr_0 = 4.2499e-04
Loss = 1.2233e-01, PNorm = 62.3191, GNorm = 0.4175, lr_0 = 4.1565e-04
Loss = 9.2912e-02, PNorm = 62.3623, GNorm = 0.4877, lr_0 = 4.0651e-04
Loss = 1.2955e-01, PNorm = 62.4021, GNorm = 0.5677, lr_0 = 3.9758e-04
Validation auc = 0.852580
Epoch 13
Loss = 1.5348e-01, PNorm = 62.4490, GNorm = 1.0113, lr_0 = 3.8797e-04
Loss = 1.2204e-01, PNorm = 62.4955, GNorm = 0.5362, lr_0 = 3.7945e-04
Loss = 9.7328e-02, PNorm = 62.5472, GNorm = 0.3883, lr_0 = 3.7111e-04
Loss = 1.0155e-01, PNorm = 62.5926, GNorm = 0.3410, lr_0 = 3.6295e-04
Validation auc = 0.912367
Epoch 14
Loss = 8.3121e-02, PNorm = 62.6185, GNorm = 0.8623, lr_0 = 3.5497e-04
Loss = 1.2068e-01, PNorm = 62.6626, GNorm = 0.4883, lr_0 = 3.4717e-04
Loss = 9.5046e-02, PNorm = 62.7063, GNorm = 0.2802, lr_0 = 3.3954e-04
Loss = 1.1705e-01, PNorm = 62.7402, GNorm = 0.7185, lr_0 = 3.3207e-04
Loss = 4.0979e-02, PNorm = 62.7431, GNorm = 0.3261, lr_0 = 3.3134e-04
Validation auc = 0.904177
Epoch 15
Loss = 9.2904e-02, PNorm = 62.7810, GNorm = 0.4990, lr_0 = 3.2405e-04
Loss = 1.0404e-01, PNorm = 62.8160, GNorm = 0.3745, lr_0 = 3.1693e-04
Loss = 8.0991e-02, PNorm = 62.8695, GNorm = 0.3021, lr_0 = 3.0997e-04
Validation auc = 0.912776
Epoch 16
Loss = 5.8684e-02, PNorm = 62.8946, GNorm = 0.2386, lr_0 = 3.0248e-04
Loss = 1.0159e-01, PNorm = 62.9272, GNorm = 0.5326, lr_0 = 2.9583e-04
Loss = 9.5578e-02, PNorm = 62.9572, GNorm = 0.3366, lr_0 = 2.8933e-04
Loss = 7.3435e-02, PNorm = 62.9934, GNorm = 0.4333, lr_0 = 2.8297e-04
Validation auc = 0.870598
Epoch 17
Loss = 1.1401e-01, PNorm = 63.0272, GNorm = 0.9381, lr_0 = 2.7675e-04
Loss = 8.1104e-02, PNorm = 63.0570, GNorm = 0.3714, lr_0 = 2.7067e-04
Loss = 9.2996e-02, PNorm = 63.0881, GNorm = 0.2167, lr_0 = 2.6472e-04
Loss = 9.7508e-02, PNorm = 63.1232, GNorm = 0.3867, lr_0 = 2.5890e-04
Validation auc = 0.874693
Epoch 18
Loss = 8.7058e-02, PNorm = 63.1624, GNorm = 0.4125, lr_0 = 2.5264e-04
Loss = 8.9912e-02, PNorm = 63.1822, GNorm = 0.5855, lr_0 = 2.4709e-04
Loss = 8.8727e-02, PNorm = 63.2154, GNorm = 0.2602, lr_0 = 2.4166e-04
Validation auc = 0.839066
Epoch 19
Loss = 1.0637e-01, PNorm = 63.2492, GNorm = 1.2114, lr_0 = 2.3582e-04
Loss = 7.6583e-02, PNorm = 63.2774, GNorm = 0.3139, lr_0 = 2.3064e-04
Loss = 8.7540e-02, PNorm = 63.3039, GNorm = 0.4460, lr_0 = 2.2557e-04
Loss = 1.0391e-01, PNorm = 63.3297, GNorm = 0.5374, lr_0 = 2.2061e-04
Validation auc = 0.827191
Epoch 20
Loss = 6.1066e-02, PNorm = 63.3657, GNorm = 1.1927, lr_0 = 2.1576e-04
Loss = 8.2905e-02, PNorm = 63.3817, GNorm = 0.6540, lr_0 = 2.1102e-04
Loss = 9.1321e-02, PNorm = 63.4053, GNorm = 0.5230, lr_0 = 2.0638e-04
Loss = 7.7189e-02, PNorm = 63.4243, GNorm = 0.3205, lr_0 = 2.0185e-04
Validation auc = 0.859951
Epoch 21
Loss = 8.2160e-02, PNorm = 63.4560, GNorm = 0.3374, lr_0 = 1.9697e-04
Loss = 8.8138e-02, PNorm = 63.4799, GNorm = 0.4209, lr_0 = 1.9264e-04
Loss = 5.8466e-02, PNorm = 63.5075, GNorm = 0.4155, lr_0 = 1.8841e-04
Loss = 9.1085e-02, PNorm = 63.5253, GNorm = 0.7335, lr_0 = 1.8427e-04
Validation auc = 0.812039
Epoch 22
Loss = 7.0059e-02, PNorm = 63.5526, GNorm = 0.5686, lr_0 = 1.7982e-04
Loss = 7.0001e-02, PNorm = 63.5634, GNorm = 0.4411, lr_0 = 1.7586e-04
Loss = 8.6785e-02, PNorm = 63.5880, GNorm = 0.3502, lr_0 = 1.7200e-04
Validation auc = 0.807944
Epoch 23
Loss = 7.7483e-02, PNorm = 63.6124, GNorm = 0.4315, lr_0 = 1.6822e-04
Loss = 7.2800e-02, PNorm = 63.6395, GNorm = 0.7385, lr_0 = 1.6452e-04
Loss = 5.5719e-02, PNorm = 63.6574, GNorm = 0.4099, lr_0 = 1.6090e-04
Loss = 7.2032e-02, PNorm = 63.6769, GNorm = 0.4507, lr_0 = 1.5737e-04
Validation auc = 0.753890
Epoch 24
Loss = 1.1256e-01, PNorm = 63.6921, GNorm = 0.2938, lr_0 = 1.5357e-04
Loss = 8.3713e-02, PNorm = 63.7162, GNorm = 0.4833, lr_0 = 1.5019e-04
Loss = 5.5142e-02, PNorm = 63.7378, GNorm = 0.3271, lr_0 = 1.4689e-04
Loss = 5.0053e-02, PNorm = 63.7521, GNorm = 0.5164, lr_0 = 1.4366e-04
Validation auc = 0.744881
Epoch 25
Loss = 5.9891e-02, PNorm = 63.7668, GNorm = 0.3315, lr_0 = 1.4050e-04
Loss = 6.7219e-02, PNorm = 63.7866, GNorm = 0.4990, lr_0 = 1.3741e-04
Loss = 6.1042e-02, PNorm = 63.8015, GNorm = 0.6457, lr_0 = 1.3439e-04
Loss = 5.5019e-02, PNorm = 63.8207, GNorm = 0.3084, lr_0 = 1.3144e-04
Validation auc = 0.748567
Epoch 26
Loss = 5.2090e-02, PNorm = 63.8348, GNorm = 0.4390, lr_0 = 1.2826e-04
Loss = 8.1200e-02, PNorm = 63.8521, GNorm = 0.8571, lr_0 = 1.2545e-04
Loss = 4.8718e-02, PNorm = 63.8683, GNorm = 0.6257, lr_0 = 1.2269e-04
Validation auc = 0.702703
Epoch 27
Loss = 4.9199e-02, PNorm = 63.8832, GNorm = 0.2865, lr_0 = 1.1973e-04
Loss = 6.0045e-02, PNorm = 63.8999, GNorm = 0.7448, lr_0 = 1.1709e-04
Loss = 5.3943e-02, PNorm = 63.9156, GNorm = 0.2104, lr_0 = 1.1452e-04
Loss = 5.1797e-02, PNorm = 63.9273, GNorm = 0.6971, lr_0 = 1.1200e-04
Validation auc = 0.711302
Epoch 28
Loss = 8.0862e-02, PNorm = 63.9471, GNorm = 1.1456, lr_0 = 1.0954e-04
Loss = 4.3836e-02, PNorm = 63.9556, GNorm = 0.9814, lr_0 = 1.0713e-04
Loss = 3.3483e-02, PNorm = 63.9673, GNorm = 0.1260, lr_0 = 1.0478e-04
Loss = 8.5226e-02, PNorm = 63.9741, GNorm = 1.6557, lr_0 = 1.0247e-04
Validation auc = 0.710074
Epoch 29
Loss = 6.1675e-02, PNorm = 63.9879, GNorm = 0.5899, lr_0 = 1.0000e-04
Loss = 4.5914e-02, PNorm = 63.9976, GNorm = 0.3646, lr_0 = 1.0000e-04
Loss = 5.9983e-02, PNorm = 64.0082, GNorm = 0.7157, lr_0 = 1.0000e-04
Loss = 4.0155e-02, PNorm = 64.0221, GNorm = 0.5561, lr_0 = 1.0000e-04
Loss = 1.1087e-03, PNorm = 64.0233, GNorm = 0.0303, lr_0 = 1.0000e-04
Validation auc = 0.720311
Model 2 best validation auc = 0.938984 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Moving model to cuda
Model 2 test auc = 0.772936
Ensemble test auc = 0.813933
10-fold cross validation
	Seed 0 ==> test auc = 0.859091
	Seed 1 ==> test auc = 0.863403
	Seed 2 ==> test auc = 0.727568
	Seed 3 ==> test auc = 0.901345
	Seed 4 ==> test auc = 0.763457
	Seed 5 ==> test auc = 0.843457
	Seed 6 ==> test auc = 0.805432
	Seed 7 ==> test auc = 0.947768
	Seed 8 ==> test auc = 0.949136
	Seed 9 ==> test auc = 0.813933
Overall test auc = 0.847459 +/- 0.069303
Elapsed time = 2:01:36
